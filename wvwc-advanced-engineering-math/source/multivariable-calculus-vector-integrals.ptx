<?xml version="1.0" encoding="UTF-8" ?>

<!--********************************************************************

*********************************************************************-->
<!-- This file was originally part of the book     -->
<!-- (as copied on 2015/07/12)                     -->
<!--                                               -->
<!--   Abstract Algebra: Theory and Applications   -->
<!--                                               -->
<!-- Copyright (C) 1997-2014  Thomas W. Judson     -->

<chapter xml:id="chapter-multivariable-calculus-vector-integrals" xmlns:xi="http://www.w3.org/2001/XInclude">
    <title>Vector Integrals</title>

    <introduction>
        <p>
            Now that we have several useful ways to describe the rate of change of a vector function, we want to go in the opposite direction and determine how best to measure the <em>accumulation</em> of a vector function.
            Different notions of accumulation will be associated to the different derivatives we have access to, but each connected to one concept: the integral.
        </p>
    </introduction>

    <section xml:id="section-line-integrals">
        <title>Line Integrals</title>

        <introduction>
            <p>
                An integral is fundamentally determined by two objects: the integrand and the domain of integration.
                In this section, we study integrals that involve one-dimensional domains of integration.
                Such integrals are known as <em>line integrals</em>.
                We will have a different type of line integral depending on whether our integrand is a scalar field or a vector field.
            </p>
        </introduction>

        <subsection xml:id="subsection-scalar-line-integrals">
            <title>Scalar Line Integrals</title>

            <p>
                Consider the problem of finding the mass of a wire that follows a path <m>C</m> in either <m>\RR^2</m> or <m>\RR^3</m> given a density function <m>\rho</m>.
                As seen in calculus, the mass can be found by integrating the density.
                This leads to integrals of the form <m>\int_C \rho\dd{s}</m> which are known as <em>(scalar) line integrals</em>.
                The fundamental domain of integration for a line integral is a <em>smooth curve</em>.
            </p>

            <definition xml:id="definition-smooth-curves">
                <title>Smooth Curves</title>

                <idx><h>space curves</h><h>smooth</h></idx>

                <statement>
                    <p>
                        Let <m>C</m> denote a curve in <m>\RR^n</m> parameterized by a vector function <m>\rr(t)</m> defined on an interval <m>I</m>.
                        We say that <m>C</m> is <term>smooth</term> if <m>\rr(t)</m> is differentiable and <m>\rrp(t)\neq\vb{0}</m> anywhere on <m>I</m>.
                    </p>
                </statement>
            </definition>

            <p>
                We can rephrase <xref ref="definition-smooth-curves" text="type-global" /> as follows: <m>C</m> is smooth if and only if it has a smooth parameterization <m>\rr(t)</m>.
                With this in mind, we can now define line integrals over smooth curves.
            </p>

            <definition xml:id="definition-scalar-line-integrals">
                <title>Scalar Line Integrals</title>

                <idx><h>line integrals</h><h>scalar fields</h></idx>

                <statement>
                    <p>
                        Let <m>C</m> be a smooth curve in <m>\RR^2</m>.
                        Let <m>f(x, y)</m> denote a function that is continuous on some open set containing <m>C</m>.
                        The <term>scalar line integral</term> of <m>f</m> over <m>C</m> is given by the limit
                        <me>\int_C f(x, y)\dd{s} = \lim_{\Delta s\to0}\sum_{k=1}^{n}f(x_k, y_k)\Delta s</me>
                        where the points <m>(x_k, y_k)</m> are lie on <m>C</m>, and <m>\Delta s</m> gives the length of the line segment from one such point to the next.
                    </p>
                </statement>
            </definition>

            <p>
                Geometrically, we view the line integral <m>\int_C f(x, y)\dd{s}</m> as giving the area between the curve <m>C</m> in the <m>xy</m>-plane and the surface <m>z = f(x, y)</m>.
                Although <xref ref="definition-scalar-line-integrals" text="type-global" /> assumes that <m>C</m> lies in <m>\RR^2</m>, the definition can be extended to higher dimensions.
            </p>

            <p>
                The definition given in <xref ref="definition-scalar-line-integrals" text="type-global" />, while important, will not typically be used for computing line integrals.
                Instead, we will take another approach using arc length.
                The differential <m>\dd{s}</m> in the line integral formula corresponds to the arc length function along <m>C</m>.
                Therefore we may write
                <me>\dd{s} = \norm{\rrp(t)}\dd{t}</me>
                and
                <men xml:id="equation-scalar-line-computational">\int_C f(x, y)\dd{s} = \int_a^b f(\rr(t))\norm{\rrp(t)}\dd{t}</men>
                for some suitable smooth parameterization <m>\rr(t), a\leq t\leq b</m> of <m>C</m>.
            </p>

            <example xml:id="example-computing-a-scalar-line-integral">
                <title>Computing a Scalar Line Integral</title>

                <statement>
                    <p>
                        Compute <m>\int_C (xy)^{\frac{1}{3}}\dd{s}</m> where <m>C</m> is the parabolic segment <m>y = x^2</m> from <m>x = 0</m> to <m>x = 1</m>.
                    </p>
                </statement>

                <solution>
                    <p>
                        First, we need to parameterize <m>C</m>.
                        This can be done using <m>\rr(t) = \mqty[t \amp t^2]</m> for <m>0\leq t\leq 1</m>.
                        <xref ref="equation-scalar-line-computational" text="type-global" /> then gives
                        <md>
                            <mrow>\int_C (xy)^{\frac{1}{3}}\dd{s} \amp = \int_0^1 t\sqrt{1 + 4t^2}\dd{t} </mrow>
                            <mrow> \amp = \int_1^5\frac{1}{8}\sqrt{u}\dd{u} </mrow>
                            <mrow> \amp = \frac{5^{\frac{3}{2}} - 1}{12} </mrow>
                        </md>.
                    </p>
                </solution>
            </example>

            <p>
                Recall that <xref ref="definition-scalar-line-integrals" text="type-global" /> defines scalar line integrals over smooth curves only.
                If a curve <m>C</m> is <em>piecewise smooth</em>, which means that it can be written as the union of finitely many smooth curves <m>C_1</m> through <m>C_n</m>, then we can extend <xref ref="definition-scalar-line-integrals" text="type-global" /> to <m>C</m> as well.
                All we need to do is compute the line integral along the smooth components <m>C_i</m> and add them up:
                <me>\int_C f(x, y)\dd{s} = \sum_{i=1}^n \int_{C_i} f(x, y)\dd{s}</me>.
            </p>

            <example xml:id="example-computing-a-line-integral-along-a-piecewise-smooth-curve">
                <title>Computing a Line Integral Along a Piecewise Smooth Curve</title>

                <statement>
                    <p>
                        Let <m>C</m> denote the curve consisting of the line segment from <m>(-1, 0)</m> to <m>(0, 1)</m> followed by the line segment from <m>(0, 1)</m> to <m>(1,0)</m>.
                        Find <m>\int_C (2x - 3y)\dd{s}</m>.
                    </p>
                </statement>

                <solution>
                    <p>
                        We need to decompose <m>C</m> into smooth components.
                        The natural choice is to pick <m>C_1</m> to be the first segment and <m>C_2</m> to be the second segment.
                        These curves are smooth and have the following smooth parameterizations:
                        <md>
                            <mrow>C_1 : \rr_1(t) \amp = \mqty[t - 1 \amp t], 0\leq t\leq 1 </mrow>
                            <mrow>C_2 : \rr_2(t) \amp = \mqty[t \amp 1-t], 0\leq t\leq 1 </mrow>
                        </md>.
                        Now we can compute the resulting line integrals:
                        <md>
                            <mrow>\int_{C_1} (2x - 3y)\dd{s} \amp = \int_0^1 [2(t-1) - 3t]\sqrt{2}\dd{t} </mrow>
                            <mrow> \amp = \int_0^1 (-2 - t)\sqrt{2}\dd{t} </mrow>
                            <mrow> \amp = -\frac{5}{2}\sqrt{2} </mrow>
                        </md>.
                        Likewise,
                        <me>\int_{C_1} (2x - 3y)\dd{s} = \int_0^1 (5t - 3)\sqrt{2}\dd{t} = -\frac{1}{2}\sqrt{2}</me>.
                        Adding these integrals together, we get
                        <me>\int_C (2x - 3y)\dd{s} = -3\sqrt{2}</me>.
                    </p>
                </solution>
            </example>
        </subsection>

        <subsection xml:id="subsection-line-integrals-of-vector-fields">
            <title>Line Integrals of Vector Fields</title>

            <p>
                Using the scalar line integral in <xref ref="definition-scalar-line-integrals" text="type-global" />, we can also define line integrals of vector fields along smooth and piecewise-smooth curves.
            </p>

            <definition xml:id="definition-vector-line-integrals">
                <title>Vector Line Integrals</title>

                <idx><h>line integrals</h><h>vector fields</h></idx>

                <statement>
                    <p>
                        Let <m>C</m> be a (piecewise) smooth curve and let <m>\FF</m> be a vector field that is continuous on <m>C</m>.
                        The <term>vector line integral</term> of <m>\FF</m> over <m>C</m> is defined to be
                        <me>\int_{C}\FF\cdot\TT\dd{s}</me>,
                        where <m>\TT</m> denotes the unit tangent to <m>C</m> with respect to a previously chosen (piecwise) smooth parameterization of <m>C</m>.
                    </p>
                </statement>
            </definition>

            <p>
                We interpret the vector line integral as measuring how well the vector field <m>\FF</m> and the curve <m>C</m> align.
                We also call it the <em>circulation</em> of <m>\FF</m> along <m>C</m>.
                In physics, <xref ref="definition-vector-line-integrals" text="type-global" /> can also be used to find the work done by a force field <m>\FF</m> on a particle that moves along the curve <m>C</m>.
            </p>

            <p>
                The formula in <xref ref="definition-vector-line-integrals" text="type-global" /> can be simplified in much the same way as the original definition of a scalar line integral was in <xref ref="equation-scalar-line-computational" text="type-global" />.
                First, suppose that <m>C</m> is parameterized by the smooth vector function <m>\rr(t):[a,b]\to\RR^n</m>.
                Then
                <md>
                    <mrow>\FF\cdot\TT\dd{s} \amp = \FF(\rr(t))\cdot\frac{\rrp(t)}{\norm{\rrp(t)}}\norm{\rrp(t)}\dd{t} </mrow>
                    <mrow> \amp = \FF(\rr(t))\cdot\rrp(t)\dd{t} </mrow>
                    <mrow> \amp = \FF\cdot\dd{\rr} </mrow>
                </md>.
                Therefore
                <men xml:id="equation-vector-line-computational">\int_C\FF\cdot\TT\dd{s} = \int_a^b\FF\cdot\dd{\rr}</men>.
            </p>

            <example xml:id="example-computing-a-circulation">
                <title>Computing a Circulation</title>

                <statement>
                    <p>
                        Find the circulation of <m>\FF = (x^2+y^2)^{-1}\mqty[x \amp y]</m> along the curve <m>C:\rr(t) = \mqty[t \amp 4t], 1\leq t\leq 10</m>.
                    </p>
                </statement>

                <solution>
                    <p>
                        First, note that <m>C</m> is a smooth curve on which <m>\FF</m> is continuous and the line integral of <m>\FF</m> along <m>C</m> is therefore defined.
                        By <xref ref="equation-vector-line-computational" text="type-global" />, it follows that
                        <me>\int_C\FF\cdot\TT\dd{s} = \int_1^{10}\FF\cdot\dd{\rr}</me>
                        where
                        <md>
                            <mrow>\FF \amp = \FF(\rr(t)) = \frac{1}{17t^2}\mqty[t \amp 4t] </mrow>
                            <mrow>\dd{\rr} \amp = \rrp(t)\dd{t} = \mqty[1 \amp 4]\dd{t} </mrow>
                        </md>.
                        Therefore
                        <md>
                            <mrow>\int_1^{10}\FF\cdot\dd{\rr} \amp = \int_1^{10}\frac{1}{17t^2}(t + 16t)\dd{t} </mrow>
                            <mrow> \amp = \int_1^{10}\frac{1}{t}\dd{t} </mrow>
                            <mrow> \amp = \ln(10) </mrow>
                        </md>.
                        Note that this is greater than <m>0</m>, which indicates that the vector field <m>\FF</m> and the curve <m>C</m> tend to be aligned.
                        This can be verified using the following plot produced by Sage:
                    </p>

                    <figure xml:id="figure-sage-vector-field-over-line">
                        <caption>The vector field <m>\FF = (x^2+y^2)^{-1}\mqty[x\amp y]</m> over <m>C</m>.</caption>

                        <image xml:id="image-sage-vector-field-over-line" width="50%">
                            <description>The vector field <m>\FF</m> over <m>C</m>.</description>

                            <sageplot>
                                var('x y')

                                F = (x^2 + y^2)^(-1)*vector([x, y])

                                P1 = plot_vector_field(F, (x, 1, 10), (y, 4, 40), color="blue")
                                P2 = parametric_plot([x, 4*x], (x, 1, 10), color="black", aspect_ratio="automatic")

                                P = P1 + P2
                                P
                            </sageplot>
                        </image>
                    </figure>
                </solution>
            </example>

            <p>
                Curves that <q>follow</q> vector fields precisely are known as <em>flow lines</em> or <em>streamlines</em>.
                The curve <m>C</m> in <xref ref="example-computing-a-circulation" text="type-global" /> is an example of a streamline of the vector field <m>\FF</m> in the same example, as can be seen from <xref ref="figure-sage-vector-field-over-line" text="type-global" />.
                It can be shown that all other streamlines of <m>\FF</m> are curves of the form <m>y = cx</m> for some constant <m>c</m>.
            </p>
        </subsection>
    </section>

    <section xml:id="section-path-independence-and-the-fundamental-theorem-of-line-integrals">
        <title>Path Independence and the Fundamental Theorem of Line Integrals</title>

        <introduction>
            <p>
                Given a continuous vector field <m>\FF</m> defined over a smooth curve <m>C:\rr(t), a\leq t\leq b</m>, we can find the corresponding vector line integral using the formula
                <me>\int_C\FF\cdot\TT\dd{s} = \int_a^b\FF\cdot\dd{\rr}</me>.
                If <m>F(t)</m> is an antiderivative of <m>\FF\cdot\rrp</m>, then the Fundamental Theorem of Calculus implies that
                <me>\int_C\FF\cdot\TT\dd{s} = F(b) - F(a)</me>,
                which suggests that the line integral only depends on the endpoints of the curve.
                Unfortunately this is not guaranteed as line integrals of vector fields are generally <em>path dependent</em>.
                Our primary goal in this section is to determine the vector fields <m>\FF</m> for which our intuition does hold.
            </p>
        </introduction>

        <subsection xml:id="subsection-path-independence">
            <title>Path Independence</title>

            <p>
                Consider the vector field <m>\FF = \mqty[y \amp -x]</m> and the curves
                <md>
                    <mrow>C_1: \amp \rr_1(t) = \mqty[1-t \amp t], 0\leq t\leq 1 </mrow>
                    <mrow>C_2: \amp \rr_2(t) = \mqty[\cos(t) \amp \sin(t)], 0\leq t\leq\frac{\pi}{2} </mrow>
                </md>
                Note that both curves have the same initial and terminal points, however the corresponding line integrals are different:
                <md>
                    <mrow>\int_{C_1}\FF\cdot\TT\dd{s} \amp = -1 </mrow>
                    <mrow>\int_{C_2}\FF\cdot\TT\dd{s} \amp = -\frac{\pi}{2} </mrow>
                </md>
                This is an example of <em>path dependence</em>.
            </p>

            <definition xml:id="definition-path-dependence-and-path-independence">
                <title>Path Dependence and Path Independence</title>

                <idx><h>line integrals</h><h>path independence</h></idx>

                <statement>
                    <p>
                        Let <m>\FF</m> be a continuous vector field defined on an open set <m>U</m>.
                        We say that the line integral <m>\int_C\FF\cdot\TT\dd{s}</m> is <term>path independent</term> on <m>U</m> if for any pair of points <m>A,B</m> in <m>U</m> and any pair of piecewise smooth curves <m>C_1, C_2</m> from <m>A</m> to <m>B</m> contained entirely within <m>U</m> we have
                        <me>\int_{C_1}\FF\cdot\TT\dd{s} = \int_{C_2}\FF\cdot\TT\dd{s}</me>.
                        In other words, any line integral of <m>\FF</m> along any piecewise smooth path contained within <m>U</m> depends only on the endpoints of the curve <m>C</m>.
                        Otherwise, we say that <m>\int_C\FF\cdot\TT\dd{s}</m> is <term>path dependent</term>.
                    </p>
                </statement>
            </definition>

            <p>
                Graphically, we can see very quickly that line integrals of <m>\FF = \mqty[y \amp -x]</m> above should be path dependent.
                For instance, consider the following plot of <m>\FF</m> over the unit square <m>[0,1]\times[0,1]</m>:
            </p>
            <figure xml:id="figure-sage-path-dependent-field">
                <caption><m>\FF = \mqty[y \amp -x]</m>.</caption>

                <image xml:id="image-sage-path-dependent-field" width="50%">
                    <description>A plot of the vector field [y, -x].</description>

                    <sageplot>
                        var('x y')

                        F = vector([y, -x])

                        plot_vector_field(F, (x, 0, 1), (y, 0, 1), color="blue")
                    </sageplot>
                </image>
            </figure>

            <p>
                Let <m>C_1</m> denote the circular arc from <m>(0,1)</m> to <m>(1,0)</m> and let <m>C_2</m> denote the path piecewise linear path from <m>(0,1)</m> to <m>(1,0)</m> determined by following the axes.
                Then <m>\int_{C_1}\FF\cdot\dd{\rr} > 0</m> and <m>\int_{C_2}\FF\cdot\dd{\rr} = 0</m>.
                Therefore <m>\FF</m> must be path-dependent.
            </p>
        </subsection>

        <subsection xml:id="subsection-fundamental-theorem-of-line-integrals">
            <title>Fundamental Theorem of Line Integrals</title>

            <p>
                The argument above also gives us some intuition about precisely which vector fields should be path independent.
                In particular, it took advantage of the fact that <m>\FF</m> rotates (<m>\FF</m> always rotates clockwise, but what matters is that it rotates at all) to come up with a line integral that is guaranteed to be positive and another line integral that isn't.
                This suggests that the path independent vector fields should be related to irrotational fields, i.e., fields with zero curl.
                Such vector fields are also <xref ref="definition-conservative-vector-fields-and-potentials" text="custom">conservative vector fields</xref> if they are defined over a <q>simply connection domain</q>.
                This statement is made precise using the <em>Fundamental Theorem of Line Integrals</em>.
            </p>

            <theorem xml:id="theorem-fundamental-theorem-of-line-integrals">
                <title>Fundamental Theorem of Line Integrals</title>

                <idx><h>Fundamental Theorem of Line Integrals</h><see>conservative vector fields</see></idx>

                <statement>
                    <p>
                        Let <m>\FF</m> be a conservative vector field that is continuous over a piecewise smooth curve <m>C:\rr(t),a\leq t\leq b</m>.
                        Then
                        <me>\int_{C}\FF\cdot\dd{\rr} = f(\rr(b)) - f(\rr(a))</me>
                        where <m>f</m> denotes a potential function of <m>\FF</m>.
                    </p>
                </statement>

                <proof>
                    <p>
                        The proof is essentially just applying the Fundamental Theorem of Calculus to <m>\int_C\FF\cdot\dd{\rr}</m>:
                        <md>
                            <mrow>\int_C\FF\cdot\dd{\rr} \amp = \int_a^b \FF(\rr(t))\cdot\rrp(t)\dd{t} </mrow>
                            <mrow> \amp = \int_a^b \del f(\rr(t))\cdot\rrp(t)\dd{t} </mrow>
                            <mrow> \amp = \int_a^b \dv{t} [f(\rr(t))]\dd{t} </mrow>
                            <mrow> \amp = f(\rr(b)) - f(\rr(a)) </mrow>
                        </md>
                    </p>
                </proof>
            </theorem>

            <p>
                The Fundamental Theorem of Line Integrals shows that conservative vector fields are always path-independent.
                The converse is also (almost) true: if <m>\FF</m> is a path-independent vector field over some simply connected domain, then <m>\FF</m> is conservative within that domain.
            </p>

            <aside>
                <p>
                    Roughly speaking, a region <m>U</m> in <m>\RR^n</m> is <em>simply connected</em> if it has no holes.
                    A simple example of a region that is not simply connected is the <q>punctured plane</q>, which is just <m>\RR^2</m> with the origin removed.
                </p>
            </aside>

            <example xml:id="example-using-the-fundamental-theorem-of-line-integrals">
                <title>Using the Fundamental Theorem of Line Integrals</title>

                <statement>
                    <p>
                        Let <m>\FF = \mqty[-y \amp -x]</m> and let <m>C:\rr(t), 0\leq t\leq 2\pi</m> where
                        <me>\rr(t) = \mqty[\sin(t) \amp \cos(t/2)]</me>.
                        Find <m>\int_C\FF\cdot\dd{\rr}</m>.
                    </p>
                </statement>

                <solution>
                    <p>
                        We could use the computational formula given in Equation <xref ref="equation-vector-line-computational" text="type-global" />, but we'll instead make use of <xref ref="theorem-fundamental-theorem-of-line-integrals" text="type-global" />.
                        To do so, we need to prove that <m>\FF</m> is conservative and then find a corresponding potential function.
                    </p>

                    <p>
                        To prove that <m>\FF</m> is conservative, note that its curl is <me>\pdv{Q}{x} - \pdv{P}{y} = 0</me>.
                        Since <m>\FF</m> is also continuous everywhere, this is enough to guarantee that it's conservative.
                        Now we know that <m>\FF</m> must have a potential function <m>f</m> such that <m>\del f = \FF</m>.
                        One such possibility is <m>f(x, y) = -xy</m>.
                        Therefore
                        <me>\int_C\FF\cdot\dd{\rr} = f(0, -1) - f(0, 1) = 0</me>.
                    </p>
                </solution>
            </example>

            <p>
                The <xref ref="theorem-fundamental-theorem-of-line-integrals" text="title" /> has another important consequence.
                If <m>C</m> is a piecewise smooth closed curve (so its initial and terminal points are the same) and <m>\FF</m> is conservative in a region containing <m>C</m>, then <m>\int_C\FF\cdot\dd{\rr} = 0</m>.
                This also has a nice physical interpretation.
                Recall that circulation integrals can also be viewed as work integrals, and so the result that line integrals of conservative fields over closed curves are always <m>0</m> corresponds to the physical law that the work done by conservative forces along closed curves is <m>0</m> as well.
            </p>
        </subsection>
    </section>

    <section xml:id="section-green-s-theorem">
        <title>Green's Theorem</title>

        <introduction>
            <p>
                In this section we cover the relationship between line integrals and double integrals.
                This can be viewed as a generalization of the Fundamental Theorem of Calculus, which relates integrals <m>\int_a^b f^\prime(x)\dd{x}</m> to values of <m>f(x)</m> at the boundary points <m>x = a</m> and <m>x = b</m>.
                The main result of this section, <em>Green's Theorem</em>, relates double integrals of simple, closed and bounded regions <m>R</m> in the plane to line integrals along their boundaries <m>\partial R</m>.
                This is done for two types of line integrals: the circulation integral and the <em>flux integral</em>.
            </p>
        </introduction>

        <subsection xml:id="subsection-green-s-theorem-for-circulation-integrals">
            <title>Green's Theorem for Circulation Integrals</title>

            <p>
                Given a continuous vector field <m>\FF = \mqty[P \amp Q]</m> in <m>\RR^2</m>, we defined its circulation along a piecewise smooth curve <m>C</m> as
                <me>\int_C \FF\cdot\TT\dd{s} = \int_{C}\FF\cdot\dd{\rr}</me>.
                If we write <m>\rr = \mqty[x \amp y]</m>, <m>\dd{x} = x^\prime\dd{t}</m> and <m>\dd{y} = y^\prime\dd{t}</m>, then this formula becomes
                <me>\int_C\FF\cdot\TT\dd{s} = \int_C P\dd{x} + Q\dd{y}</me>.
                If <m>C</m> is also a closed curve, then we often replace <m>\int_C</m> with <m>\oint_C</m> to indicate such.
                Now we can state Green's Theorem.
            </p>

            <theorem xml:id="theorem-green-s-theorem-for-circulation-integrals">
                <title>Green's Theorem for Circulation Integrals</title>

                <idx><h>Green's Theorem</h><h>circulation integrals</h></idx>

                <statement>
                    <p>
                        Let <m>R</m> denote a simple, closed and bounded region of the plane with piecewise smooth boundary <m>\partial R</m>, oriented counterclockwise.
                        Let <m>\FF = \mqty[P \amp Q]</m> denote a vector field that is continuous over an open set containing <m>R</m>.
                        Then
                        <me>\oint_{\partial R} P\dd{x} + Q\dd{y} = \iint_{R}\left(\pdv{Q}{x} - \pdv{P}{y}\right)\dd{A}</me>.
                    </p>
                    <aside>
                        <p>
                            A region <m>R</m> is <em>closed</em> if it contains its boundary.
                            It is <em>simple</em> if it contains no holes.
                        </p>
                    </aside>
                </statement>
            </theorem>

            <p>
                Green's Theorem has a very nice geometric interpretation.
                Recall that the integral <m>\int_{\partial R} P\dd{x} + Q\dd{y}</m> is the circulation of <m>\FF</m> along <m>\partial R</m>.
                On the right hand side of the identity in Green's Theorem, the quantity <m>\pdv{Q}{x} - \pdv{P}{y}</m> is the two-dimensional curl of <m>\FF</m>, and so <m>\iint_R (Q_x - P_y)\dd{A}</m> is a measure of the <q>net (counterclockwise) rotation</q> of <m>\FF</m> within the region <m>R</m>.
                Therefore Green's Theorem implies that the net rotation of <m>\FF</m> inside the region <m>R</m> is exactly equal to the circulation of <m>\FF</m> along the boundary <m>\partial R</m>.
            </p>

            <p>
                Beyond its geometric interpretation, <xref ref="theorem-green-s-theorem-for-circulation-integrals" text="custom">Green's Theorem</xref> is also useful as a generalization of the <xref ref="theorem-fundamental-theorem-of-line-integrals" text="custom">Fundamental Theorem of Line Integrals</xref> for non-conservative vector fields in the plane, as the double integral that appears in the theorem is often easier to evaluate than the line integral it's equal to.
            </p>

            <example xml:id="example-using-green-s-theorem-to-compute-a-circulation-integral">
                <title>Using Green's Theorem to Compute a Circulation Integral</title>

                <statement>
                    <p>
                        Compute <m>\oint_{C}\FF\cdot\dd{\rr}</m> where <m>\FF = \mqty[-3y \amp 3x]</m> and <m>C</m> is the triangle in <m>\RR^2</m> with vertices <m>(0,0), (1,0)</m> and <m>(0,2)</m> traversed exactly once counterclockwise.
                    </p>
                </statement>

                <solution>
                    <p>
                        First we'll check to see if <m>\FF</m> is conservative as this would greatly simplify our calculations.
                        Since its curl is <m>6</m>, we see quickly that <m>\FF</m> is not conservative, and so <xref ref="theorem-fundamental-theorem-of-line-integrals" text="type-global" /> and its related consequences do not apply to <m>\FF</m>.
                        We could resort to computing <m>\oint_C -3y\dd{x} + 3x\dd{y}</m> using Equation <xref ref="equation-vector-line-computational" text="type-global" />, but this would require setting up <em>three</em> separate line integrals since <m>C</m> is piecewise smooth with three smooth components.
                    </p>

                    <p>
                        To avoid this, we'll make use of Green's Theorem.
                        Let <m>R</m> denote the triangle contained with the curve <m>C</m>.
                        Then
                        <me>\oint_C -3y\dd{x} + 3x\dd{y} = \iint_{R}6\dd{A} = 6</me>,
                        where we have used the fact that <me>\iint_{R}\dd{A}</me> is always equal to the area of <m>R</m>.
                    </p>
                </solution>
            </example>

            <p>
                Green's Theorem can also be applied to clockwise-oriented curves, as long as you take care to multiply your integral by a negative.
            </p>

            <example xml:id="example-green-s-theorem-and-clockwise-curves">
                <title>Green's Theorem and Clockwise Curves</title>

                <statement>
                    <p>
                        Find <m>\oint_C xy^2\dd{x} + x^3\dd{y}</m> where <m>C</m> is the rectangle with vertices <m>(0,0), (1,0), (0, 3)</m> and <m>(1,3)</m> traversed exactly once <em>clockwise</em>.
                    </p>
                </statement>

                <solution>
                    <p>
                        To use Green's Theorem here, we multiply our integral by a negative.
                        This has the effect of reversing the orientation of the curve <m>C</m> from clockwise to counterclockwise, allowing us to apply <xref ref="theorem-green-s-theorem-for-circulation-integrals" text="type-global" />:
                        <me>\oint_C xy^2\dd{x} + x^3\dd{y} = -\int_0^1\int_0^3 (3x^2 - 2xy)\dd{y}\dd{x}</me>.
                    </p>
                </solution>
            </example>

            <p>
                An interesting use of Green's Theorem is in the computation of areas.
                Since the area of a region <m>R</m> is equal to <m>\iint_R\dd{A}</m>, then the area of <m>R</m> can be founded by computing the circulation integral <m>\oint_{\partial R}P\dd{x} + Q\dd{y}</m> of any vector field <m>\FF</m> with a curl exactly equal to <m>1</m>.
                An easy choice for this is <m>\FF = \frac{1}{2}\mqty[-y \amp x]</m>, which implies that the area of <m>R</m> can be found by computing
                <me>\frac{1}{2}\oint_{C} x\dd{y} - y\dd{x}</me>.
            </p>

            <example xml:id="example-area-using-green-s-theorem">
                <title>Area Using Green's Theorem</title>

                <statement>
                    <p>
                        Find the area of an ellipse with major axis <m>4</m> and minor axis <m>2</m>.
                    </p>
                </statement>

                <solution>
                    <p>
                        Such an ellipse can be given by the parameterization <m>\rr(t) = \mqty[4\cos(t)\amp 2\sin(t)], 0\leq t\leq 2\pi</m>.
                        This gives
                        <me>\frac{1}{2}\oint_C x\dd{y} - y\dd{x} = \frac{1}{2}\int_0^{2\pi} (8\cos^2(t) + 8\sin^2(t))\dd{t} = 16\pi</me>
                        for the area contained within the ellipse.
                    </p>
                </solution>
            </example>
        </subsection>

        <subsection xml:id="subsection-green-s-theorem-for-flux-integrals">
            <title>Green's Theorem for Flux Integrals</title>

            <p>
                Circulation integrals of the form <m>\int_C P\dd{x} + Q\dd{y}</m> are useful for measuring the flow of a vector field <m>\FF = \mqty[P\amp Q]</m> <em>along</em> a curve <m>C</m>, but to measure the flow across or over <m>C</m> we instead make use of a <em>flux integral</em>.
            </p>

            <definition xml:id="definition-flux-integral">
                <title>Flux Integral</title>

                <idx><h>flux integral</h></idx>

                <statement>
                    <p>
                        Let <m>\FF = \mqty[P \amp Q]</m> be a continuous vector field defined over a piecewise smooth curve <m>C</m> with outward facing normal vector <m>\NN</m>.
                        The <term>flux</term> of <m>\FF</m> over <m>C</m> is defined to be
                        <me>\int_C\FF\cdot\NN\dd{s} = \int_C P\dd{y} - Q\dd{x}</me>.
                    </p>
                </statement>
            </definition>

            <p>
                If <m>R</m> is a simple, closed and bounded region in the plane, then the normal vector <m>\NN</m> in <xref ref="definition-flux-integral" text="type-global" /> is always defined to be the outward normal.
                In particular, if <m>\partial R</m> is oreiented counterclockwise then has unit tangent <m>\TT</m>, then the region <m>R</m> will always lie to the left of <m>\TT</m> and the normal <m>\NN</m> will always point to the right of <m>\TT</m>.
                This convention makes the flux integral a measure of flow <em>outside</em> of the region <m>R</m>.
                As net outflow is also measured by the <xref ref="definition-divergence" text="custom">divergence</xref> of a vector field, this suggests the following modification of Green's Theorem.
            </p>

            <theorem xml:id="theorem-green-s-theorem-for-flux-integrals">
                <title>Green's Theorem for Flux Integrals</title>

                <idx><h>Green's Theorem</h><h>flux integrals</h></idx>

                <statement>
                    <p>
                        Let <m>R</m> denote a simple, closed and bounded region of the plane with piecewise smooth boundary <m>\partial R</m>, oriented counterclockwise.
                        Let <m>\FF = \mqty[P \amp Q]</m> denote a vector field that is continuous over an open set containing <m>R</m>.
                        Then
                        <me>\oint_{\partial R} P\dd{y} - Q\dd{x} = \iint_{R}\left(\pdv{P}{x} + \pdv{Q}{y}\right)\dd{A}</me>.
                    </p>
                </statement>
            </theorem>
        </subsection>
    </section>
</chapter>
