<!DOCTYPE html>
<html lang="en-US" dir="ltr">
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex, nofollow">
<script>// Make *any* pre with class 'sagecell-sage' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({
  "inputLocation": "pre.sagecell-sage",
  "linked": true,
  "linkKey": "linked-sage",
  "autoeval": false,
  "languages": [
    "sage"
  ],
  "evalButtonText": "Evaluate (Sage)"
});
</script>
</head>
<body class="ignore-math">
<div class="solution solution-like">
<h4 class="heading">
<span class="type">Solution</span><span class="space"> </span><span class="codenumber">8.7.8.1</span><span class="period">.</span>
</h4>
<div class="para logical">
<div class="para">Let</div>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/equation-differential-equations-separability-condition.html">
\begin{equation*}
f(x, y) = x^3y^2 - 2xy + 2x^3y - xy^2
\end{equation*}
</div>
<div class="para">and note that <span class="process-math">\(f(2, 1) = 18\neq 0\text{.}\)</span> Using <a href="" class="xref" data-knowl="./knowl/equation-differential-equations-separability-condition.html" title="Equation 8.7.1">(8.7.1)</a>, define</div>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/equation-differential-equations-separability-condition.html">
\begin{equation*}
F(x) = \frac{f(x,1)}{f(2,1)} = \frac{3x^3-3x}{18}\text{ and } G(y) = f(2,y) = 6y^2+12y\text{.}
\end{equation*}
</div>
<div class="para">It can be checked that <span class="process-math">\(F(x)G(y) = f(x, y)\)</span> and so the equation is separable.</div>
</div> <div class="para">The solution of this differential equation can now be found using the methods of this section. In particular, using Sage and the <code class="code-inline tex2jax_ignore">desolve</code> command we get the following:</div> <pre class="ptx-sagecell sagecell-sage" id="sage-14"><script type="text/x-sage"># Define y as a function of x
y = function('y')(x)

# Define the differential equation to solve
de = diff(y, x) == x^3*y^2-2*x*y+2*x^3*y-x*y^2

# Solve the equation for y
f = desolve(de, y)
show(f)
</script></pre> <div class="para">With a little bit of work, we can also convince Sage to turn this implicit solution into an explicit solution by solving for <span class="process-math">\(y\text{.}\)</span> The heavy lifting here is done by the <code class="code-inline tex2jax_ignore">.log_simplify()</code> and <code class="code-inline tex2jax_ignore">.solve()</code> methods. In order to help Sage with simplifying the logarithms, we will clear fractions first. This prevents any radicals from appearing inside of the logarithms after simplification and makes solving for <span class="process-math">\(y\)</span> easier:</div> <pre class="ptx-sagecell sagecell-sage" id="sage-15"><script type="text/x-sage"># Be sure to run the previous cell before this one!
# Now clear fractions in front of the logs in f
g = 2*f

# Now we simplify and solve
g.log_simplify().solve(y)
</script></pre> <div class="para logical">
<div class="para">Therefore the explicit solution of our equation is</div>
<div class="displaymath process-math">
\begin{equation*}
y\left(x\right) = -\frac{2 \, e^{\left(\frac{1}{2} \, x^{4} - x^{2} + 2 \, C\right)}}{e^{\left(\frac{1}{2} \, x^{4} - x^{2} + 2 \, C\right)} - 1}\text{.}
\end{equation*}
</div>
</div>
</div>
<span class="incontext"><a href="section-differential-equations.html#solution-163" class="internal">in-context</a></span>
</body>
</html>
