%**************************************%
%*    Generated from PreTeXt source   *%
%*    on 2018-10-03T11:30:43-04:00    *%
%*                                    *%
%*   http://mathbook.pugetsound.edu   *%
%*                                    *%
%**************************************%
\documentclass[10pt,]{book}
%% Custom Preamble Entries, early (use latex.preamble.early)
%% Default LaTeX packages
%%   1.  always employed (or nearly so) for some purpose, or
%%   2.  a stylewriter may assume their presence
\usepackage{geometry}
%% Some aspects of the preamble are conditional,
%% the LaTeX engine is one such determinant
\usepackage{ifthen}
%% etoolbox has a variety of modern conveniences
\usepackage{etoolbox}
\usepackage{ifxetex,ifluatex}
%% Raster graphics inclusion
\usepackage{graphicx}
%% Color support, xcolor package
%% Always loaded, for: add/delete text, author tools
%% Here, since tcolorbox loads tikz, and tikz loads xcolor
\PassOptionsToPackage{usenames,dvipsnames,svgnames,table}{xcolor}
\usepackage{xcolor}
%% Colored boxes, and much more, though mostly styling
%% skins library provides "enhanced" skin, employing tikzpicture
%% boxes may be configured as "breakable" or "unbreakable"
%% "raster" controls grids of boxes, aka side-by-side
\usepackage{tcolorbox}
\tcbuselibrary{skins}
\tcbuselibrary{breakable}
\tcbuselibrary{raster}
%% xparse allows the construction of more robust commands,
%% this is a necessity for isolating styling and behavior
%% The tcolorbox library of the same name loads the base library
\tcbuselibrary{xparse}
%% Hyperref should be here, but likes to be loaded late
%%
%% Inline math delimiters, \(, \), need to be robust
%% 2016-01-31:  latexrelease.sty  supersedes  fixltx2e.sty
%% If  latexrelease.sty  exists, bugfix is in kernel
%% If not, bugfix is in  fixltx2e.sty
%% See:  https://tug.org/TUGboat/tb36-3/tb114ltnews22.pdf
%% and read "Fewer fragile commands" in distribution's  latexchanges.pdf
\IfFileExists{latexrelease.sty}{}{\usepackage{fixltx2e}}
%% Text height identically 9 inches, text width varies on point size
%% See Bringhurst 2.1.1 on measure for recommendations
%% 75 characters per line (count spaces, punctuation) is target
%% which is the upper limit of Bringhurst's recommendations
\geometry{letterpaper,total={340pt,9.0in}}
%% Custom Page Layout Adjustments (use latex.geometry)
%% This LaTeX file may be compiled with pdflatex, xelatex, or lualatex
%% The following provides engine-specific capabilities
%% Generally, xelatex and lualatex will do better languages other than US English
%% You can pick from the conditional if you will only ever use one engine
\ifthenelse{\boolean{xetex} \or \boolean{luatex}}{%
%% begin: xelatex and lualatex-specific configuration
%% fontspec package will make Latin Modern (lmodern) the default font
\ifxetex\usepackage{xltxtra}\fi
\usepackage{fontspec}
%% realscripts is the only part of xltxtra relevant to lualatex 
\ifluatex\usepackage{realscripts}\fi
%% 
%% Extensive support for other languages
\usepackage{polyglossia}
%% Main document language is US English
\setdefaultlanguage{english}
%% Spanish
\setotherlanguage{spanish}
%% Vietnamese
\setotherlanguage{vietnamese}
%% end: xelatex and lualatex-specific configuration
}{%
%% begin: pdflatex-specific configuration
%% translate common Unicode to their LaTeX equivalents
%% Also, fontenc with T1 makes CM-Super the default font
%% (\input{ix-utf8enc.dfu} from the "inputenx" package is possible addition (broken?)
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
%% end: pdflatex-specific configuration
}
%% Monospace font: Inconsolata (zi4)
%% Sponsored by TUG: http://levien.com/type/myfonts/inconsolata.html
%% See package documentation for excellent instructions
%% One caveat, seem to need full file name to locate OTF files
%% Loads the "upquote" package as needed, so we don't have to
%% Upright quotes might come from the  textcomp  package, which we also use
%% We employ the shapely \ell to match Google Font version
%% pdflatex: "varqu" option produces best upright quotes
%% xelatex,lualatex: add StylisticSet 1 for shapely \ell
%% xelatex,lualatex: add StylisticSet 2 for plain zero
%% xelatex,lualatex: we add StylisticSet 3 for upright quotes
%% 
\ifthenelse{\boolean{xetex} \or \boolean{luatex}}{%
%% begin: xelatex and lualatex-specific monospace font
\usepackage{zi4}
\setmonofont[BoldFont=Inconsolatazi4-Bold.otf,StylisticSet={1,3}]{Inconsolatazi4-Regular.otf}
%% end: xelatex and lualatex-specific monospace font
}{%
%% begin: pdflatex-specific monospace font
%% "varqu" option provides textcomp \textquotedbl glyph
%% "varl"  option provides shapely "ell"
\usepackage[varqu,varl]{zi4}
%% end: pdflatex-specific monospace font
}
%% Symbols, align environment, bracket-matrix
\usepackage{amsmath}
\usepackage{amssymb}
%% allow page breaks within display mathematics anywhere
%% level 4 is maximally permissive
%% this is exactly the opposite of AMSmath package philosophy
%% there are per-display, and per-equation options to control this
%% split, aligned, gathered, and alignedat are not affected
\allowdisplaybreaks[4]
%% allow more columns to a matrix
%% can make this even bigger by overriding with  latex.preamble.late  processing option
\setcounter{MaxMatrixCols}{30}
%%
%% Division Titles, and Page Headers/Footers
%% titlesec package, loading "titleps" package cooperatively
%% See code comments about the necessity and purpose of "explicit" option
\usepackage[explicit, pagestyles]{titlesec}
\renewpagestyle{empty}{
    \setfoot[][][]
    {}{}{}
    }
\renewpagestyle{plain}{
    \setfoot[][\thepage][]
    {}{\thepage}{}
    }
\renewpagestyle{headings}[\small\sffamily]{
    \sethead[\textbf{\thepage}]
    [\textsl{\chaptertitle}]
    [Chapter~\thechapter]
    {Section~\thesection}
    {\textsl{\sectiontitle}}
    {\textbf{\thepage}}
    \setfoot[][\thepage][Section~\thesection]
    {Chapter~\thechapter}{\thepage}{}
    }
%% Set global/default page style for document due
%% to potential re-definitions after documentclass
\pagestyle{headings}
%%
%% Create globally-available macros to be provided for style writers
%% These are redefined for each occurence of each division
\newcommand{\divisionnameptx}{\relax}%
\newcommand{\titleptx}{\relax}%
\newcommand{\subtitleptx}{\relax}%
\newcommand{\shortitleptx}{\relax}%
\newcommand{\authorsptx}{\relax}%
\newcommand{\epigraphptx}{\relax}%
%% Create environments for possible occurences of each division
%% Environment for a PTX "chapter" at the level of a LaTeX "chapter"
\NewDocumentEnvironment{chapterptx}{mmmmm}
{%
\renewcommand{\divisionnameptx}{Chapter}%
\renewcommand{\titleptx}{#1}%
\renewcommand{\subtitleptx}{#2}%
\renewcommand{\shortitleptx}{#3}%
\renewcommand{\authorsptx}{#4}%
\renewcommand{\epigraphptx}{#5}%
\chapter[#3]{#1}%
}{}%
%% Environment for a PTX "section" at the level of a LaTeX "section"
\NewDocumentEnvironment{sectionptx}{mmmmm}
{%
\renewcommand{\divisionnameptx}{Section}%
\renewcommand{\titleptx}{#1}%
\renewcommand{\subtitleptx}{#2}%
\renewcommand{\shortitleptx}{#3}%
\renewcommand{\authorsptx}{#4}%
\renewcommand{\epigraphptx}{#5}%
\section[#3]{#1}%
}{}%
%% Environment for a PTX "subsection" at the level of a LaTeX "subsection"
\NewDocumentEnvironment{subsectionptx}{mmmmm}
{%
\renewcommand{\divisionnameptx}{Subsection}%
\renewcommand{\titleptx}{#1}%
\renewcommand{\subtitleptx}{#2}%
\renewcommand{\shortitleptx}{#3}%
\renewcommand{\authorsptx}{#4}%
\renewcommand{\epigraphptx}{#5}%
\subsection[#3]{#1}%
}{}%
%% Environment for a PTX "index" at the level of a LaTeX ""
\NewDocumentEnvironment{indexptx}{mmmmm}
{%
\renewcommand{\divisionnameptx}{Index}%
\renewcommand{\titleptx}{#1}%
\renewcommand{\subtitleptx}{#2}%
\renewcommand{\shortitleptx}{#3}%
\renewcommand{\authorsptx}{#4}%
\renewcommand{\epigraphptx}{#5}%
\*{#1}%
\addcontentsline{toc}{chapter}{#3}
}{}%
%% Environment for a PTX "appendix" at the level of a LaTeX "chapter"
\NewDocumentEnvironment{appendixptx}{mmmmm}
{%
\renewcommand{\divisionnameptx}{Appendix}%
\renewcommand{\titleptx}{#1}%
\renewcommand{\subtitleptx}{#2}%
\renewcommand{\shortitleptx}{#3}%
\renewcommand{\authorsptx}{#4}%
\renewcommand{\epigraphptx}{#5}%
\chapter[#3]{#1}%
}{}%
%%
%% Styles for the traditional LaTeX divisions
\titleformat{\chapter}[display]
{\normalfont\huge\bfseries}{\divisionnameptx\space\thechapter}{20pt}{\Huge#1}
[{\Large\authorsptx}]
\titlespacing*{\chapter}{0pt}{50pt}{40pt}
\titleformat{\section}
{\normalfont\Large\bfseries}{\thesection\space\titleptx}{1em}{}
[{\large\authorsptx}]
\titleformat{name=\section,numberless}
{\normalfont\Large\bfseries}{}{0pt}{#1}
\titlespacing*{\section}{0pt}{3.5ex plus 1ex minus .2ex}{2.3ex plus .2ex}
\titleformat{\subsection}
{\normalfont\large\bfseries}{\thesubsection\space\titleptx}{1em}{}
[{\normalsize\authorsptx}]
\titlespacing*{\subsection}{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}
\titleformat{\subsubsection}
{\normalfont\normalsize\bfseries}{\thesubsubsection\space\titleptx}{1em}{}
[{\small\authorsptx}]
\titlespacing*{\subsubsection}{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}
%%
%% Semantic Macros
%% To preserve meaning in a LaTeX file
%% Only defined here if required in this document
%% Used for inline definitions of terms
\newcommand{\terminology}[1]{\textbf{#1}}
%% Used for units and number formatting
\usepackage[per-mode=fraction]{siunitx}
\ifxetex\sisetup{math-micro=\text{µ},text-micro=µ}\fi\ifluatex\sisetup{math-micro=\text{µ},text-micro=µ}\fi%% Common non-SI units
\DeclareSIUnit\degreeFahrenheit{\SIUnitSymbolDegree{F}}
\DeclareSIUnit\fahrenheit{\degreeFahrenheit}
\DeclareSIUnit\pound{lb}
\DeclareSIUnit\foot{ft}
\DeclareSIUnit\inch{in}
\DeclareSIUnit\yard{yd}
\DeclareSIUnit\mile{mi}
\DeclareSIUnit\millennium{millennium}
\DeclareSIUnit\century{century}
\DeclareSIUnit\decade{decade}
\DeclareSIUnit\year{yr}
\DeclareSIUnit\month{mo}
\DeclareSIUnit\week{wk}
\DeclareSIUnit\kilometerperhour{kph}
\DeclareSIUnit\kilometreperhour{kph}
\DeclareSIUnit\mileperhour{mph}
\DeclareSIUnit\gallon{gal}
\DeclareSIUnit\milepergallon{mpg}
\DeclareSIUnit\kilometerpergallon{kpg}
\DeclareSIUnit\revolution{rev}
\DeclareSIUnit\revolutionperminute{rpm}
\DeclareSIUnit\cycle{cycle}
%% Subdivision Numbering, Chapters, Sections, Subsections, etc
%% Subdivision numbers may be turned off at some level ("depth")
%% A section *always* has depth 1, contrary to us counting from the document root
%% The latex default is 3.  If a larger number is present here, then
%% removing this command may make some cross-references ambiguous
%% The precursor variable $numbering-maxlevel is checked for consistency in the common XSL file
\setcounter{secnumdepth}{3}
%% begin: General AMS environment setup
%% Environments built with amsthm package
\usepackage{amsthm}
%% Numbering for Theorems, Conjectures, Examples, Figures, etc
%% Controlled by  numbering.theorems.level  processing parameter
%% Numbering: all theorem-like numbered consecutively
%% i.e. Corollary 4.3 follows Theorem 4.2
%% Always need some theorem environment to set base numbering scheme
%% even if document has no theorems (but has other environments)
%% Create a never-used style first, always
%% simply to provide a global counter to use, namely "cthm"
\newtheorem{cthm}{BadTheoremStringName}[section]
%% end: General AMS environment setup
%% AMS proof environment is basically fine as-is and special treatment
%% would certainly interfere with the functioning of \qed, etc.
%% So we simply localize the default heading
%% Redefinition of the "proof" environment is to cause a long alternate
%% title to line-break appropriately.  Code is cut verbatim, by suggestion,
%% from "Using the amsthm Package" Version 2.20.3, September 2017
\renewcommand*{\proofname}{Proof}
\makeatletter
\renewenvironment{proof}[1][\proofname]{\par
  \pushQED{\qed}%
  \normalfont \topsep6\p@\@plus6\p@\relax
  \trivlist
  \item\relax
    {\itshape
    #1\@addpunct{.}}\hspace\labelsep\ignorespaces
}{%
  \popQED\endtrivlist\@endpefalse
}
\makeatother
%% And a filled-in Halmos, making hollow available for examples
\renewcommand{\qedsymbol}{\(\blacksquare\)}
%%
%% tcolorbox, with styles, for THEOREM-LIKE
%%
%% theorem: fairly simple numbered block/structure
\tcbset{ theoremstyle/.style={enhanced, title engine=path, colback=red!8!white, 
colframe=blue!75!black,coltitle=blue!10!white,fonttitle=\bfseries\sffamily,
title style={left color=blue!15!black, right color=blue!45!black}, } }
\newtcolorbox[use counter=cthm, number within=section]{theorem}[3]{title={{Theorem~\thetcbcounter\notblank{#1#2}{\space}{}\notblank{#1}{\space#1}{}\notblank{#2}{\space(#2)}{}}}, label=#3, breakable, fontupper=\itshape, theoremstyle, }
%%
%% tcolorbox, with styles, for AXIOM-LIKE
%%
%% principle: fairly simple numbered block/structure
\tcbset{ principlestyle/.style={enhanced, title engine=path, colback=red!8!white, 
colframe=blue!75!black,coltitle=blue!10!white,fonttitle=\bfseries\sffamily,
title style={left color=blue!15!black, right color=blue!45!black}, } }
\newtcolorbox[use counter=cthm, number within=section]{principle}[3]{title={{Principle~\thetcbcounter\notblank{#1#2}{\space}{}\notblank{#1}{\space#1}{}\notblank{#2}{\space(#2)}{}}}, label=#3, breakable, fontupper=\itshape, principlestyle, }
%%
%% tcolorbox, with styles, for DEFINITION-LIKE
%%
%% definition: fairly simple numbered block/structure
\tcbset{ definitionstyle/.style={enhanced, arc=4mm,outer arc=1mm,colback=red!8,fonttitle=\sffamily,
boxed title style={size=small,colback=blue},
} }
\newtcolorbox[use counter=cthm, number within=section]{definition}[2]{title={{Definition~\thetcbcounter\notblank{#1}{\space\space#1}{}}}, label=#2, breakable, definitionstyle, }
%%
%% tcolorbox, with styles, for EXAMPLE-LIKE
%%
%% example: fairly simple numbered block/structure
\tcbset{ examplestyle/.style={colback=blue!8, fonttitle=\sffamily} }
\newtcolorbox[use counter=cthm, number within=section]{example}[2]{title={{Example~\thetcbcounter\notblank{#1}{\space\space#1}{}}}, label=#2, breakable, examplestyle, }
%%
%% tcolorbox, with styles, for ASIDE-LIKE
%%
%% aside: fairly simple un-numbered block/structure
\tcbset{ asidestyle/.style={enhanced, sharp corners, colback=blue!3, colframe=blue!50!black,
add to width=-1ex, shadow={1ex}{-1ex}{0ex}{black!50!white},
coltitle=black, fonttitle=\bfseries, attach title to upper, after title={\space},} }
\newtcolorbox{aside}[2]{title={\notblank{#1}{#1}{}}, label=#2, breakable, asidestyle}
%%
%% xparse environments for introductions and conclusions of divisions
%%
%% introduction: in a structured division
\NewDocumentEnvironment{introduction}{m}
{\notblank{#1}{\noindent\textbf{#1}\space}{}}{}
%% conclusion: in a structured division
\NewDocumentEnvironment{conclusion}{m}
{\par\bigskip\notblank{#1}{\noindent\textbf{#1}\space}{}}{}
%%
%% tcolorbox, with styles, for miscellaneous environments
%%
%% paragraphs: the terminal, pseudo-division
%% We use the lowest LaTeX traditional division
\titleformat{\subparagraph}[runin]{\normalfont\normalsize\bfseries}{\thesubparagraph}{1em}{#1}
\titlespacing*{\subparagraph}{0pt}{3.25ex plus 1ex minus .2ex}{1em}
\NewDocumentEnvironment{paragraphs}{mm}
{\subparagraph*{#1}\hypertarget{#2}{}}{}
%% back colophon, at the very end, typically on its own page
\tcbset{ backcolophonstyle/.style={size=minimal, before skip=5ex, left skip=0.15\textwidth, right skip=0.15\textwidth, boxrule=-0.3pt, frame empty, colback=white, colbacktitle=white, coltitle=black, fonttitle=\large\bfseries, center title, halign=center, bottomtitle=2ex} }
\newtcolorbox{backcolophon}[1]{title={Colophon}, phantom={\hypertarget{#1}{}}, breakable, backcolophonstyle}
%% Localize LaTeX supplied names (possibly none)
\renewcommand*{\appendixname}{Appendix}
\renewcommand*{\chaptername}{Chapter}
%% Equation Numbering
%% Controlled by  numbering.equations.level  processing parameter
\numberwithin{equation}{section}
%% For improved tables
\usepackage{array}
%% Some extra height on each row is desirable, especially with horizontal rules
%% Increment determined experimentally
\setlength{\extrarowheight}{0.2ex}
%% Define variable thickness horizontal rules, full and partial
%% Thicknesses are 0.03, 0.05, 0.08 in the  booktabs  package
\makeatletter
\newcommand{\hrulethin}  {\noalign{\hrule height 0.04em}}
\newcommand{\hrulemedium}{\noalign{\hrule height 0.07em}}
\newcommand{\hrulethick} {\noalign{\hrule height 0.11em}}
%% We preserve a copy of the \setlength package before other
%% packages (extpfeil) get a chance to load packages that redefine it
\let\oldsetlength\setlength
\newlength{\Oldarrayrulewidth}
\newcommand{\crulethin}[1]%
{\noalign{\global\oldsetlength{\Oldarrayrulewidth}{\arrayrulewidth}}%
\noalign{\global\oldsetlength{\arrayrulewidth}{0.04em}}\cline{#1}%
\noalign{\global\oldsetlength{\arrayrulewidth}{\Oldarrayrulewidth}}}%
\newcommand{\crulemedium}[1]%
{\noalign{\global\oldsetlength{\Oldarrayrulewidth}{\arrayrulewidth}}%
\noalign{\global\oldsetlength{\arrayrulewidth}{0.07em}}\cline{#1}%
\noalign{\global\oldsetlength{\arrayrulewidth}{\Oldarrayrulewidth}}}
\newcommand{\crulethick}[1]%
{\noalign{\global\oldsetlength{\Oldarrayrulewidth}{\arrayrulewidth}}%
\noalign{\global\oldsetlength{\arrayrulewidth}{0.11em}}\cline{#1}%
\noalign{\global\oldsetlength{\arrayrulewidth}{\Oldarrayrulewidth}}}
%% Single letter column specifiers defined via array package
\newcolumntype{A}{!{\vrule width 0.04em}}
\newcolumntype{B}{!{\vrule width 0.07em}}
\newcolumntype{C}{!{\vrule width 0.11em}}
\makeatother
%% Figures, Tables, Listings, Named Lists, Floats
%% The [H]ere option of the float package fixes floats in-place,
%% in deference to web usage, where floats are totally irrelevant
%% You can remove some of this setup, to restore standard LaTeX behavior
%% HOWEVER, numbering of figures/tables AND theorems/examples/remarks, etc
%% may de-synchronize with the numbering in the HTML version
%% You can remove the "placement={H}" option to allow flotation and
%% preserve numbering, BUT the numbering may then appear "out-of-order"
%% Floating environments: http://tex.stackexchange.com/questions/95631/
\usepackage{float}
\usepackage{newfloat}
\usepackage{caption}%% Adjust stock figure environment so that it no longer floats
\SetupFloatingEnvironment{figure}{fileext=lof,placement={H},within=section,name=Figure}
\captionsetup[figure]{labelfont=bf}
%% http://tex.stackexchange.com/questions/16195
\makeatletter
\let\c@figure\c@cthm
\makeatother
%% Adjust stock table environment so that it no longer floats
\SetupFloatingEnvironment{table}{fileext=lot,placement={H},within=section,name=Table}
\captionsetup[table]{labelfont=bf}
%% http://tex.stackexchange.com/questions/16195
\makeatletter
\let\c@table\c@cthm
\makeatother
%% Footnote Numbering
%% We reset the footnote counter, as given by numbering.footnotes.level
\makeatletter\@addtoreset{footnote}{section}\makeatother
%% Program listing support: for listings, programs, and Sage code
\usepackage{listings}
%% We define the listings font style to be the default "ttfamily"
%% To fix hyphens/dashes rendered in PDF as fancy minus signs by listing
%% http://tex.stackexchange.com/questions/33185/listings-package-changes-hyphens-to-minus-signs
\makeatletter
\lst@CCPutMacro\lst@ProcessOther {"2D}{\lst@ttfamily{-{}}{-{}}}
\@empty\z@\@empty
\makeatother
\ifthenelse{\boolean{xetex}}{}{%
%% begin: pdflatex-specific listings configuration
%% translate U+0080 - U+00F0 to their textmode LaTeX equivalents
%% Data originally from https://www.w3.org/Math/characters/unicode.xml, 2016-07-23
%% Lines marked in XSL with "$" were converted from mathmode to textmode
\lstset{extendedchars=true}
\lstset{literate={ }{{~}}{1}{¡}{{\textexclamdown }}{1}{¢}{{\textcent }}{1}{£}{{\textsterling }}{1}{¤}{{\textcurrency }}{1}{¥}{{\textyen }}{1}{¦}{{\textbrokenbar }}{1}{§}{{\textsection }}{1}{¨}{{\textasciidieresis }}{1}{©}{{\textcopyright }}{1}{ª}{{\textordfeminine }}{1}{«}{{\guillemotleft }}{1}{¬}{{\textlnot }}{1}{­}{{\-}}{1}{®}{{\textregistered }}{1}{¯}{{\textasciimacron }}{1}{°}{{\textdegree }}{1}{±}{{\textpm }}{1}{²}{{\texttwosuperior }}{1}{³}{{\textthreesuperior }}{1}{´}{{\textasciiacute }}{1}{µ}{{\textmu }}{1}{¶}{{\textparagraph }}{1}{·}{{\textperiodcentered }}{1}{¸}{{\c{}}}{1}{¹}{{\textonesuperior }}{1}{º}{{\textordmasculine }}{1}{»}{{\guillemotright }}{1}{¼}{{\textonequarter }}{1}{½}{{\textonehalf }}{1}{¾}{{\textthreequarters }}{1}{¿}{{\textquestiondown }}{1}{À}{{\`{A}}}{1}{Á}{{\'{A}}}{1}{Â}{{\^{A}}}{1}{Ã}{{\~{A}}}{1}{Ä}{{\"{A}}}{1}{Å}{{\AA }}{1}{Æ}{{\AE }}{1}{Ç}{{\c{C}}}{1}{È}{{\`{E}}}{1}{É}{{\'{E}}}{1}{Ê}{{\^{E}}}{1}{Ë}{{\"{E}}}{1}{Ì}{{\`{I}}}{1}{Í}{{\'{I}}}{1}{Î}{{\^{I}}}{1}{Ï}{{\"{I}}}{1}{Ð}{{\DH }}{1}{Ñ}{{\~{N}}}{1}{Ò}{{\`{O}}}{1}{Ó}{{\'{O}}}{1}{Ô}{{\^{O}}}{1}{Õ}{{\~{O}}}{1}{Ö}{{\"{O}}}{1}{×}{{\texttimes }}{1}{Ø}{{\O }}{1}{Ù}{{\`{U}}}{1}{Ú}{{\'{U}}}{1}{Û}{{\^{U}}}{1}{Ü}{{\"{U}}}{1}{Ý}{{\'{Y}}}{1}{Þ}{{\TH }}{1}{ß}{{\ss }}{1}{à}{{\`{a}}}{1}{á}{{\'{a}}}{1}{â}{{\^{a}}}{1}{ã}{{\~{a}}}{1}{ä}{{\"{a}}}{1}{å}{{\aa }}{1}{æ}{{\ae }}{1}{ç}{{\c{c}}}{1}{è}{{\`{e}}}{1}{é}{{\'{e}}}{1}{ê}{{\^{e}}}{1}{ë}{{\"{e}}}{1}{ì}{{\`{\i}}}{1}{í}{{\'{\i}}}{1}{î}{{\^{\i}}}{1}{ï}{{\"{\i}}}{1}{ð}{{\dh }}{1}{ñ}{{\~{n}}}{1}{ò}{{\`{o}}}{1}{ó}{{\'{o}}}{1}{ô}{{\^{o}}}{1}{õ}{{\~{o}}}{1}{ö}{{\"{o}}}{1}{÷}{{\textdiv }}{1}{ø}{{\o }}{1}{ù}{{\`{u}}}{1}{ú}{{\'{u}}}{1}{û}{{\^{u}}}{1}{ü}{{\"{u}}}{1}{ý}{{\'{y}}}{1}{þ}{{\th }}{1}{ÿ}{{\"{y}}}{1}}
%% end: pdflatex-specific listings configuration
}
%% End of generic listing adjustments
%% Sage's blue is 50%, we go way lighter (blue!05 would work)
\definecolor{sageblue}{rgb}{0.95,0.95,1}
%% Sage input, listings package: Python syntax, boxed, colored, line breaking
%% To be flush with surrounding text's margins, set
%% xmargins to be sum of framerule, framesep, and epsilon (~0.25pt)
%% space between input/output comes from input style "belowskip",
%% by giving output an aboveskip of zero
\lstdefinestyle{sageinputstyle}{language=Python,breaklines=true,breakatwhitespace=true,%
basicstyle=\small\ttfamily,columns=fixed,frame=single,backgroundcolor=\color{sageblue},%
framerule=0.5pt,framesep=4pt,xleftmargin=4.75pt,xrightmargin=4.75pt}
%% Sage output, similar, but not boxed, not colored
\lstdefinestyle{sageoutputstyle}{language=Python,breaklines=true,%
breakatwhitespace=true,basicstyle=\small\ttfamily,columns=fixed,aboveskip=0pt}
%% The environments manufactured by the listings package
\lstnewenvironment{sageinput}
  {\lstset{style=sageinputstyle}}
  {}
\lstnewenvironment{sageoutput}
  {\lstset{style=sageoutputstyle}}
  {}
%% Fancy Verbatim for consoles, preformatted, code display
\usepackage{fancyvrb}
%% Pre-formatted text, a peer of paragraphs
\DefineVerbatimEnvironment{preformatted}{Verbatim}{}
%% More flexible list management, esp. for references
%% But also for specifying labels (i.e. custom order) on nested lists
\usepackage{enumitem}
%% Support for index creation
%% imakeidx package does not require extra pass (as with makeidx)
%% Title of the "Index" section set via a keyword
%% Language support for the "see" and "see also" phrases
\usepackage{imakeidx}
\makeindex[title=Index, intoc=true]
\renewcommand{\seename}{see}
\renewcommand{\alsoname}{see also}
%% hyperref driver does not need to be specified, it will be detected
\usepackage{hyperref}
%% configure hyperref's  \url  to match listings' inline verbatim
\renewcommand\UrlFont{\small\ttfamily}
%% Hyperlinking active in PDFs, all links solid and blue
\hypersetup{colorlinks=true,linkcolor=blue,citecolor=blue,filecolor=blue,urlcolor=blue}
\hypersetup{pdftitle={Differential Equations Lecture Notes}}
%% If you manually remove hyperref, leave in this next command
\providecommand\phantomsection{}
%% Graphics Preamble Entries
\usepackage{pgfplots}
\usepackage{tikz-qtree}
\pgfplotsset{compat=newest}
\usetikzlibrary{decorations.markings,decorations.pathreplacing,arrows,calc,backgrounds}
% These are the TikZ-PGFPlots settings I need.
\pgfplotsset{mystyle/.style={%
view={120}{30},
axis lines=center,
width=6cm,
xlabel=$x$, xlabel style={at=(current axis.right of origin), anchor=west},
ylabel=$y$, ylabel style={at=(current axis.above origin), anchor=south},
grid=both,
vector/.style={-stealth,blue,very thick}, 
vector guide/.style={dashed,red,thick}
}}

\pgfplotsset{numberline/.style={%
axis x line = center,
axis y line = none,
xlabel = {$x$},
ymin=0,
ymax=0}}

\tikzset{
jumpdot/.style={mark=*,solid},
excl/.append style={jumpdot,fill=white},
incl/.append style={jumpdot,fill=black},
}
%% If tikz has been loaded, replace ampersand with \amp macro
\ifdefined\tikzset
    \tikzset{ampersand replacement = \amp}
\fi
%% extpfeil package for certain extensible arrows,
%% as also provided by MathJax extension of the same name
%% NB: this package loads mtools, which loads calc, which redefines
%%     \setlength, so it can be removed if it seems to be in the 
%%     way and your math does not use:
%%     
%%     \xtwoheadrightarrow, \xtwoheadleftarrow, \xmapsto, \xlongequal, \xtofrom
%%     
%%     we have had to be extra careful with variable thickness
%%     lines in tables, and so also load this package late
\usepackage{extpfeil}
%% Custom Preamble Entries, late (use latex.preamble.late)
%% Begin: Author-provided packages
%% (From  docinfo/latex-preamble/package  elements)
%% End: Author-provided packages
%% Begin: Author-provided macros
%% (From  docinfo/macros  element)
%% Plus three from MBX for XML characters
\newcommand{\RR}{\mathbb{R}}
\newcommand{\QQ}{\mathbb{Q}}
\newcommand{\NN}{\mathbb{N}}
\newcommand{\ZZ}{\mathbb{Z}}
\newcommand{\CC}{\mathbb{C}}
\renewcommand{\th}{\text{th}}
\renewcommand{\vec}[1]{\mathbf{#1}}
\newcommand{\vv}[1]{\mathbf{#1}}
\newcommand{\grad}{\nabla}
\newcommand{\vecm}[1]{\bm{#1}}
\newcommand{\Sum}[2]{\sum_{#1}^{#2}}    
\newcommand{\Int}[2]{\int_{#1}^{#2}}
\newcommand{\limit}[2]{\lim_{#1\to#2}}
\newcommand{\Laplace}[1]{\mathcal{L}\set*{#1}}
\newcommand{\iLaplace}[1]{\mathcal{L}^{-1}\set*{#1}}
\newcommand{\dv}[3][]{\dfrac{d^{#1} #2}{d #3^{#1}}}
\newcommand{\pdv}[3][]{\dfrac{\partial^{#1} #2}{\partial #3^{#1}}}
\newcommand{\dotprod}[1]{\left\langle #1 \right\rangle}
\newcommand{\set}[1]{\left\{ #1 \right\}}
\newcommand{\brackets}[1]{\left[ #1 \right]}
\newcommand{\parens}[1]{\left( #1 \right)}
\newcommand{\qq}[1]{\quad\text{#1}\quad}
\newcommand{\ivec}[1]{
  \renewcommand{\arraystretch}{.8}
  \begin{bmatrix}#1\end{bmatrix}
  }
\newcommand{\proj}[2]{\operatorname{proj}_{#1} #2}
\newcommand{\lt}{<}
\newcommand{\gt}{>}
\newcommand{\amp}{&}
%% End: Author-provided macros
\begin{document}
%
%
\typeout{************************************************}
\typeout{Chapter 1 Introduction to Ordinary Differential Equations}
\typeout{************************************************}
%
\begin{chapterptx}{Introduction to Ordinary Differential Equations}{}{Introduction to Ordinary Differential Equations}{}{}\label{intro-to-odes}
\begin{introduction}{}%
\hypertarget{p-1}{}%
In the sciences, many quantities of interest are varying quantities. Some changing quantities, like the position of a baseball dropped from a height of \SI{100}{\foot}, are relatively simple to determine, but others are more complicated. Think of a wildlife population, which varies from season to season and year to year. How can one accurately estimate the size of such a population?%
\par
\hypertarget{p-2}{}%
The field of \terminology{differential equations} attempts to answer such questions by providing a model for the quantity of interest using information about its rate of change, which is sometimes easier to obtain than information about the quantity itself. Once we know enough about how a quantity changes, we hope to make a decent estimate for how the quantity actually behaves. There are actually two different types of differential equations that we will look at in this course. The first is the ordinary differential equation.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Section 1.1 Ordinary Differential Equations}
\typeout{************************************************}
%
\begin{sectionptx}{Ordinary Differential Equations}{}{Ordinary Differential Equations}{}{}\label{section-ordinary-differential-equations}
\begin{introduction}{}%
\hypertarget{p-3}{}%
This section corresponds to Section 1.1 from the textbook.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 1.1.1 Basic Concepts}
\typeout{************************************************}
%
\begin{subsectionptx}{Basic Concepts}{}{Basic Concepts}{}{}\label{subsection-basic-concepts-for-odes}
\hypertarget{p-4}{}%
First, a definition of the primary concept in this course: the differential equation.%
\begin{definition}{Differential Equations.}{definition-differential-equations}%
\index{differential equations!definition}\hypertarget{p-5}{}%
A \terminology{differential equation} is an equation relating some function with its derivatives. A differential equation that involves a function of only one independent variable is called an \terminology{ordinary differential equation}, or ODE. A differential equation that involves a function of more than one independent variable (which you see a lot of in Calculus 3) is called a \terminology{partial differential equation}, or PDE, and will be studied in more detail in \hyperref[partial-differential-equations]{Chapter~\ref{partial-differential-equations}}. The \terminology{order} of a differential equation is the highest derivative that appears in the equation.%
\end{definition}
\hypertarget{p-6}{}%
Examples of ODEs: \leavevmode%
\begin{itemize}[label=\textbullet]
\item{}\hypertarget{p-7}{}%
\(\dv[2]{y}{x} + y = 0\); this is a second order ODE relating the unknown function \(y\) with its second derivative.%
\item{}\hypertarget{p-8}{}%
\(5t^{2}x^{'''} - e^{x} = 3t\); this is a seventh order ODE involving the derivatives of the unknown function \(x\). Note that in this ODE \(t\) is the independent variable whereas \(x\) serves as the dependent variable.%
\end{itemize}
%
\par
\hypertarget{p-9}{}%
Just as with equations in algebra, we can sometimes solve a differential equation.%
\begin{definition}{Solution of a Differential Equation.}{definition-solution-of-a-differential-equation}%
\index{differential equations!solution}\hypertarget{p-10}{}%
A function is a \terminology{solution} of a differential equation if it satisfies the differential equation.%
\end{definition}
\hypertarget{p-11}{}%
It is straightforward to check if a function is a solution of some given differential equation, but \emph{finding} solutions will make up the bulk of this course.%
\begin{example}{Verifying solutions.}{example-verifying-solutions}%
\hypertarget{p-12}{}%
Is \(y = 5e^{x^{2}}\) a solution of the ODE \(y' = 2xy\)?%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-1}{}\quad%
\hypertarget{p-13}{}%
At this point we don't know how to solve differential equations, but that doesn't mean we can't \emph{check} solutions of differential equations. To do so, we just plug \(5e^{x^{2}}\) wherever \(y\) shows up in the ODE and see if the resulting equation is true. So we have%
\begin{align*}
y' & = 2xy \\
(5e^{x^{2}})' & = 2x(5e^{x^{2}}) \text{ after substituting }y = 5e^{x^{2}}\\
10xe^{x^{2}} & = 10xe^{x^{2}} \text{ after simplifying} 
\end{align*}
This is a true statement, so \(y = 5e^{x^{2}}\) satisfies the ODE. Hence \(5e^{x^{2}}\) is a solution of the ODE.%
\end{example}
\hypertarget{p-14}{}%
In \hyperref[example-verifying-solutions]{Example~\ref{example-verifying-solutions}}, \(y = 5e^{x^{2}}\) is not the only solution of \(y' = 2xy\). You can check that \(y = 3e^{x^{2}}\) and \(y = -10e^{x^{2}}\) are also solutions. In fact, \emph{any} function of the form \(Ce^{x^{2}}\) where \(C\) is a constant is a solution of \(y' = 2xy\). See \hyperref[figure-family-of-solutions]{Figure~\ref{figure-family-of-solutions}}.%
\begin{figure}
\centering
\includegraphics[width=1\linewidth]{images/image-1.pdf}
\caption{A family of solutions of \(y' = 2xy\).\label{figure-family-of-solutions}}
\end{figure}
\hypertarget{p-15}{}%
Solutions of ODEs that depend on arbitrary constants, such as \(y = Ce^{x^{2}}\) above, are called \terminology{general solutions}. Solutions of ODEs that do not depend on arbitrary constants, such as \(y = 5e^{x^{2}}\), are called \terminology{particular solutions}.%
\begin{example}{A trigonometric solution.}{example-a-trigonometric-sol}%
\hypertarget{p-16}{}%
Show that \(x = A\cos(3t) + B\sin(3t)\), where \(A\) and \(B\) are arbitrary constants, is a general solution of \(x'' + 9x = 0\). Then find a particular solution.%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-2}{}\quad%
\hypertarget{p-17}{}%
To check that \(x = A\cos(3t) + B\sin(3t)\) is a general solution of \(x''+9x = 0\), we just need to plug it into the ODE and show that it satisfies it. Since%
\begin{equation*}
x'' = -9(A\cos(3t)+B\sin(3t)) = -9x,
\end{equation*}
this follows very quickly.%
\par
\hypertarget{p-18}{}%
To find a particular solution, all we need to do in this case is to pick specific values for \(A\) and \(B\) (any values will work here). So one particular solution of \(x''+9x = 0\) is given by \(x = \frac{3}{2}\cos(3t) - \sin(3t)\), among infinitely many others.%
\end{example}
\hypertarget{p-19}{}%
In \hyperref[example-a-trigonometric-sol]{Example~\ref{example-a-trigonometric-sol}}, to find a particular solution we just needed to plug in specific values for the arbitrary constants. In general, the particular solutions we'll be interested in are chosen to satisfy a given condition, which we call an \terminology{initial condition}. These conditions often take the form \(y(x_{0}) = y_{0}\). Geometrically, we are picking a specific point \((x_{0},y_{0})\) in the \(xy\)-plane that the solution must pass through.%
\par
\hypertarget{p-20}{}%
An ODE together with an initial condition is called an \terminology{initial value problem (IVP)}. Although ODEs by themselves typically have infinitely many solutions, specifying an initial condition that the solution must satisfy is often enough to get a unique particular solution instead of a general solution.%
\begin{example}{Solving an IVP.}{example-solving-an-ivp}%
\hypertarget{p-21}{}%
Solve the IVP \(\dv{y}{x} = -xe^{-x^{2}}, y(0)=1\).%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-3}{}\quad%
\hypertarget{p-22}{}%
We need to find a function \(y\) that satisfies two different constraints: \(y' = -xe^{-x^{2}}\) and \(y(0)=1\). We'll start with the first one, which we actually know how to do from Calculus I. If \(y' = -xe^{-x^{2}}\), then%
\begin{equation*}
y = \int -xe^{-x^{2}}\,dx = \frac{1}{2}e^{-x^{2}}+C.
\end{equation*}
Now we need to make sure that \(y\) is equal to \(1\) if \(x=0\). We do this by setting \(y=1\), \(x=0\) and choosing the right value for \(C\) to make the resulting equation true:%
\begin{equation*}
1 = \frac{1}{2} + C \Rightarrow C = \frac{1}{2}.
\end{equation*}
So the solution of this IVP is the function \(y = \frac{e^{-x^{2}}+1}{2}\).%
\end{example}
\hypertarget{p-23}{}%
Two important things to keep in mind before we move to the next topic: \leavevmode%
\begin{enumerate}
\item\hypertarget{li-3}{}\hypertarget{p-24}{}%
ODEs by themselves have general solutions, whereas IVPs have particular solutions.%
\item\hypertarget{li-4}{}\hypertarget{p-25}{}%
When solving IVPs, it's important to keep track of any arbitrary constants that appear. Neglecting arbitrary constants usually makes it impossible to find the right particular solution.%
\end{enumerate}
%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.1.2 Mathematical Models}
\typeout{************************************************}
%
\begin{subsectionptx}{Mathematical Models}{}{Mathematical Models}{}{}\label{subsection-mathematical-models}
\hypertarget{p-26}{}%
Differential equations are useful because they can provide a mathematical model of a physical quantity. Analyzing the model allows us to infer something meaningful about the quantity in question. A relatively simple model comes from \terminology{Newton's Law of Cooling}, which relates the temperature of an object with the temperature of the surrounding medium (such as air or water). In particular, Newton's Law of Cooling states that the time rate of change of the temperature of an object is proportional to the difference of the temperature of the object with that of the temperature of the surrounding medium.%
\begin{example}{Newton's Law of Cooling.}{example-newton-s-law-of-cooling}%
\hypertarget{p-27}{}%
Restate Newton's Law of Cooling as a differential equation.%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-4}{}\quad%
\hypertarget{p-28}{}%
It may not be obvious that Newton's Law of Cooling can be restated as a differential equation, but the phrase "rate of change" that appears in the statement of the law is a good clue that this can be done. To do this, first we need to give the relevant quantities (the temperature of the object and the temperature of the surrounding medium) names. Let \(T(t)\) denote the temperature of the object at time \(t\) and let \(A(t)\) denote the temperature of the surrounding medium at time \(t\). Then Newton's Law of Cooling says that%
\begin{equation*}
\dv{T}{t} = k(T-A)
\end{equation*}
where \(k\) is some constant.%
\par
\hypertarget{p-29}{}%
Although we can't determine \(k\) precisely (this would require experimentation and depends on the object and medium in question), we can still say something useful about it. In particular, \(k\) must be negative. To see why, consider what the object does if \(T\gt A\) and \(T\lt A\). If \(T\gt A\), then the object must be cooling since the surrounding medium is cooler than the object. If the object is cooling, then \(\dv{T}{t}\lt0\). On the other hand, if \(T\lt A\) then \(\dv{T}{t}\gt0\) since the object would be heating up in this case. The only way for this to occur is if \(k\lt0\).%
\end{example}
\hypertarget{p-30}{}%
Most of the mathematical models we'll look at will take the form of an IVP.%
\begin{example}{An IVP modeling a falling object.}{example-an-ivp-modeling-a-falling-object}%
\hypertarget{p-31}{}%
A ball weighing \SI{0.5}{\kilo\gram} is dropped from a height of \SI{100}{\meter} and is acted upon by gravity and air resistance. Assuming that the force of air resistance is proportional to the velocity of the ball, what is an IVP that models the movement of the ball?%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-5}{}\quad%
\hypertarget{p-32}{}%
What we need to do is to translate this physical situation into mathematics, and to do that we need to start assigning names to the quantities of interest. The quantities that matter in this problem are the movement of the ball, the force of gravity and the force of air resistance. We'll name them as follows:%
\begin{align*}
\text{height of the ball  seconds after its released} &= y(t) \\
\text{force of gravity} &= F_{G} = mg = -4.9\\
\text{force of air resistance} &= F_{R} = k\dv{y}{t} 
\end{align*}
where \(C\) is negative (since air resistance should act \emph{against} velocity). To get a differential equation out of all this, we'll use Newton's Second Law (which is actually a second-order ODE in disguise). This says that the net force on the ball should be equal to its mass times acceleration: \(F = ma\). So we have%
\begin{equation*}
F_{G}+F_{R} = 0.5\dv[2]{y}{t}
\end{equation*}
or just%
\begin{equation*}
-4.9+k\dv{y}{t} = 0.5\dv[2]{y}{t}.
\end{equation*}
The initial condition in this case would be \(y(0) = 100\). So our IVP is%
\begin{equation*}
-4.9+k\dv{y}{t} = 0.5\dv[2]{y}{t}, y(0) = 100.
\end{equation*}
%
\end{example}
\hypertarget{p-33}{}%
One quick note about the IVP in \hyperref[example-an-ivp-modeling-a-falling-object]{Example~\ref{example-an-ivp-modeling-a-falling-object}} The differential equation was second-order, but there was only one corresponding initial condition. As we'll see later, this is not enough to find a unique solution to this IVP. For most IVPs we'll solve, we'll need as many initial conditions as the order of the ODE. Something to look forward to.%
\end{subsectionptx}
\begin{conclusion}{}%
\hypertarget{p-34}{}%
Now that we have a rough idea of what an ODE and an IVP actually are, we can move on to solving them. In the next section, we'll look at a method that we can use to visualize ODEs and their solutions and another method that can be used to approximate solutions of ODEs.%
\par
\hypertarget{p-35}{}%
SUGGESTED PROBLEMS: 1-13 odd%
\end{conclusion}%
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 1.2 Direction Fields}
\typeout{************************************************}
%
\begin{sectionptx}{Direction Fields}{}{Direction Fields}{}{}\label{section-direction-fields}
\begin{introduction}{}%
\hypertarget{p-36}{}%
This section corresponds to Section 1.2 from the textbook.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 1.2.1 Direction Fields and Solution Curves}
\typeout{************************************************}
%
\begin{subsectionptx}{Direction Fields and Solution Curves}{}{Direction Fields and Solution Curves}{}{}\label{subsection-direction-fields-and-solution-curves}
\hypertarget{p-37}{}%
Suppose we wanted to solve the ODE \(\dv{y}{x} = x\). Then we can do so using the tools already available to us, since the mystery function \(y=y(x)\) must have derivative given by \(x\). So%
\begin{equation*}
y = \int x\,dx = \frac{1}{2}x^{2}+C.
\end{equation*}
Any choice for \(C\) yields another solution of the ODE \(\dv{y}{x} = x\).%
\footnote{Again, it's very important in this course not to forget the arbitrary constant \(C\)!\label{fn-1}}\hypertarget{p-38}{}%
Now let's make things a little more interesting. Suppose we wanted to solve the ODE \(\dv{y}{x} = e^{-x^{2}}\). Then this is \emph{impossible} to do in a single "closed-form". \footnote{By closed-form we basically mean in terms of the usual exponential, trigonometric and polynomial functions, as well as their inverses.\label{fn-2}} This is because solving this ODE requires integrating \(e^{-x^{2}}\), which as you may remember from Calculus 2 cannot be done without resorting to something like power series. Even if we can't solve the ODE, or if we can't solve it easily, we still want to be able to obtain some information from it. One way to do this is by using \terminology{direction fields}, which is a graphical representation of the ODE.%
\par
\hypertarget{p-39}{}%
To construct a direction field for an ODE of the form%
\begin{equation*}
\dv{y}{x} = f(x,y)
\end{equation*}
perform the following steps: \leavevmode%
\begin{enumerate}
\item\hypertarget{li-5}{}Pick a point \((a,b)\) in the \(xy\)-plane.%
\item\hypertarget{li-6}{}Plug the point \((a,b)\) into \(f(x,y)\) to obtain the number \(f(a,b)\).%
\item\hypertarget{li-7}{}Plot a short line segment with slope \(f(a,b)\) at the point \((a,b)\).%
\item\hypertarget{li-8}{}Repeat at several other points in the \(xy\)-plane until you develop a satisfactory picture of the behavior of the ODE.%
\end{enumerate}
 The resulting graph is called the direction field for the ODE.%
\begin{aside}{}{aside-1}%
\hypertarget{p-40}{}%
Direction fields are often called slope fields.%
\end{aside}
\begin{example}{Plotting a direction field by hand.}{example-plotting-a-direction-field-by-hand}%
\hypertarget{p-41}{}%
Fill in the direction field for \(y' = t - y\) at the indicated points:%
\begin{figure}
\centering
{
    \begin{tikzpicture}
    \begin{axis}[%
    axis x line = center,
    axis y line = center,
    grid=both,
    xtick={-1,...,3},
    ytick={-1,...,3},
    xmin=-2,
    xmax=4,
    ymin=-2,
    ymax=4,
    xlabel={$t$},
    ylabel={$y$}
    ]
    \addplot[only marks,mark=*] table{%
    % 0 3
    1   1
    0   2
    2   2
    % 2 3
    2   1
    0   0
    0   1
    0   2
    1   2
    % 1 3
    1   0
    2   0
    };
    \end{axis}
\end{tikzpicture}
}
\end{figure}
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-6}{}\quad%
\hypertarget{p-42}{}%
To plot the direction field, remember that we're basically plotting \emph{slopes}. So we first need to figure out \(y' = t-y\) at the indicated points. The following table lists values for \(y'\) at some of these points: \begin{table}
\centering
\begin{tabular}{cc}\hrulethick
\((t,y)\)&\(y' = t-y\)\tabularnewline\hrulethin
\((0,0)\)&\(0-0 = 0\)\tabularnewline\hrulethin
\((2,2)\)&\(2-2=0\)\tabularnewline\hrulethin
\((1,2)\)&\(1-2 = -1\)\tabularnewline\hrulethin
\((0,1)\)&\(0-1=-1\)\tabularnewline\hrulethick
\end{tabular}
\end{table}
 If we fill out the remaining values of \(y'\) and plot the corresponding slopes, we should get something like this:%
\begin{figure}
\centering
{
\def\length{sqrt(1+(x-y)^2)}
\begin{tikzpicture}
\begin{axis}[
    axis x line = center,
    axis y line = center,
    grid=both,
    xlabel={$t$},
    ylabel={$y$},
    view={0}{90},
    domain=0:2,
    y domain=0:2,
    xmin=-2, ymin=-2,
    xmax=4, ymax=4,
    xtick={-1,...,3},
    ytick={-1,...,3},
    samples=3
]
\addplot3 [blue, thick, quiver={u={1/(\length)}, v={(x-y)/(\length)}, scale arrows=0.5}] {0};
\addplot[only marks,mark=*] table{%
% 0 3
1   1
0   2
2   2
% 2 3
2   1
0   0
0   1
0   2
1   2
% 1 3
1   0
2   0
};
\end{axis}
\end{tikzpicture}
}
\end{figure}
\end{example}
\begin{example}{Plotting a direction field with a CAS.}{example-plotting-a-direction-field-with-a-cas}%
\hypertarget{p-43}{}%
Plot the direction field for the differential equation \(x' = x(1-x)\), where \(x=x(t)\).%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-7}{}\quad%
\hypertarget{p-44}{}%
We can easily do this with a computer system (such as Maple!). If we do so, we get the following diagram:%
\begin{figure}
\centering
\includegraphics[width=0.5\linewidth]{images/image-4.pdf}
\caption{The direction field for \(x' = x(1-x)\).\label{figure-dirfield1}}
\end{figure}
\end{example}
\hypertarget{p-45}{}%
Direction fields are useful because they provide a means to obtain information about a differential equation (and the corresponding model) without actually having to solve the differential equation. This is often done by drawing a \terminology{solution curve} through a direction field, which represents a solution of an initial value problem corresponding to the ODE the direction field is drawn from. To draw a solution curve, just pick a point in the direction field and follow along the slopes as best you can.%
\begin{example}{Information from a solution curve.}{example-information-from-a-solution-curve}%
\hypertarget{p-46}{}%
Let \(x(t)\) represent the solution of the initial value problem%
\begin{align*}
x' & = x(1-x) \\
x(0) & = \frac{1}{2}. 
\end{align*}
Determine \(\lim_{t\to\infty}x(t)\).%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-8}{}\quad%
\hypertarget{p-47}{}%
Since we don't know how to solve this IVP yet, we'll make use of the direction field from \hyperref[example-plotting-a-direction-field-with-a-cas]{Example~\ref{example-plotting-a-direction-field-with-a-cas}} to find an approximate solution curve. Since the initial condition is \(x(0) = \frac{1}{2}\), this means that the solution must pass through the point \((0,\frac{1}{2})\). So if we start at this point and trace a curve that flows with the direction field, we get the following solution curve:%
\begin{figure}
\centering
\includegraphics[width=0.5\linewidth]{images/image-5.pdf}
\caption{The solution curve corresponding to the initial condition \(x(0) = \frac{1}{2}\).\label{figure-solcurve1}}
\end{figure}
\hypertarget{p-48}{}%
So it appears that \(\lim_{t\to\infty}x(t) = 1\).%
\end{example}
\end{subsectionptx}
\begin{conclusion}{}%
\hypertarget{p-49}{}%
SUGGESTED PROBLEMS: 1-7 odd%
\end{conclusion}%
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 1.3 Separable ODEs and Substitution}
\typeout{************************************************}
%
\begin{sectionptx}{Separable ODEs and Substitution}{}{Separable ODEs and Substitution}{}{}\label{section-separable-odes-and-substitution}
\begin{introduction}{}%
\hypertarget{p-50}{}%
This section corresponds to Section 1.3 from the text.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 1.3.1 Separable ODEs}
\typeout{************************************************}
%
\begin{subsectionptx}{Separable ODEs}{}{Separable ODEs}{}{}\label{subsection-separable-odes}
\hypertarget{p-51}{}%
The simplest ODEs to solve are the first-order ODEs of the form \(\dv{y}{x} = f(x)\). The Fundamental Theorem of Calculus guarantees that the solution \(y\) is given by \(y = \int f(x)\,dx\).%
\footnote{Rather, the Fundamental Theorem of Calculus guarantees that the solution will be \(y=\int f(x)\,dx\) as long as \(f\) is a continuous function.\label{fn-3}}\hypertarget{p-52}{}%
Another type of ODE that is relatively straightforward to solve is the \terminology{separable ODE}, which is a first-order ODE that can be written in the form%
%
\begin{equation*}
\dv{y}{x} = f(x)g(y).
\end{equation*}
\hypertarget{p-53}{}%
These ODEs can be solved by integration as well, but only after some rearranging.%
\begin{example}{Solving a separable ODE.}{example-solving-a-separable-ode}%
\hypertarget{p-54}{}%
Solve the IVP given by \(y' = x+4xy^{2}, y(0)=1\).%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-9}{}\quad%
\hypertarget{p-55}{}%
The first step to solving this IVP is to solve the ODE \(y' = x+4xy^{2}\). It may not look like it at first, but this ODE is separable since we can rewrite it as \(y' = x(1+4y^{2})\). To solve this ODE, we need to move the \(y\) terms to the left hand side of the equation and the \(x\) terms to the right hand side. We'll abuse notation a little bit to do so by rewriting \(y' = \dv{y}{x}\) and treating \(\dv{y}{x}\) as a fraction, but it won't get us into too much trouble here:%
%
\begin{align*}
\dv{y}{x} = x(1+4y^{2}) &\Rightarrow \frac{dy}{1+4y^{2}} = x\,dx \\
&\Rightarrow \int\frac{dy}{1+4y^{2}}  = \int x\,dx \\
&\Rightarrow \frac{1}{2}\tan^{-1}(2y)  = \frac{1}{2}x^{2}+C \\
&\Rightarrow \tan^{-1}(2y)  = x^{2}+C_{1} 
\end{align*}
\hypertarget{p-56}{}%
At this step we can either leave the solution as is (in \terminology{implicit form}) or solve for \(y\) to get an \terminology{explicit form}. We'll leave this in implicit form and then plug in the initial condition to get%
\begin{equation*}
\tan^{-1}(2) = C_{1}.
\end{equation*}
So the implicit solution of this IVP is given by%
\begin{equation*}
\tan^{-1}(2y) = x^{2}+\tan^{-1}(2).
\end{equation*}
%
\end{example}
\begin{example}{Newton's Law of Cooling again.}{example-newton-s-law-of-cooling-again}%
\hypertarget{p-57}{}%
A metal plate is removed from an oven and placed in a room. The temperature of the plate is \(100^{\circ}\) Celsius and the temperature of the room is fixed at \(15^{\circ}\) Celsius. After \(20\) minutes the temperature of the plate drops to \(90^{\circ}\) Celsius. How hot is the plate after five hours?%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-10}{}\quad%
\hypertarget{p-58}{}%
Let \(T(t)\) denote the temperature of the plate \(t\) minutes after being removed from the oven and let \(A(t)\) denote the temperature of the room \(t\) minutes after the plate is removed from the oven. Then \(T(0) = 100\) and Newton's Law of Cooling says that%
%
\begin{equation*}
\dv{T}{t} = k(T-15).
\end{equation*}
\hypertarget{p-59}{}%
To answer this question we need to find \(T\), and although we don't know \(k\) at the moment we can still make some progress just by remembering that it's a constant. This ODE is separable, so we'll separate variables and integrate both sides to get%
\begin{equation*}
\ln(T-15) = kt+C
\end{equation*}
which simplifies to \(T-15 = C_{1}e^{kt}\) or just \(T = 15+C_{1}e^{kt}\).%
\par
\hypertarget{p-60}{}%
Now we need to find \(C_{1}\) and \(k\). To find \(C_{1}\), we just use the initial condition to get \(C_{1} = 85\). The only piece of information that we have left to find \(k\) is the fact that the temperature of the plate drops to \(90\) after \(20\) minutes. In other words, \(T(20) = 90\). Therefore%
\begin{equation*}
90 = 15+85e^{20k}
\end{equation*}
which becomes%
\begin{equation*}
\ln\frac{75}{85} = 20k\text{.}
\end{equation*}
Therefore \(k = \frac{1}{20}\ln\frac{15}{17}\approx-.006.\)%
\par
\hypertarget{p-61}{}%
So, finally, \(T(t) = 15+85e^{-.006t}\) and the temperature after five hours is \(T(300)\approx28\).%
\end{example}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.3.2 Substitution Methods}
\typeout{************************************************}
%
\begin{subsectionptx}{Substitution Methods}{}{Substitution Methods}{}{}\label{subsection-substitution-methods}
\hypertarget{p-62}{}%
At this point we can only solve a couple types of differential equations. An ODE that isn't of the form \(\dv{y}{x} = f(x)\) or separable may prove troublesome. However, there are certain cases where we can rewrite an ODE into one of these forms by using the right substitution.%
\begin{example}{Substitution to solve an ODE.}{example-substitution-to-solve-an-ode}%
\hypertarget{p-63}{}%
Find the general solution of \(y' = (x+y+3)^{2}\).%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-11}{}\quad%
\hypertarget{p-64}{}%
This ODE is not separable and we can't just integrate it (since the right hand side depends on the dependent variable). However, the form of the right hand side suggests a substitution: \(u = x+y+3\). This would simplify things quite a bit, leaving us with \(y'=u^{2}\). The only problem with this is that \(y'\) depends on \(x\), not \(u\). We must rewrite \(y'\) in terms of the new variable \(u\), which isn't too bad. Since \(u = x+y+3\), we get \(y' = u'-1\). Therefore the ODE becomes%
\begin{equation*}
u'-1 = u^{2}\text{ or just }\dv{u}{x} = 1+u^{2}.
\end{equation*}
%
\par
\hypertarget{p-65}{}%
This new ODE \emph{is} separable, and so we separate variables and integrate to get \(\tan^{-1}u = x+C\). If we don't care about finding an explicit solution, then we can just replace \(u\) to get the equation back in terms of \(y\). So our (implicit) general solution is \(\tan^{-1}(x+y+3) = x+C\).%
\end{example}
\begin{example}{A less obvious substitution.}{example-a-less-obvious-substitution}%
\hypertarget{p-66}{}%
Find an explicit solution of \(xy'=x+y\).%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-12}{}\quad%
\hypertarget{p-67}{}%
It's tough to see what to do right away, so we'll try simplifying the ODE first. In particular, we'll solve for \(y'\) to get%
\begin{equation*}
y' = 1+\frac{y}{x}.
\end{equation*}
If we stare at this for a while, we might convince ourselves that the right hand side really just depends on \(\frac{y}{x}\), so we'll try replacing that with \(u\). Then the ODE becomes \(y'=1+u\).%
\par
\hypertarget{p-68}{}%
Once again, this is much simpler but we need to rewrite \(y'\) in terms of \(u\). Since \(u=\frac{y}{x}\), this means that \(y=ux\) and so \(y' = u+u'x\). Then the ODE becomes%
\begin{equation*}
u+x\dv{u}{x} = 1+u\text{ or just } x\dv{u}{x} = 1\text{.}
\end{equation*}
%
\par
\hypertarget{p-69}{}%
This new ODE can be rearranged to get \(\dv{u}{x} = \frac{1}{x}\), and so \(u = \ln|x|+C\). Getting back in terms of \(y\), we have \(\frac{y}{x} = \ln|x|+C\) or just \(y = x\ln|x|+Cx\).%
\end{example}
\end{subsectionptx}
\begin{conclusion}{}%
\hypertarget{p-70}{}%
SUGGESTED PROBLEMS: 3, 5, 9, 11, 15, 19, 25%
\end{conclusion}%
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 1.4 First-Order Linear ODEs}
\typeout{************************************************}
%
\begin{sectionptx}{First-Order Linear ODEs}{}{First-Order Linear ODEs}{}{}\label{section-first-order-linear-odes}
\begin{introduction}{}%
\hypertarget{p-71}{}%
In this section we introduce a new type of ODE that we can solve, in addition to separable ODEs and "simple" ODEs of the form \(y'=f(x)\). The ODEs that we'll consider in this section are \terminology{first-order linear ODEs}.%
\begin{definition}{First-Order Linear ODEs.}{definition-first-order-linear-odes}%
\index{first-order ODEs!first-order linear ODEs}\hypertarget{p-72}{}%
A first-order ODE is said to be linear if it can be written in the following form:%
\begin{equation*}
\dv{y}{x} + P(x)y = Q(x).
\end{equation*}
%
\end{definition}
\hypertarget{p-73}{}%
We've actually seen such an ODE all the way back in \hyperref[example-an-ivp-modeling-a-falling-object]{Example~\ref{example-an-ivp-modeling-a-falling-object}}. The ODE that we came up with in that problem can be rewritten as a first-order linear ODE with the right substitution (say, \(u = y'\)). Our first goal in this section is then to figure out how to solve these ODEs.%
\par
\hypertarget{p-74}{}%
Note that this section corresponds to Section 1.5 from the text.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 1.4.1 Integrating Factors}
\typeout{************************************************}
%
\begin{subsectionptx}{Integrating Factors}{}{Integrating Factors}{}{}\label{subsection-integrating-factors}
\hypertarget{p-75}{}%
To get a sense of how to solve first-order linear ODEs, we'll try some relatively simple examples first.%
\begin{example}{Solving a first-order linear ODE.}{example-solving-a-first-order-linear-ode}%
\hypertarget{p-76}{}%
Find the general solution of \(\dv{y}{x}+2y = x\).%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-13}{}\quad%
\hypertarget{p-77}{}%
First, note that the ODE is indeed a first-order linear ODE since it takes the form given in \hyperref[definition-first-order-linear-odes]{Definition~\ref{definition-first-order-linear-odes}}. If we stare at the ODE for a bit, we might think that the left hand side looks like something we'd get after using the product rule. Just compare \((fg)' = fg'+f'g\) with \(\dv{y}{x}+2y\), and it appears that the unknown function \(y\) is taking the place of \(g\) in the product rule formula. If we could just figure out what the function \(f\) is supposed to be, then we could drastically simplify the left hand side of the ODE.%
\par
\hypertarget{p-78}{}%
Unfortunately, there is no such function \(f\) that works here. If there were, we'd have to have \(f'=2\) and \(f=2x\), and clearly we aren't multiplying \(\dv{y}{x}\) by \(2x\) in the ODE. But we can pull a dirty trick here! We'll multiply through the ODE by \(e^{2x}\) to get the new ODE%
\begin{equation*}
e^{2x}\dv{y}{x}+2e^{2x}y = xe^{2x}.
\end{equation*}
It might not be all that obvious why this helps us out, but now the left hand side can be simplified by the product rule:%
\begin{equation*}
e^{2x}\dv{y}{x}+2e^{2x}y = \dv{}{x}[e^{2x}y].
\end{equation*}
%
\par
\hypertarget{p-79}{}%
So we can rewrite the entire ODE as%
\begin{equation*}
\dv{}{x}[e^{2x}y] = xe^{2x}.
\end{equation*}
We can integrate this on both sides to get \(e^{2x}y = \int xe^{2x}\,dx\), or just%
\begin{equation*}
e^{2x}y = \frac{1}{2}xe^{2x} - \frac{1}{4}e^{2x}+C.
\end{equation*}
The explicit solution would be \(y = \frac{1}{2}x - \frac{1}{4} + Ce^{-2x}\).%
\end{example}
\hypertarget{p-80}{}%
The function \(e^{2x}\) that we used in \hyperref[example-solving-a-first-order-linear-ode]{Example~\ref{example-solving-a-first-order-linear-ode}} is called an \terminology{integrating factor}. Integrating factors are our primary tool in solving first-order linear ODEs. In general, to solve a first-order linear ODE \(y' +P(x)y=Q(x)\) the first thing you must do is to multiply through it by the integrating factor \(e^{\int P(x)\,dx}\).%
\begin{example}{Solving a first-order linear ODE in disguise.}{example-solving-a-first-order-linear-ode-in-disguise}%
\hypertarget{p-81}{}%
Solve the second-order ODE given by%
\begin{equation*}
tx''+\frac{t}{1+t^{2}}x' = \frac{2t^{2}}{(1+t^{2})^{2}}e^{-\tan^{-1}t}
\end{equation*}
with initial conditions \(x(0) = x'(0) = -1.\)%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-14}{}\quad%
\hypertarget{p-82}{}%
Even though this is a second-order ODE, we can rewrite it as a first-order ODE using the substitution \(u = x'\). Then the ODE becomes%
\begin{equation*}
tu+\frac{t}{1+t^{2}}u = \frac{2t^{2}}{(1+t^{2})^{2}}e^{-\tan^{-1}t}.
\end{equation*}
If we divide through by \(t\), we get%
\begin{equation*}
u+\frac{1}{1+t^{2}}u = \frac{2t}{(1+t^{2})^{2}}e^{-\tan^{-1}t}.
\end{equation*}
This can be solved by integrating factors since it takes the form given in \hyperref[definition-first-order-linear-odes]{Definition~\ref{definition-first-order-linear-odes}}. The integrating factor we need is given by%
\begin{equation*}
e^{\int \frac{1}{1+t^{2}}\,dt} = e^{\tan^{-1}t}.
\end{equation*}
%
\par
\hypertarget{p-83}{}%
Now we multiply through the ODE by this integrating factor and rewrite the left hand side using the product rule to get%
\begin{equation*}
\dv{}{t}[e^{\tan^{-1}t}u] = \frac{2t}{(1+t^{2})^{2}}.
\end{equation*}
At this step we can integrate both sides to get%
\begin{equation*}
e^{\tan^{-1}t}u = -\frac{1}{1+t^{2}}+C,
\end{equation*}
which becomes%
\begin{equation*}
x' = -\frac{e^{-\tan^{-1}t}}{1+t^{2}}+Ce^{-\tan^{-1}t}.
\end{equation*}
%
\par
\hypertarget{p-84}{}%
If we plug in the initial condition \(x'(0) = -1\), this forces \(C=0\). Hence%
\begin{equation*}
x' = -\frac{e^{-\tan^{-1}t}}{1+t^{2}}.
\end{equation*}
Now we integrate one last time to get \(x\):%
\begin{equation*}
x = e^{-\tan^{-1}t}+D.
\end{equation*}
If we use the last initial condition \(x(0)=-1\), we see that \(D = -2\). Hence the solution of this IVP is%
\begin{equation*}
x = e^{-\tan^{-1}t}-2.
\end{equation*}
%
\end{example}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.4.2 Applications}
\typeout{************************************************}
%
\begin{subsectionptx}{Applications}{}{Applications}{}{}\label{subsection-applications}
\hypertarget{p-85}{}%
A common application of first-order linear ODEs is in modeling "mixture" problems. Suppose we have a tank which contains a solution (mixture of solute and solvent, such as salt and water). Some amount of solution is also flowing into and out of the tank. We want to measure the amount of solute in the tank at time \(t\), call this amount \(x(t)\). Then \(x(t)\) will change depending on how the solute flows into and out of the tank, making it a prime target for a differential equation.%
\par
\hypertarget{p-86}{}%
If we set%
\begin{align*}
c_{i} & =\text{concentration of solute flowing in} \\
c_{o} & =\text{concentration of solute flowing out} \\
r_{i} & =\text{rate solution is flowing in} \\
r_{o} & = \text{rate solution is flowing out} 
\end{align*}
then we can say that%
\begin{equation*}
\dv{x}{t} = r_{i}c_{i} - r_{o}c_{o} = r_{i}c_{i} - r_{0}\frac{x(t)}{V(t)}
\end{equation*}
where \(V(t)\) is the volume of solution in the tank at time \(t\). \footnote{We assume that \(c_{i},r_{i},r_{o}\) are all constant.\label{fn-4}} Furthermore, if we let \(V_{0} = V(0)\) denote the initial volume of the solution in the tank then we can say that \(V(t) = V_{0} + (r_{i}-r_{0})t.\) Hence the amount of solute \(x(t)\) obeys the first-order linear ODE%
\begin{equation*}
\dv{x}{t} = r_{i}c_{i} - \frac{r_{o}}{V_{0}+(r_{i}-r_{o})t}x.
\end{equation*}
%
\begin{example}{Salt in a tank.}{example-salt-in-a-tank}%
\hypertarget{p-87}{}%
A tank contains \SI{100}{\liter} of a solution consisting of \SI{50}{\kilo\gram} of salt dissolved in water. Solution containing \SI{1}{\kilo\gram\per\liter} of salt is pumped into the tank at a rate of \SI{2}{\liter\per\minute} and the well-mixed solution is pumped out at the rate of \SI{3}{\liter\per\minute}. How much salt will be in the tank after \(t\) minutes?%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-15}{}\quad%
\hypertarget{p-88}{}%
Let \(x(t)\) denote the amount of salt in the tank after \(t\) minutes, so \(x(0) = 50\). Then%
\begin{equation*}
\dv{x}{t} = r_{i}c_{i}-r_{o}c_{o} = 2\cdot1-3\frac{x}{100-t}.
\end{equation*}
We can rearrange this to get%
\begin{equation*}
\dv{x}{t} + \frac{3}{100-t}x = 2.
\end{equation*}
This ODE is linear and has integrating factor \((100-t)^{-3}\). Multiplying through the ODE by the integrating factor and rewriting it using the product rule then gives us%
\begin{equation*}
\dv{}{t}[(100-t)^{-3}x] = 2(100-t)^{-3}.
\end{equation*}
%
\par
\hypertarget{p-89}{}%
Now we can integrate both sides to get%
\begin{equation*}
(100-t)^{-3}x = (100-t)^{-2}+C
\end{equation*}
or just \(x = 100-t+C(100-t)^{3}\). Finally, the initial condition can be used to show that \(C = -\frac{1}{20000}\), so \(x = 100-t - \frac{1}{20000}(100-t)^{3}\).%
\end{example}
\end{subsectionptx}
\begin{conclusion}{}%
\hypertarget{p-90}{}%
SUGGESTED PROBLEMS: 3-11 odd, 31, 33.%
\end{conclusion}%
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 1.5 Existence and Uniqueness of Solutions}
\typeout{************************************************}
%
\begin{sectionptx}{Existence and Uniqueness of Solutions}{}{Existence and Uniqueness of Solutions}{}{}\label{section-existence-and-uniqueness-of-solutions}
\begin{introduction}{}%
\hypertarget{p-91}{}%
This section corresponds to Section 1.7 from the text.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 1.5.1 Existence and Uniqueness Theorem}
\typeout{************************************************}
%
\begin{subsectionptx}{Existence and Uniqueness Theorem}{}{Existence and Uniqueness Theorem}{}{}\label{subsection-existence-and-uniqueness-theorem}
\hypertarget{p-92}{}%
There are two important questions we need to consider when developing a mathematical model using differential equations (i.e. IVPs): \leavevmode%
\begin{enumerate}
\item\hypertarget{li-9}{}Does the initial value problem have a solution? (Existence).%
\item\hypertarget{li-10}{}If it has a solution, is the solution unique? (Uniqueness).%
\end{enumerate}
 Ideally, the answer to both of these questions will be yes.%
\begin{example}{The answer is no.}{example-the-answer-is-no}%
\hypertarget{p-93}{}%
Does \(x\dv{y}{x} = \sqrt[3]{y},y(1) = 0\) have a unique solution?%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-16}{}\quad%
\hypertarget{p-94}{}%
We can find a solution to this IVP by treating the ODE as separable. If we do so, we find that \(y = \left(\frac{2}{3}\ln x\right)^{\frac{3}{2}}\). On the other hand, we can also eyeball a second solution: \(y=0\). So this IVP has \emph{two} different solutions: \(y_{1} = \left(\frac{2}{3}\ln x\right)^{\frac{3}{2}}\) and \(y_{2} = 0\).%
\end{example}
\hypertarget{p-95}{}%
Clearly, IVPs don't always have unique solutions. Sometimes it's difficult to determine precisely when an IVP can have a unique solution, but most of the cases we'll care about in this class will fall under the following theorem.%
\begin{theorem}{Existence and Uniqueness Theorem.}{}{theorem-existence-and-uniqueness-theorem}%
\index{first-order ODEs!existence and uniqueness}\hypertarget{p-96}{}%
Consider the IVP given by \(\dv{y}{x} = f(x,y), y(x_{0}) = y_{0}\). If \(f(x,y)\) is bounded and continuous within some rectangle in the plane containing \((x_{0},y_{0})\), then the IVP has at least one solution. If in addition \(f_{y}(x,y)\) is also bounded and continuous within some rectangle containing \((x_{0},y_{0})\), then the IVP has a unique solution.%
\end{theorem}
\hypertarget{p-97}{}%
If we go back to \hyperref[example-the-answer-is-no]{Example~\ref{example-the-answer-is-no}}, then we see that \hyperref[theorem-existence-and-uniqueness-theorem]{Theorem~\ref{theorem-existence-and-uniqueness-theorem}} has something to say about the IVP in that example. In that example, we had \(f(x,y) = \sqrt[3]{y}, f_{y}(x,y) = \frac{1}{3}y^{-\frac{2}{3}}\) and \((x_{0},y_{0}) = (1,0)\). Let's draw a rectangle around this point: \begin{figure}
\centering
{
\begin{tikzpicture}
    \begin{axis}[%
    axis x line = center,
    axis y line = center,
    xlabel = {$x$},
    ylabel = {$y$},
    xmin=0,
    xmax=2,
    ymin=-1,
    ymax=2,
    grid = both
    ]
    \draw[fill=blue!40,opacity=.5] (.5,-.5) rectangle (1.5,1.5);
    \draw (1,1) node{$R$};
    \addplot[mark=*]table{%
    1   0
    } node[above right]{$(x_{0},y_{0})$};
    \end{axis}
\end{tikzpicture}
}
\end{figure}
%
\par
\hypertarget{p-98}{}%
Now \(f\) is continuous and \(-\frac{1}{2}\leq y\leq\frac{3}{2}\) within this rectangle, so%
\begin{equation*}
-\sqrt[3]{\frac{1}{2}}\leq f(x,y)\leq\sqrt[3]{\frac{3}{2}}
\end{equation*}
everywhere inside of this triangle. So \hyperref[theorem-existence-and-uniqueness-theorem]{Theorem~\ref{theorem-existence-and-uniqueness-theorem}} guarantees \emph{at least one} solution of the IVP, and indeed there is at least one solution. However, the problem with uniqueness stems from the fact that \(f_{y}\) has a divide-by-zero problem inside this rectangle. Furthermore, it's impossible to draw a rectangle around \((1,0)\) that avoids this divide-by-zero problem. Hence there is no guarantee of uniqueness.%
\par
\hypertarget{p-99}{}%
On the other hand, if we changed the initial condition to \(y(1) = 0.000001\) then we would be guaranteed a unique solution. Moving that initial condition off of the \(x\)-axis is all we need to do to guarantee uniqueness.%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.5.2 Picard Iteration}
\typeout{************************************************}
%
\begin{subsectionptx}{Picard Iteration}{}{Picard Iteration}{}{}\label{subsection-picard-iteration}
\hypertarget{p-100}{}%
Now that we know of a way to determine whether or not certain ODEs have solutions, we'd like a method for actually finding these solutions. We've seen a few different methods for solving specific first-order ODEs, but what we'll do now is discuss a method that works for a large class of first-order ODEs. The only catch is that it may take us an infinite amount of time to get the solution.%
\par
\hypertarget{p-101}{}%
Consider the IVP \(\dv{y}{x} = f(x,y), y(x_{0}) = y_{0}\). We can rewrite this differential equation as an \terminology{integral equation}:%
\begin{equation*}
y(x) = y_{0} + \int_{x_{0}}^{x}f(t,y(t))\,dt.
\end{equation*}
It looks quite a bit different, but solutions of this integral equation are also solutions of the corresponding differential equation. Our goal now is to approximate a solution to this integral equation.%
\par
\hypertarget{p-102}{}%
To start, let's make a guess as to what the solution of our IVP should be. To keep things simple we'll start with a constant function, say \(\phi_{0}(x) = y_{0}\) so that we at least satisfy the initial condition. Now this guess may not be a good match for the solution of the IVP away from the initial condition, so we'll adjust the guess using the integral equation to get the new function \(\phi_{1}\):%
\begin{equation*}
\phi_{1}(x) = y_{0} + \int_{x_{0}}^{x}f(t,\phi_{0})\,dt.
\end{equation*}
Now \(\phi_{1}\) may not be a great approximation either away from the initial condition, but we can adjust it using the integral equation just like we did to \(\phi_{0}\).%
\par
\hypertarget{p-103}{}%
The method described in the previous paragraph is \terminology{Picard's Method}. In general, the \(n^{\text{th}}\) iteration of Picard's Method is given by%
\begin{equation*}
\phi_{n}(x) = y_{0}+\int_{x_{0}}^{x}f(t,\phi_{n-1}(t))\,dt,
\end{equation*}
and the first iterate is the constant function \(\phi_{0} = y_{0}.\) It may seem strange to consider these functions as approximate solutions of the IVP in question, but each iterate actually solves an IVP very similar to the one that we care about, \(\dv{y}{x} = f(x,y), y(x_{0}) = y_{0}\). In particular,%
\begin{equation*}
\dv{\phi_{n}}{x} = f(x,\phi_{n-1}), \phi_{n}(x_{0}) = y_{0}
\end{equation*}
for all \(n\geq1\). This method doesn't always work, but if \(f(x,y)\) satisfies the conditions given in \hyperref[theorem-existence-and-uniqueness-theorem]{Theorem~\ref{theorem-existence-and-uniqueness-theorem}} then this method will (after potentially infinitely many steps) provide a solution to the IVP.%
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 1.6 Population Models and Autonomous Equations}
\typeout{************************************************}
%
\begin{sectionptx}{Population Models and Autonomous Equations}{}{Population Models and Autonomous Equations}{}{}\label{section-population-models-and-autonomous-equations}
%
%
\typeout{************************************************}
\typeout{Subsection 1.6.1 Population Equations}
\typeout{************************************************}
%
\begin{subsectionptx}{Population Equations}{}{Population Equations}{}{}\label{subsection-population-equations}
\hypertarget{p-104}{}%
Suppose we're monitoring the population of some species, and let's denote the population at time \(t\) by \(P(t)\). An obvious question to consider is how that population will change over time. Mathematically, this means we want to obtain information on \(\dv{P}{t}\) and then use it to estimate \(P(t)\).%
\par
\hypertarget{p-105}{}%
A simple model for \(\dv{P}{t}\) is to assume it depends only on the birth rate \(\beta\) and death rate \(\delta\) of the species in question. Then we can write%
\begin{equation}
\dv{P}{t} = (\beta - \delta)P.\label{equation-natural-growth}
\end{equation}
If we assume that \(\beta,\delta\) are constants, then this equation is separable and we can solve it to obtain%
\begin{equation*}
P(t) = P_{0}e^{(\beta - \delta)t},
\end{equation*}
where \(P_{0}\) represents the "initial population", or population at time \(t = 0\). We call \hyperref[equation-natural-growth]{(\ref{equation-natural-growth})} the \terminology{natural growth equation}.%
\par
\hypertarget{p-106}{}%
The natural growth equation is simple, but it's probably too simple to be useful expect in certain scenarios (such as measuring half-life). To get a more flexible model, we can generalize \hyperref[equation-natural-growth]{(\ref{equation-natural-growth})} by assuming that the birth and death rates are actually functions of time. This gives us the \terminology{general population equation}.%
\begin{definition}{General Population Equation.}{definition-general-population-equation}%
\hypertarget{p-107}{}%
The general population equation for a population \(P(t)\) is given by%
\begin{equation*}
\dv{P}{t} = (\beta(t) - \delta(t))P.
\end{equation*}
%
\end{definition}
\begin{example}{Population Explosion.}{example-population-explosion}%
\hypertarget{p-108}{}%
A population has \(100\) members at time \(t = 0\) years with a death rate of \(.25P\) and a birth rate of \(.5P\), where \(P(t)\) denotes the population after \(t\) years. Find \(P(t)\) and determine if this is a reasonable population model.%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-17}{}\quad%
\hypertarget{p-109}{}%
If we assume that the population obeys the general growth equation, then we get%
\begin{equation*}
P' = .25P^{2}, P(0) = 100.
\end{equation*}
This ODE is separable, and we can therefore solve it to get%
\begin{equation*}
P(t) = \frac{100}{1 - 25t}.
\end{equation*}
%
\par
\hypertarget{p-110}{}%
So we have a solution, and furthermore \hyperref[theorem-existence-and-uniqueness-theorem]{Theorem~\ref{theorem-existence-and-uniqueness-theorem}} guarantees that the solution is unique. But if you stare at this for a bit, you might see that it has a divide-by-zero problem. In particular,%
\begin{equation*}
\lim_{t\to(\frac{1}{25})^{+}}P(t) = \infty.
\end{equation*}
In other words, the population becomes infinite in about two weeks!%
\end{example}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.6.2 The Logistic Equation}
\typeout{************************************************}
%
\begin{subsectionptx}{The Logistic Equation}{}{The Logistic Equation}{}{}\label{subsection-the-logistic-equation}
\hypertarget{p-111}{}%
\hyperref[example-population-explosion]{Example~\ref{example-population-explosion}} shows that we need to be more careful with our assumptions on population growth. One relatively simple assumption we can make is to assume that the birth rate \(\beta(t)\) decreases as population \(P\) increases. This makes sense in the physical world as well: as population increases, existing and finite resources (such as food) must be shared between more and more members of the population. Since there's less to go around, we should expect growth to slow down. In particular, let's assume that%
\begin{align*}
\beta(t) & = \beta_{0} - \beta_{1}P \\
\delta(t) & = \delta_{0} 
\end{align*}
where \(\beta_{0},\beta_{1}\) and \(\delta_{0}\) are all positive constants. Then the population equation for this scenario becomes%
\begin{equation*}
\dv{P}{t} = (\beta_{0} - \beta_{1}P - \delta_{0})P.
\end{equation*}
%
\par
\hypertarget{p-112}{}%
With a little algebra, we get the \terminology{logistic equation}:%
\begin{equation*}
\dv{P}{t} = kP(M-P)
\end{equation*}
for constants \(k\) and \(M\). This equation is separable, and can be solved using partial fractions to obtain%
\begin{equation*}
P(t) = \frac{MP_{0}}{P_{0} + (M - P_{0})e^{-kMt}},
\end{equation*}
where \(P_{0} = P(0)\). In order to verify the reasonableness of our logistic model, let's see what happens to the population as time increases.%
\begin{example}{Long-Term Behavior of Logistic Growth.}{example-long-term-behavior-of-logistic-growth}%
\hypertarget{p-113}{}%
What is the long-term population of a species that grows according to the logistic equation \(\dv{P}{t} = kP(M-P)\)?%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-18}{}\quad%
\hypertarget{p-114}{}%
Using the fact that%
\begin{equation*}
P(t) = \frac{MP_{0}}{P_{0} + (M - P_{0})e^{-kMt}},
\end{equation*}
we have%
\begin{equation*}
\lim_{t\to\infty}P(t) = M.
\end{equation*}
So the population should eventually level out at \(M\).%
\end{example}
\hypertarget{p-115}{}%
In the logistic equation \(P' = kP(M-P)\), the value \(M\) is the \terminology{carrying capacity}, and denotes the maximum sustainable population according to the model.%
\begin{example}{Population Growth in the USA.}{example-population-growth-in-the-usa}%
\hypertarget{p-116}{}%
In millions, the population of the USA in 1990 was \(250\) and was growing at a rate of \(3.1\) per year. In 2012, the population was \(314\) and was growing at a rate of \(2.3\) per year. Assuming that the population of the USA grows logistically, estimate the population of the USA in 2017 and compare it to the current estimate of \(325.7\).%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-19}{}\quad%
\hypertarget{p-117}{}%
Let \(P(t)\) denote the population of the USA (in millions), where \(t\) is the number of years after 1990. Then%
\begin{equation*}
\dv{P}{t} = kP(M-P)
\end{equation*}
and%
\begin{equation*}
P(t) = \frac{MP_{0}}{P_{0} + (M - P_{0})e^{-kMt}}.
\end{equation*}
So we need to find \(k\) and \(M\).%
\par
\hypertarget{p-118}{}%
When \(t = 0\), we have \(P' = 3.1\) and \(P = 250\). Similarly, when \(t = 22\) we have \(P' = 2.3\) and \(P = 314\). Therefore%
\begin{align*}
3.1 & = 250k(M - 250) \\
2.3 & = 314k(M - 314) 
\end{align*}
Solving this system gives us \(k\approx.00008\) and \(M \approx 406.4\). Hence%
\begin{equation*}
P(t) = \frac{101600}{250 + 156.4e^{-.03t}}.
\end{equation*}
%
\par
\hypertarget{p-119}{}%
This model estimates the population in 2017 to be%
\begin{equation*}
P(27) = 317.9,
\end{equation*}
which is about a \(2\%\) error. Note also that this model predicts the carrying capacity of the USA to be \(406.4\).%
\end{example}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.6.3 Stability of Solutions}
\typeout{************************************************}
%
\begin{subsectionptx}{Stability of Solutions}{}{Stability of Solutions}{}{}\label{section-stability-of-solutions}
\hypertarget{p-120}{}%
The logistic equation%
\begin{equation*}
\dv{P}{t} = kP(M-P)
\end{equation*}
is a particularly nice separable ODE since the right hand side depends only on the unknown function \(P\). So we can write \(P' = f(P)\), where \(f(P) = kP(M-P)\). ODEs like this (where the independent variable does not appear explicitly) are called \terminology{autonomous ODEs}.%
\par
\hypertarget{p-121}{}%
Autonomous ODEs like \(\dv{x}{t} = f(x)\) are useful because the behavior of their solutions can be determined \emph{qualitatively}, without actually solving the ODE. This is done by looking for the constant solutions of the ODE, that is, solutions of the form \(x = c\). For any such solution, we must have \(f(c) = 0\) as well. These solutions (i.e., the solutions of \(f(x) = 0\)) are called the \terminology{critical points} or \terminology{equilibrium solutions} of the ODE. These solutions completely determine the long-term behavior of \emph{every other solution}.%
\begin{example}{Finding Equilibrium Solutions.}{example-finding-equilibrium-solutions}%
\hypertarget{p-122}{}%
Find the equilibrium solutions of \(\dv{x}{t} = -x^{2} + 7x - 10\).%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-20}{}\quad%
\hypertarget{p-123}{}%
We need to solve the equation \(-x^{2} + 7x - 10 = 0\). Thankfully, we can factor this to get \((2-x)(x-5) = 0\), and so the equilibrium solutions are \(x = 2,5\).%
\end{example}
\begin{definition}{Stability of Solutions.}{definition-stability-critial-points}%
\hypertarget{p-124}{}%
A critical point is \terminology{stable} if solutions that start "near" the point stay near it. A critical point is \terminology{unstable} if solutions that start "near" the point can diverge away from it.%
\end{definition}
\begin{example}{Determining the Stability of Solutions.}{example-determining-the-stability-of-solutions}%
\hypertarget{p-125}{}%
What are the stable critical points of \(\dv{x}{t} = -x^{2} + 7x - 10\)?%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-21}{}\quad%
\hypertarget{p-126}{}%
We already know that the critical points are \(x = 2, 5\). We can determine their stability by making use of a \terminology{phase diagram}, which is essentially a sign chart for \(f(x) = -x^{2} + 7x - 10\):%
\begin{figure}
\centering
{
\begin{tikzpicture}
    % draw the line
    \draw (-1,0) -- (7,0);

    % draw arrows on line 
    \draw[ultra thick,color=blue,<-] (1,0) -- (2,0);
    \draw[ultra thick,color=blue,->] (2,0) -- (3,0);
    \draw[ultra thick,color=blue,->] (4,0) -- (5,0);
    \draw[ultra thick,color=blue,<-] (5,0) -- (6,0);

    % draw the ticks at critical points
    \foreach \x in {2,5}
        \draw[xshift=\x cm] (0pt,5pt) -- (0pt,-2pt) node[yshift=-.4cm,fill=white]{$x=\the\numexpr\x$};

    % label the signs
    \node[yshift=.5cm] at (1,0){$f(x)<0$};
    \node[yshift=.5cm] at (3.5,0){$f(x)>0$};
    \node[yshift=.5cm] at (6,0){$f(x)<0$};
\end{tikzpicture}
}
\caption{The phase diagram for \(x' = f(x).\)\label{figure-7}}
\end{figure}
\hypertarget{p-127}{}%
This shows us that solutions that begin near \(x = 2\) tend to move away from \(x = 2\), which solutions near \(x = 5\) tend to move towards \(x = 5\). So \(x = 2\) is unstable and \(x = 5\) is stable.%
\end{example}
\begin{example}{Determining a Sustainable Population.}{example-determining-a-sustainable-population}%
\hypertarget{p-128}{}%
Consider a population of fish that obeys the logistic equation%
\begin{equation*}
\dv{P}{t} = 2P(30 - P)
\end{equation*}
where \(P(t)\) is the population of fish (in thousands) after \(t\) years. Suppose that the population is also harvested at some rate \(h\) (in thousands per year). What is the maximum sustainable rate of harvesting?%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-22}{}\quad%
\hypertarget{p-129}{}%
To account for the harvesting, we need to modify the ODE:%
\begin{equation*}
\dv{P}{t} = 2P(30 - P) - h.
\end{equation*}
The harvesting will be sustainable as long as the population does not become extinct. To determine this long term behavior, we'll find the critical points and set up a phase diagram.%
\par
\hypertarget{p-130}{}%
The critical points are given by%
\begin{equation*}
P = 15 \pm \sqrt{3600 - 8h}
\end{equation*}
by the quadratic formula. We now have three cases to consider: \(3600 - 8h \lt 0, 3600 - 8h = 0, 3600 - 8h \gt 0.\) In terms of \(h\), these reduce to \(h \lt 450, h = 450, h \gt 450\).%
\leavevmode%
\begin{enumerate}
\item\hypertarget{li-11}{}\hypertarget{p-131}{}%
In the first case, if \(h \lt 450\) then we have two positive, real critical points:%
\begin{equation*}
0 \lt c_{1} \lt 15 \lt c_{2} \lt 75.
\end{equation*}
The phase diagram for this situation is%
\begin{figure}
\centering
{
\begin{tikzpicture}
    % draw the line
    \draw (-1,0) -- (7,0);

    % draw arrows on line 
    \draw[ultra thick,color=blue,<-] (1,0) -- (2,0);
    \draw[ultra thick,color=blue,->] (2,0) -- (3,0);
    \draw[ultra thick,color=blue,->] (4,0) -- (5,0);
    \draw[ultra thick,color=blue,<-] (5,0) -- (6,0);

    % draw the ticks at critical points
    \draw[xshift=0 cm] (0pt,5pt) -- (0pt,-2pt) node[yshift=-.4cm,fill=white]{$P=0$};
    \draw[xshift=2 cm] (0pt,5pt) -- (0pt,-2pt) node[yshift=-.4cm,fill=white]{$P=c_{1}$};
    \draw[xshift=3.5 cm] (0pt,5pt) -- (0pt,-2pt) node[yshift=-.4cm,fill=white]{$P=15$};
    \draw[xshift=5 cm] (0pt,5pt) -- (0pt,-2pt) node[yshift=-.4cm,fill=white]{$P=c_{2}$};
    \draw[xshift=6.5 cm] (0pt,5pt) -- (0pt,-2pt) node[yshift=-.4cm,fill=white]{$P=75$};

    % label the signs
    \node[yshift=.5cm] at (0,0){$\dv{P}{t}<0$};
    \node[yshift=.5cm] at (3.5,0){$\dv{P}{t}>0$};
    \node[yshift=.5cm] at (6.5,0){$\dv{P}{t}<0$};
\end{tikzpicture}
}
\end{figure}
\hypertarget{p-132}{}%
So we see that \(c_{1}\) is unstable while \(c_{2}\) is stable. In particular, as long as \(P\geq c_{1} = 15 - \sqrt{3600 - 8h}\), then the rate of harvesting is sustainable.%
\item\hypertarget{li-12}{}\hypertarget{p-133}{}%
Now assume that \(h = 450\). Then we have only one equilibrium solution: \(c = 15\). The corresponding phase diagram is%
\begin{figure}
\centering
{
    \begin{tikzpicture}
    % draw the line
    \draw (0,0) -- (4,0);

    % draw arrows on line 
    \draw[ultra thick,color=blue,<-] (1,0) -- (2,0);
    \draw[ultra thick,color=blue,<-] (2,0) -- (3,0);

    % draw the ticks at critical points
    \draw[xshift=2 cm] (0pt,5pt) -- (0pt,-2pt) node[yshift=-.4cm,fill=white]{$P=15$};

    % label the signs
    \node[yshift=.5cm] at (1,0){$\dv{P}{t}<0$};
    \node[yshift=.5cm] at (3,0){$\dv{P}{t}<0$};
    \end{tikzpicture}
}
\end{figure}
\hypertarget{p-134}{}%
We interpret the phase diagram as follows: if \(P\) is less than \hypertarget{p-135}{}%
15,000%
 then the population will collapse to extinction. Otherwise, the population will stabilize at \(15,000\). This type of critical point is often called \terminology{semi-stable.}%
\item\hypertarget{li-13}{}\hypertarget{p-136}{}%
Finally, consider the case \(h \gt 450\). Then we have no (real) critical points. Since imaginary populations don't make sense in this model, there is no sustainable population. No matter how large the initial population, it will eventually go extinct if harvested at a rate greater than \(450\).%
\end{enumerate}
\hypertarget{p-137}{}%
By the above, the largest sustainable harvesting rate is \(h = 450,\) as long as \(P_{0}\geq 15\).%
\end{example}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 1.6.4 Linear Stability Analysis}
\typeout{************************************************}
%
\begin{subsectionptx}{Linear Stability Analysis}{}{Linear Stability Analysis}{}{}\label{subsection-linear-stability-analysis}
\hypertarget{p-138}{}%
Given the autonomous ODE \(\dv{x}{t} = f(x)\), we saw above that we can qualify the behavior of equilibrium solutions by setting up a phase diagram. We can go a step further and actually qualify the growth of solutions that are "near" equilibrium solutions. In particular, we have the following theorem.%
\begin{theorem}{Linear Stability Analysis.}{}{theorem-linear-stability-analysis}%
\hypertarget{p-139}{}%
Suppose \(\dv{x}{t} = f(x)\) where \(f(x)\) is continuously differentiable, and let \(x^{*}\) denote a critical point/equilibrium solution of the ODE. If \(f'(x^{*}) \lt 0\), then \(x^{*}\) is stable and solutions near \(x^{*}\) will move exponentially towards \(x^{*}\). If \(f'(x^{*}) \gt 0\), then \(x^{*}\) is unstable and solutions near \(x^{*}\) will move exponentially away from \(x^{*}\). If \(f'(x^{*}) = 0\), then more advanced methods are required.%
\end{theorem}
\begin{example}{Classifying the Critical Points of the Logistic Equation.}{example-classifying-the-critical-points-of-the-logistic-equation}%
\hypertarget{p-140}{}%
Classify the critical points of the logistic equation as stable or unstable.%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-23}{}\quad%
\hypertarget{p-141}{}%
Recall that the logistic equation is given by \(P' = kP(M-P) = f(P)\) for (we'll assume) positive constants \(k,M\). From here, we clearly see that the critical points are \(P = 0\) and \(P = M\) (which makes sense from a population standpoint!). We could set up a phase diagram to determine stability, but we'll use \hyperref[theorem-linear-stability-analysis]{Theorem~\ref{theorem-linear-stability-analysis}} instead.%
\par
\hypertarget{p-142}{}%
Since \(f'(P) = k(M-P) - kP\), we see that%
\begin{align*}
f'(0) & = kM \gt 0\\
f'(M) & = -kM \lt 0 
\end{align*}
Hence \(P = 0\) is unstable, while \(P = M\) is stable.%
\end{example}
\end{subsectionptx}
\end{sectionptx}
\end{chapterptx}
%
%
\typeout{************************************************}
\typeout{Chapter 2 Linear ODEs with Constant Coefficients}
\typeout{************************************************}
%
\begin{chapterptx}{Linear ODEs with Constant Coefficients}{}{Linear ODEs with Constant Coefficients}{}{}\label{linear-odes-constant-coefficients}
\begin{introduction}{}%
\hypertarget{p-143}{}%
Now we move on to solving linear ODEs with constant coefficients. We'll start with solving second-order ODEs.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Section 2.1 Second-Order Linear ODEs}
\typeout{************************************************}
%
\begin{sectionptx}{Second-Order Linear ODEs}{}{Second-Order Linear ODEs}{}{}\label{section-second-order-linear-odes}
\begin{introduction}{}%
\hypertarget{p-144}{}%
Recall that a second-order ODE is an ODE whose highest derivative is the second derivative. In this section, we'll look at how to solve second-order ODEs of a special type. Our method of solution here will be generalized to many, many other ODEs.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 2.1.1 Types of Linear ODEs}
\typeout{************************************************}
%
\begin{subsectionptx}{Types of Linear ODEs}{}{Types of Linear ODEs}{}{}\label{subsection-types-of-linear-odes}
\hypertarget{p-145}{}%
A first-order ODE is linear if it can be written in the form \(y'+P(x)y = Q(x)\) (see \hyperref[definition-first-order-linear-odes]{Definition~\ref{definition-first-order-linear-odes}}). We have a similar definition for second-order ODEs.%
\begin{definition}{Second-Order Linear ODEs.}{definition-second-order-linear-odes}%
\index{second-order ODEs!second-order linear ODEs!homogeneous and nonhomogeneous}\hypertarget{p-146}{}%
A second-order ODE is \terminology{linear} if it can be written in the form%
\begin{equation*}
y''+P(x)y'+Q(x)y = R(x).
\end{equation*}
A second-order linear ODE is \terminology{homogeneous} if \(R(x) = 0\) and \terminology{nonhomogeneous} if \(R(x)\neq0\).%
\end{definition}
\begin{example}{Types of second-order ODEs.}{example-types-of-second-order-odes}%
\hypertarget{p-147}{}%
Consider the following ODEs: \leavevmode%
\begin{enumerate}
\item\hypertarget{li-14}{}\(y'' = y' - \sin^{2}x\) is linear but nonhomogeneous.%
\item\hypertarget{li-15}{}\(\dv[2]{x}{t} - x^{3} = 0\) is nonlinear.%
\item\hypertarget{li-16}{}\(\sqrt{x}e^{\tan^{-1}x}y'' = x^{2}y\) is linear and homogeneous.%
\end{enumerate}
%
\end{example}
\hypertarget{p-148}{}%
Newton's Second Law is a great source of linear second-order ODEs, as \hyperref[example-a-second-order-model]{Example~\ref{example-a-second-order-model}} shows. However, we will first need to state \terminology{Hooke's Law}.%
\begin{theorem}{Hooke's Law.}{}{theorem-hooke-s-law}%
\index{Hooke's Law}\hypertarget{p-149}{}%
Consider an object attached to a spring. The force exerted by the spring on the object is directly proportional to the displacement of the object from the spring's equilibrium, or at rest, position.%
\end{theorem}
\begin{example}{A second-order model.}{example-a-second-order-model}%
\hypertarget{p-150}{}%
An object of mass \SI{4}{\kilo\gram} is attached to a horizontal, frictionless spring. Let \(x=0\) denote the equilibrium position of the spring and let \(x(t)\) denote the displacement of the mass from the spring's equilibrium position. The only force acting on the mass is the force of the spring itself. Find a mathematical model for \(x(t)\).%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-24}{}\quad%
\hypertarget{p-151}{}%
Let \(F_{S}\) denote the force of the spring on the mass. Then by \hyperref[theorem-hooke-s-law]{Theorem~\ref{theorem-hooke-s-law}} we must have \(F_{S} = -kx\) for some \(k>0\). Now, by Newton's Second Law we must also have \(F_{S} = 4x''\). Hence%
\begin{equation*}
4x'' = -kx\quad\text{or}\quad4x''+kx = 0.
\end{equation*}
So the motion of the mass is modeled by a linear, second-order homogeneous ODE.%
\end{example}
\begin{aside}{}{aside-2}%
\hypertarget{p-152}{}%
The reason we take \(F_{S} = -kx\) in Hooke's Law is because we want to emphasize that the spring force is a \emph{restoring force}, since it acts against the displacement of the mass.%
\end{aside}
\hypertarget{p-153}{}%
The general trend that we will see for mathematical models using linear ODEs is that they will be homogeneous if we assume that there is no external force, and nonhomogeneous if we assume there is an external force.%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.1.2 Solutions of Second-Order Linear ODEs}
\typeout{************************************************}
%
\begin{subsectionptx}{Solutions of Second-Order Linear ODEs}{}{Solutions of Second-Order Linear ODEs}{}{}\label{subsection-solutions-of-second-order-linear-ODEs}
\hypertarget{p-154}{}%
The reason we restrict ourselves to linear ODEs is because their solutions behave very nicely. In particular, we have the \hyperref[theorem-the-superposition-principle]{Theorem~\ref{theorem-the-superposition-principle}}, which is an important principle for homogeneous ODEs. First, some terminology.%
\begin{definition}{Linear Combinations.}{definition-linear-combinations}%
\index{linear combination!two functions}\hypertarget{p-155}{}%
Let \(f\) and \(g\) denote functions of \(x\). A \terminology{linear combination} of \(f\) and \(g\) is a function of the form \(c_{1}f+c_{2}g\) where \(c_{1},c_{2}\) are constants.%
\end{definition}
\begin{theorem}{The Superposition Principle.}{}{theorem-the-superposition-principle}%
\index{second-order ODEs!second-order linear ODEs!superposition principle}\hypertarget{p-156}{}%
Let \(y_{1}\) and \(y_{2}\) denote two (possibly different) solutions of the ODE \(y''+P(x)y'+Q(x)y = 0\). Then any linear combination of these solutions is itself another solution of the same ODE.%
\end{theorem}
\begin{proof}\hypertarget{proof-1}{}
\hypertarget{p-157}{}%
We need to show that \(y = c_{1}y_{1} + c_{2}y_{2}\) is another solution of the same ODE, where \(c_{1},c_{2}\) are arbitrary constants. To do this, we'll just plug the linear combination into the ODE and simplify:%
\begin{align*}
y''+P(x)y'+Q(x)y \amp = (c_{1}y_{1}+c_{2}y_{2})''+P(x)(c_{1}y_{1}+c_{2}y_{2})+Q(x)(c_{1}y_{1}+c_{2}y_{2})y \\
\amp = c_{1}y''_{1}+c_{2}y''_{2} + c_{1}P(x)y'_{1}+c_{2}P(x)y'_{2} + c_{1}Q(x)y_{1} + c_{2}Q(x)y_{2}\\
\amp = c_{1}(y''_{1}+P(x)y'_{1}+Q(x)y_{1}) + c_{2}(y''_{2}+P(x)y'_{2}+Q(x)y_{2}) \\
\amp = 0. \qedhere
\end{align*}
%
\end{proof}
\hypertarget{p-158}{}%
\hyperref[theorem-the-superposition-principle]{Theorem~\ref{theorem-the-superposition-principle}} is important because it tells us how to construct new solutions of homogeneous ODEs out of known solutions. The next example demonstrates this.%
\begin{example}{Solving a second-order IVP.}{example-solving-a-second-order-ivp}%
\hypertarget{p-159}{}%
Using the fact that \(y_{1} = \cosh\frac{x}{2}\) and \(y_{2} = \sinh\frac{x}{2}\) are both solutions of \(4y''-y = 0\), solve the IVP given by%
\begin{equation*}
4y''-y=0\quad\text{and}\quad y(0)=3,y'(0)=1.
\end{equation*}
%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-25}{}\quad%
\hypertarget{p-160}{}%
Note that we have \emph{two} initial conditions. In general, we'll need as many initial conditions as the order of the ODE.%
\par
\hypertarget{p-161}{}%
To solve the IVP, we'll use the superposition principle to give us as much leeway as possible in constructing a solution of out \(y_{1}\) and \(y_{2}\). So we'll guess the solution takes the form \(y = c_{1}\cosh\frac{x}{2} + c_{2}\sinh\frac{x}{2}\). By the superposition principle we're guaranteed that this is a solution of the ODE \(4y''-y=0\), so we just need to pick the constants \(c_{1},c_{2}\) in order to satisfy the initial conditions. Let's start with the first initial condition, \(y(0) = 3\). This gives us the equation%
\begin{equation*}
3 = c_{1}\cosh0+c_{2}\sinh0 = 3.
\end{equation*}
So \(c_{1} = 3\). Similarly, \(y'(0) = 1\) gives us%
\begin{equation*}
1 = \frac{3}{2}\sinh0+\frac{c_{2}}{2}\cosh0 = \frac{c_{2}}{2}.
\end{equation*}
Hence \(c_{2} = 2\), and the solution of the IVP is%
\begin{equation*}
y = 3\cosh\frac{x}{2} + 2\sinh\frac{x}{2}.
\end{equation*}
%
\end{example}
\hypertarget{p-162}{}%
The reason we were able to solve the IVP in \hyperref[example-solving-a-second-order-ivp]{Example~\ref{example-solving-a-second-order-ivp}} was because the individual solutions \(\cosh\frac{x}{2}\) and \(\sinh\frac{x}{2}\) gave us enough to build the particular solution of the IVP. It turns out that \emph{every} solution of \(4y''-y=0\) can be written as a linear combination of these two functions, so knowing these two functions is enough to solve every IVP involving this ODE.%
\par
\hypertarget{p-163}{}%
In general, our goal will be to describe a "basis" of solutions for a given homogeneous ODE, a finite set of solutions that can be used to describe all possible solutions. This can be done if the functions in the basis aren't too "similar", in the following sense.%
\begin{definition}{Linear Independence of Functions.}{definition-linear-independence-of-functions}%
\index{linear independence!two functions}\hypertarget{p-164}{}%
Two functions \(f\) and \(g\) are said to be \terminology{linearly independent} on an interval \(I\) if the linear combination \(c_{1}f + c_{2}g\) is equal to \(0\) if and only if \(c_{1} = c_{2} = 0\). Otherwise, we say that they are \terminology{linearly dependent}.%
\end{definition}
\hypertarget{p-165}{}%
The main idea behind \hyperref[definition-linear-independence-of-functions]{Definition~\ref{definition-linear-independence-of-functions}} is that \(f\) and \(g\) are linearly independent if they are not like terms (i.e. they don't cancel each other out). Note that \(f,g\) are linearly dependent if and only if \(f = \alpha g\) for some \(\alpha\neq 0\). Equivalently, they are linearly dependent if and only if \(\frac{f}{g} = \alpha\) for some \(\alpha\neq0\).%
\begin{example}{Linear independence of sine and cosine.}{example-linear-independence-of-sine-and-cosine}%
\hypertarget{p-166}{}%
Show that \(\sin x\) and \(\cos x\) are linearly independent.%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-26}{}\quad%
\hypertarget{p-167}{}%
Since \(\frac{\sin x}{\cos x} = \tan x\) is \emph{not} constant, this means that \(\sin x\) and \(\cos x\) must be linearly independent.%
\end{example}
\hypertarget{p-168}{}%
Although it wasn't too hard to see that the functions in \hyperref[example-linear-independence-of-sine-and-cosine]{Example~\ref{example-linear-independence-of-sine-and-cosine}} were linearly independent, in other cases it can be much trickier (especially when we move to higher order ODEs). For example, suppose we set \(f(t) = -5(t-15)^{2} + 450\) and \(g(t) = 12t(30-t)\). Then it's not obvious at all that these two functions are linearly dependent! In fact,%
\begin{equation*}
\frac{2}{5}f(t) - \frac{1}{6}g(t) = 0.
\end{equation*}
So generally when we try to determine if two functions are linearly independent, we'll make use of the \terminology{Wronskian}.%
\begin{definition}{Wronskian of Two Functions.}{definition-wronskian-of-two-functions}%
\index{Wronskian!two functions}\hypertarget{p-169}{}%
Let \(f\) and \(g\) denote two differentiable functions. The Wronskian of \(f\) and \(g\), denoted \(W(f,g)\), is given by%
\begin{equation*}
W(f,g) = \left|\begin{matrix} f \amp g \\ f' \amp g' \end{matrix}\right| = fg' - f'g.
\end{equation*}
%
\end{definition}
\begin{theorem}{Linear Independence and the Wronskian.}{}{theorem-linear-independence-and-the-wronskian}%
\hypertarget{p-170}{}%
Let \(f\) and \(g\) be two functions that are differentiable on some interval \(I\). Then \(f\) and \(g\) are linearly independent on \(I\) if \(W(f,g) \neq 0\) \emph{somewhere} \(I\). Conversely, if \(W(f,g) = 0\) \emph{and} \(f\) and \(g\) can both be represented by power series on \(I\), then \(f\) and \(g\) are linearly dependent.%
\end{theorem}
\begin{example}{Using the Wronskian.}{example-using-the-wronskian}%
\hypertarget{p-171}{}%
If we let \(f(t) = -5(t-15)^{2} + 450\) and \(g(t) = 12t(30-t)\) and compute their Wronskian, we obtain (after a fair bit of algebra) \(W(f,g) = 0\). Since \(f\) and \(g\) can clearly be represented by power series on any interval \(I\) (since, being polynomials, they already \emph{are} power series), this means that the two functions are linearly independent.%
\end{example}
\hypertarget{p-172}{}%
We mentioned earlier that we'll try to find a basis of solutions for linear ODEs. Now that we have the concept of linear independence and the Wronskian for checking if two functions are linearly independent, we can make the following definition.%
\begin{definition}{Basis of Solutions.}{definition-basis-of-solutions}%
\index{second-order ODEs!second-order linear ODEs!basis}\hypertarget{p-173}{}%
Let \(y_{1}\) and \(y_{2}\) denote solutions of some second-order linear homogeneous ODE. We call \(\{y_{1},y_{2}\}\) a \terminology{basis} if \(y_{1}\) and \(y_{2}\) are also linearly independent.%
\end{definition}
\hypertarget{p-174}{}%
Once we have a basis for a second-order linear homogeneous ODE, we can solve any IVP that we wish involving that ODE. In particular, if \(\{y_{1},y_{2}\}\) is a basis for such an ODE, then \emph{every} solution of the ODE can be written as a linear combination of \(y_{1}\) and \(y_{2}\).%
\begin{example}{Linear independence using the Wronskian.}{example-linear-independence-using-the-wronskian}%
\hypertarget{p-175}{}%
Let%
\begin{equation*}
x_{1} = t\cos\ln t\quad\text{and}\quad t\sin\ln t.
\end{equation*}
Given that these functions are both solutions of%
\begin{equation*}
t^{2}x'' - tx' + 2x = 0,
\end{equation*}
solve the corresponding IVP with initial conditions \(x(1) = 1, x'(1) = -1\).%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-27}{}\quad%
\hypertarget{p-176}{}%
We need to start by showing that \(\{x_{1},x_{2}\}\) is a basis for the ODE. First, we compute \(W(x_{1},x_{2})\):%
\begin{equation*}
W(x_{1},x_{2}) = (t\cos\ln t)(\sin\ln t + \cos\ln t) - (t\sin\ln t)(\cos\ln t - \sin\ln t) = t(\cos^{2}\ln t + \sin^{2}\ln t) = t.
\end{equation*}
So \(W(x_{1},x_{2}) = t\), which is clearly nonzero on the interval \((0,\infty)\). Hence \(x_{1}\) and \(x_{2}\) are linearly independent, and therefore \(\{x_{1},x_{2}\}\) is a basis for the ODE.%
\par
\hypertarget{p-177}{}%
To actually find the solution (call it \(x\)), we'll set \(x = c_{1}x_{1} + c_{2}x_{2}\) and use the initial conditions to find \(c_{1}\) and \(c_{2}\). Doing so gives \(c_{1} = 1\) and \(c_{2} = -2\), and so the solution of the IVP is%
\begin{equation*}
x = \cos\ln t - 2\sin\ln t.
\end{equation*}
%
\end{example}
\end{subsectionptx}
\begin{conclusion}{}%
\hypertarget{p-178}{}%
SUGGESTED PROBLEMS: 15, 17, 19%
\end{conclusion}%
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 2.2 Homogeneous ODEs with Constant Coefficients}
\typeout{************************************************}
%
\begin{sectionptx}{Homogeneous ODEs with Constant Coefficients}{}{Homogeneous ODEs with Constant Coefficients}{}{}\label{section-homogeneous-odes-with-constant-coefficients}
\hypertarget{p-179}{}%
Now we'll move on to solving homogeneous ODEs, at least with constant coefficients.%
\begin{example}{Solving a homogeneous ODE.}{example-solving-a-homogeneous-ode}%
\hypertarget{p-180}{}%
Suppose we wanted to solve \(y'' - y' - 6y = 0\), where \(y=y(x)\). If we stare at this for a bit, we may realize the following: the only way for a function \(y\) to be a solution of this ODE is for \(y\) and its derivatives \(y',y''\) to cancel each other our. In other words, \(y\) and its derivatives \emph{should be like terms}. This is a huge hint that \(y\) should look like an exponential function. So we'll guess that \(y = e^{rx}\) for some real number \(r\), and see if we can't pick \(r\) in just the right way to get a solution to the ODE. If we plug \(e^{rx}\) into the ODE, we get%
%
\begin{align*}
y''- y' - 6y \amp = r^{2}e^{rx} - re^{rx} - 6e^{rx} \\
\amp = e^{rx}(r^{2} - r - 6). 
\end{align*}
\hypertarget{p-181}{}%
So we need to set \(e^{rx}(r^{2} - r - 6)\) equal to \(0\) and solve for \(r\), which gives%
\begin{equation*}
r = -2, 3.
\end{equation*}
Therefore two solutions of \(y'' - y' - 6y = 0\) are given by%
\begin{equation*}
y_{1} = e^{-2x}
\end{equation*}
and \(y_{2} = e^{3x}\). Since \(W(y_{1},y_{2})\neq0\), this means that \(c_{1}e^{-2x} + c_{2}e^{3x}\) is actually the general solution of the ODE.%
\end{example}
\hypertarget{p-182}{}%
The process in \hyperref[example-solving-a-homogeneous-ode]{Example~\ref{example-solving-a-homogeneous-ode}} will work for \emph{every} second-order homogeneous ODE with constant coefficients. So solving such an ODE is even easier than integrating: all we need to do is to find the roots of a particular polynomial.%
\begin{definition}{The Characteristic Polynomial.}{definition-the-characteristic-polynomial}%
\index{second-order ODEs!characteristic equation}\hypertarget{p-183}{}%
Let \(a,b\) and \(c\) be constants. Given the ODE \(ay'' + by' + cy = 0\), the \terminology{characteristic equation} of this ODE is the polynomial%
\begin{equation*}
ar^{2} + br + c = 0.
\end{equation*}
%
\end{definition}
\hypertarget{p-184}{}%
We can now state the following result for finding solutions of homogeneous ODEs with constant coefficients.%
\begin{theorem}{Characteristic Equations with Distinct Roots.}{}{theorem-characteristic-equations-with-distinct-roots}%
\hypertarget{p-185}{}%
Let \(a,b\) and \(c\) be constants. Suppose that the characteristic equation of \(ay'' + by' + cy = 0\) has distinct roots \(r_{1}\) and \(r_{2}\). Then the general solution of the ODE is given by%
\begin{equation*}
c_{1}e^{r_{1}x} + c_{2}e^{r_{2}x}.
\end{equation*}
%
\end{theorem}
\begin{example}{Spring-mass system revisited.}{example-spring-mass-system-revisited}%
\hypertarget{p-186}{}%
An object of mass \SI{4}{\kilo\gram} is attached to a horizontal, frictionless spring. Suppose the spring constant is given by \(k=16\). The mass is held \SI{3}{\meter} to the right of the spring's equilibrium position, and is then released at time \(t=0\) where \(t\) is in seconds. Find the displacement \(x(t)\) of the mass.%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-28}{}\quad%
\hypertarget{p-187}{}%
We know from \hyperref[example-a-second-order-model]{Example~\ref{example-a-second-order-model}} that the second-order ODE given by%
\begin{equation*}
4x'' + kx = 0\quad\text{or}\quad x'' + 4x = 0
\end{equation*}
provides a model for \(x(t)\), but now we are in a position to solve it. The characteristic equation of this ODE is \(r^{2} + 4 = 0\), which has roots \(r=\pm2i\). The imaginary roots \emph{are not a problem}, and in fact provide significant information about the motion of the mass, as we'll soon see. The general solution of the ODE is%
\begin{equation*}
x = c_{1}e^{-2it} + c_{2}e^{2it}.
\end{equation*}
%
\par
\hypertarget{p-188}{}%
The initial conditions are \(x(0) = 3\) and \(x'(0) = 0\), which give the equations%
\begin{align*}
3 \amp = c_{1} + c_{2} \\
0 \amp = -2ic_{1} + 2ic_{2} 
\end{align*}
The second equation implies that \(c_{1} = c_{2}\), and applying this to the first equation now gives \(c_{1} = c_{2} = \frac{3}{2}\). Hence the displacement of the mass is given by%
\begin{equation*}
x = \frac{3}{2}e^{-2it} + \frac{3}{2}e^{2it}.
\end{equation*}
%
\end{example}
\hypertarget{p-189}{}%
The appearance of the "imaginary" solution in \hyperref[example-spring-mass-system-revisited]{Example~\ref{example-spring-mass-system-revisited}} may seem strange, but they're actually quite natural. In fact, we can use \terminology{Euler's formula} to write the solution in terms of a more familiar function.%
\begin{theorem}{Euler's Formula.}{}{theorem-euler-s-formula}%
\index{Euler's Formula}\hypertarget{p-190}{}%
For all \(x\), the following equations hold:%
\begin{align*}
e^{ix} \amp = \cos x + i\sin x \\
\cos x \amp = \frac{e^{ix}+e^{-ix}}{2} \\
\sin x \amp = \frac{e^{ix} - e^{-ix}}{2i} 
\end{align*}
%
\end{theorem}
\hypertarget{p-191}{}%
So using Euler's Formula on the solution from \hyperref[example-spring-mass-system-revisited]{Example~\ref{example-spring-mass-system-revisited}} gives%
\begin{align*}
x \amp = \frac{3}{2}e^{-2it} + \frac{3}{2} e^{2it} \\
\amp = 3\frac{e^{-2it} + e^{2it}}{2} \\
\amp = 3\cos2t. 
\end{align*}
So the imaginary roots \(\pm2i\) from \hyperref[example-spring-mass-system-revisited]{Example~\ref{example-spring-mass-system-revisited}} actually relate to the \emph{frequency} of the spring-mass system in that problem. This is a trend we will see often in this course: imaginary numbers corresponding to oscillating quantities.%
\par
\hypertarget{p-192}{}%
Now we'll take a look at how to solve second-order homogeneous ODEs whose characteristic equations have repeated roots.%
\begin{example}{Repeated roots in the characteristic equation.}{example-repeated-roots-in-the-characteristic-equation}%
\hypertarget{p-193}{}%
Find the general solution of \(y'' + 2y' + y = 0\) where \(y = y(x)\).%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-29}{}\quad%
\hypertarget{p-194}{}%
We begin by solving the characteristic equation, which for this ODE is%
\begin{equation*}
r^{2} + 2r + 1 = 0.
\end{equation*}
The only solution of this equation is \(r=-1\), which is a repeated root. We can still get one solution of the ODE using this root, namely \(y_{1} = e^{-x}\), but we need two linearly independent solutions in order to find the general solution.%
\par
\hypertarget{p-195}{}%
To get the other solution, we'll make another guess: whatever it happens to be, it should look quite a bit like the first solution \(e^{-x}\), since it still needs to cancel out with its derivatives the same way that \(e^{-x}\) does. The easiest way to get a function that looks like \(e^{-x}\) but is still linearly independent from \(e^{-x}\) is to just multiply by \(x\). In other words, we'll guess (and check!) that \(y_{2} = xe^{-x}\) is another solution of \(y''+2y'+y = 0\). If we plug \(y_{2}\) into the ODE, we get%
\begin{align*}
y''_{2} + 2y'_{2} + y_{2} \amp = \underbrace{-2e^{-x} + xe^{-x}}_{y''_{2}} + \underbrace{2e^{-x} - 2xe^{-x}}_{y'_{2}} + \underbrace{xe^{-x}}_{y_{2}} \\
\amp = 0, 
\end{align*}
which shows that \(y_{2}\) is indeed a solution of the ODE. Since it's also linearly independent (which we can check via the Wronskian), this means that the general solution of \(y''+2y'+y=0\) is%
\begin{equation*}
y = c_{1}y_{1} + c_{2}y_{2} = c_{1}e^{-x} + c_{2}xe^{-x}. 
\end{equation*}
%
\end{example}
\hypertarget{p-196}{}%
The method used in \hyperref[example-repeated-roots-in-the-characteristic-equation]{Example~\ref{example-repeated-roots-in-the-characteristic-equation}} also works for other homogeneous ODEs with constant coefficients whose characteristic equations have repeated roots. Hence the roots of the characteristic equation \emph{completely} determine the general solutions of such ODEs. We summarize this in the following table.%
\begin{figure}
\centering
\leavevmode%
\begin{table}
\centering
\begin{tabular}{ll}\hrulethick
Roots&General solution\tabularnewline\hrulethick
\(r_{1}\neq r_{2}\)&\(c_{1}e^{r_{1}x} + c_{2}e^{r_{2}x}\)\tabularnewline\hrulethick
\(r_{1} = r_{2}\)&\(c_{1}e^{r_{1}x} + c_{2}xe^{r_{1}x}\)\tabularnewline\hrulethick
\end{tabular}
\end{table}
\end{figure}
\hypertarget{p-197}{}%
Remember that it's not a problem if the characteristic equation has imaginary roots, and in fact we must account for these in order to completely describe the corresponding physical system. If we have imaginary roots, then we can simply use Euler's Formula to rewrite the solutions in terms of sine and cosine.%
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 2.3 Spring-Mass Models}
\typeout{************************************************}
%
\begin{sectionptx}{Spring-Mass Models}{}{Spring-Mass Models}{}{}\label{section-spring-mass-models}
\begin{introduction}{}%
\hypertarget{p-198}{}%
In this section we examine a common application of second-order ODEs: modeling movement in a spring-mass system. We will look at two different types of motion: undamped and damped. Note that this section corresponds to Section 2.4 of the text.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 2.3.1 Free Undamped Motion}
\typeout{************************************************}
%
\begin{subsectionptx}{Free Undamped Motion}{}{Free Undamped Motion}{}{}\label{subsection-free-undamped-motion}
\hypertarget{p-199}{}%
Suppose we have a mass \(m\) attached to a spring as in the following diagram:%
\begin{figure}
\centering
{
\begin{tikzpicture}
% Stolen shamelessly from stackexchange.

% This determines how the spring will look.
\tikzstyle{spring}=[decorate,decoration={coil,pre length=0.3cm,post
length=0.3cm,segment length=3,amplitude=1.5mm}]

\tikzstyle{ground}=[fill,pattern=north east lines,draw=none,minimum
width=0.75cm,minimum height=0.3cm]

% This draws the block.
\node[draw,outer sep=0pt,thick] (M1) [minimum width=1cm, minimum height=1cm] {$m$};

% This draws the spring.
\draw[spring] ($(M1.west) - (4,0)$) -- ($(M1.west)$) node [midway,yshift=.5cm] {$F_{S} = -kx$};

% This draws the walls and floor.
\draw[thick] ($(M1.south west) - (4,0)$) -- ($(M1.north west) + (-4,.5)$);
\draw[thick] ($(M1.south west) - (4,0)$) -- ($(M1.south west) + (4,0)$);

\draw[thick] ($(M1.south east)$) -- ($(M1.south east) + (4,0)$);
\draw[thick] ($(M1.south east) + (4,0)$) -- ($(M1.north east) + (4,.5)$);

% This draws the equilibrium position.
\draw[dashed] ($(M1.south west)-(2,.5)$) -- ($(M1.south west) - (2,-.5)$) node [below, yshift=-1cm,align=left] {\footnotesize Equilibrium\\ \footnotesize position}; 

% This illustrates displacement.
\draw [decorate,decoration={brace,amplitude=5pt,mirror},yshift=-2pt]
($(M1.south west)-(2,0)$) -- ($(M1.south west)$) node [black,midway,yshift=-10pt] {$x$};
\end{tikzpicture}
}
\caption{A spring-mass system.\label{figure-spring-mass-system}}
\end{figure}
\hypertarget{p-200}{}%
If we let \(x(t)\) denote the displacement of the mass from the spring's equilibrium position and let \(F_{S} = -kx\) denote the force of the spring on the mass (see \hyperref[theorem-hooke-s-law]{Theorem~\ref{theorem-hooke-s-law}}, and assume that no other force is acting on the mass, then we know from \hyperref[example-a-second-order-model]{Example~\ref{example-a-second-order-model}} that \(x(t)\) satisfies the second-order ODE given by%
\begin{equation*}
mx'' + kx = 0.
\end{equation*}
If we set \(\omega_{0} = \sqrt{\frac{k}{m}}\), we can rewrite this to get%
\begin{equation*}
x'' + \omega_{0}^{2}x = 0.
\end{equation*}
%
\par
\hypertarget{p-201}{}%
One thing we can notice right away about solutions of \(x''+\omega_{0}^{2}x = 0\) is that they should all be periodic (see \hyperref[definition-periodic-functions]{Definition~\ref{definition-periodic-functions}}), which, of course, makes sense!. To see why, note that the roots of the characteristic equation are \(\pm i\omega_{0}\), which means that the solutions may be written in the form%
\begin{equation*}
x = c_{1}e^{-i\omega_{0}t} + c_{2}e^{i\omega_{0}t},
\end{equation*}
which we can rewrite as%
\begin{equation*}
x = A\cos\omega_{0}t + B\sin\omega_{0}t
\end{equation*}
using Euler's Formula. Hence every solution of \(x''+\omega_{0}^{2}x = 0\) is a sinusoidal wave.%
\par
\hypertarget{p-202}{}%
We can go even further by making use of some clever algebra and the appropriate trigonometric formulas if we assume that \(x\neq0\) (i.e. \(A\) and \(B\) are not \emph{both} \(0\)):%
\begin{align*}
x \amp = A\cos\omega_{0}t + B\sin\omega_{0}t \\
\amp = \sqrt{A^{2}+B^{2}}\left(\frac{A}{\sqrt{A^{2}+B^{2}}}\cos\omega_{0}t + \frac{B}{\sqrt{A^{2} + B^{2}}}\sin\omega_{0}t\right) 
\end{align*}
Now set \(C = \sqrt{A^{2} + B^{2}}\) and define \(\varphi\) implicitly by \(\cos\varphi = \frac{A}{C}\) and \(\sin\varphi = \frac{B}{C}\). \begin{aside}{}{aside-3}%
\hypertarget{p-203}{}%
There are infinitely many choices for \(\varphi\) here, but we can select a unique one if we make the extra restriction that \(\varphi\in[0,2\pi)\).%
\end{aside}
 Then we get%
\begin{equation*}
x = \cos\varphi\cos\omega_{0}t + \sin\varphi\sin\omega_{0}t = \cos(\omega_{0}t - \varphi).
\end{equation*}
\(C\) is the \terminology{amplitude} of the wave \(x\), \(\omega_{0}\) is the \terminology{circular frequency}, \(T = \frac{2\pi}{\omega_{0}}\) is the \terminology{period} of motion and \(\varphi\) is the \terminology{phase}.%
\begin{example}{Another spring-mass system.}{example-another-spring-mass-system}%
\hypertarget{p-204}{}%
An object with a mass of \SI{5}{\kilo\gram} is fixed to a spring and a force of \SI{10}{\newton} holds the mass \SI{5}{\meter} to the left of the spring's equilibrium position. If the object is released, how long will it take for the mass to return to its original position? And what is the position \(x(t)\) of the mass?%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-30}{}\quad%
\hypertarget{p-205}{}%
Let \(x(t)\) denote the position of the mass \(t\) seconds after being released, so that \(x(0) = -5\) and \(x'(0) = 0\). We could find the time it takes for the mass to return to its starting position by first finding \(x(t)\), but a quicker way is to just find the period \(T\) of \(x\). To do this, we must find the circular frequency \(\omega_{0} = \sqrt{\frac{k}{m}}\). Thankfully, half of the work is done for us (we know \(m=5\)), so we only need the value of \(k\) which itself comes from Hooke's Law.%
\par
\hypertarget{p-206}{}%
Call the spring force \(F_{S}\) and recall that \(F_{S} = -kx\). We know that it takes a force of \SI{10}{\newton} to hold the mass still at \(x=-5\). The spring force must \emph{precisely} counterbalance this force in order for the mass to remain still as it's held, which means that \(F_{S} = 10\) since \(F_{S}\) pulls the mass to the right. Therefore \(-k(-5) = 10\) and so \(k=2\), which gives \(\omega_{0} = \sqrt{\frac{2}{5}}\). This means that the period of motion is%
\begin{equation*}
T = \frac{2\pi}{\omega_{0}} = 2\pi\sqrt{\frac{5}{2}}.
\end{equation*}
%
\par
\hypertarget{p-207}{}%
To find \(x(t)\), we'll use the fact that it can be written as \(x = C\cos(\omega_{0}t-\varphi)\). Since \(C = 5\) (because the mass can never go more than five meters from the equilibrium position) and we already know that \(\omega_{0} = \sqrt{\frac{2}{5}}\), we just need to find \(\varphi\). We can just make use of the initial condition \(x(0) = -5\) to get this:%
\begin{equation*}
-5 = C\cos\varphi = 5\cos\varphi
\end{equation*}
and so we can choose \(\varphi=\pi\). Hence%
\begin{equation*}
x(t) = 5\cos(\sqrt{\frac{2}{5}}t-\pi).
\end{equation*}
%
\end{example}
\begin{aside}{}{aside-4}%
\hypertarget{p-208}{}%
You may be troubled by the fact that we only explicitly used the first initial condition in this example. However, the second condition \(x'(0) = 0\) was actually used implicitly: it allowed us to assume that the amplitude was \(5\) as opposed to another number. If \(x'(0)\neq0\), finding \(C\) would have been a little trickier.%
\end{aside}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.3.2 Free Damped Motion}
\typeout{************************************************}
%
\begin{subsectionptx}{Free Damped Motion}{}{Free Damped Motion}{}{}\label{subsection-free-damped-motion}
\hypertarget{p-209}{}%
Now we look at how the motion of a mass attached to a spring is altered if the motion is \emph{damped}, say, by a dashpot. See \hyperref[figure-damped-spring]{Figure~\ref{figure-damped-spring}}.%
\begin{figure}
\centering
{
\begin{tikzpicture}
% Stolen shamelessly from stackexchange.

% This determines how the spring will look.
\tikzstyle{spring}=[decorate,decoration={coil,pre length=0.3cm,post
length=0.3cm,segment length=3,amplitude=1.5mm}]

\tikzstyle{damper}=[decoration={markings,  
mark connection node=dmp,
mark=at position 0.5 with 
{
\node (dmp) [thick,inner sep=0pt,transform shape,rotate=-90,minimum
width=15pt,minimum height=3pt,draw=none] {};
\draw [thick] ($(dmp.north east)+(2pt,0)$) -- (dmp.south east) -- (dmp.south
west) -- ($(dmp.north west)+(2pt,0)$);
\draw [thick] ($(dmp.north)+(0,-5pt)$) -- ($(dmp.north)+(0,5pt)$);
}
}, decorate]

\tikzstyle{ground}=[fill,pattern=north east lines,draw=none,minimum
width=0.75cm,minimum height=0.3cm]

% This draws the block.
\node[draw,outer sep=0pt,thick] (M1) [minimum width=1cm, minimum height=1cm] {$m$};

% This draws the spring.
\draw[spring] ($(M1.west) - (4,0)$) -- ($(M1.west)$) node [midway,yshift=.5cm] {$F_{S}$};

% This draws the dashpot.
\draw[damper] ($(M1.east)$) -- ($(M1.east) + (4,0)$) node [midway,yshift=.5cm] {$F_{R}$};

% This draws the walls and floor.
\draw[thick] ($(M1.south west) - (4,0)$) -- ($(M1.north west) + (-4,.5)$);
\draw[thick] ($(M1.south west) - (4,0)$) -- ($(M1.south west) + (4,0)$);

\draw[thick] ($(M1.south east)$) -- ($(M1.south east) + (4,0)$);
\draw[thick] ($(M1.south east) + (4,0)$) -- ($(M1.north east) + (4,.5)$);

% This draws the equilibrium position.
\draw[dashed] ($(M1.south west)-(2,.5)$) -- ($(M1.south west) - (2,-.5)$) node [below, yshift=-1cm,align=left] {\footnotesize Equilibrium\\ \footnotesize position}; 

% This illustrates displacement.
\draw [decorate,decoration={brace,amplitude=5pt,mirror},yshift=-2pt]
($(M1.south west)-(2,0)$) -- ($(M1.south west)$) node [black,midway,yshift=-10pt] {$x$};

\end{tikzpicture}
}
\caption{A damped spring-mass system.\label{figure-damped-spring}}
\end{figure}
\hypertarget{p-210}{}%
Now in addition to the spring force \(F_{S}\), we must also worry about the force \(F_{R}\) of the dashpot on the mass. \(F_{R}\) is always going to act against the velocity of the mass, so for simplicity we assume that \(F_{R} = -cx'\) for some \(c > 0\). Using \(F_{S} = -kx\) as usual in conjunction with Newton's Second Law gives us the second-order ODE%
\begin{equation*}
-cx'-kx = mx''\quad\text{or}\quad mx'' + cx + kx = 0.
\end{equation*}
%
\par
\hypertarget{p-211}{}%
This ODE is homogeneous and has constant coefficients so we may solve it using the method of characteristic equations. The characteristic equation of this ODE is%
\begin{equation}
mr^{2} + cr + k = 0\label{equation-characteristic-free-damped}
\end{equation}
The roots of this equation are%
\begin{equation}
r_{1} = \frac{-c + \sqrt{c^{2} - 4km}}{2m}\quad\text{and}\quad r_{2} = \frac{-c - \sqrt{c^{2} - 4km}}{2m}.\label{equation-characteristic-free-damped-roots}
\end{equation}
The behavior of this system therefore depends on the quantity \(c^{2} - 4km\), and so we have three cases to consider.%
\leavevmode%
\begin{enumerate}[label=\arabic*:]
\item\hypertarget{li-17}{}\hypertarget{p-212}{}%
\(c^{2} - 4km \gt 0\).%
\par
\hypertarget{p-213}{}%
In this case, the characteristic equation \hyperref[equation-characteristic-free-damped]{(\ref{equation-characteristic-free-damped})} has two real roots, and so the solution \(x(t)\) has the form%
\begin{equation*}
x(t) = c_{1}e^{r_{1}t} + c_{2}e^{r_{2}t}.
\end{equation*}
Now, \(r_{1}\) and \(r_{2}\) are both negative since \(c^{2} - 4km \lt c^{2}\) (remember that we're assuming that \(k\) and \(m\) are positive!). This means that \(x(t)\to0\) as \(t\to\infty\). There is no oscillation present in the motion of the mass in this case since the mass never passes through \(x = 0\), so we call this \terminology{overdamped motion}.%
\item\hypertarget{li-18}{}\hypertarget{p-214}{}%
\(c^{2} - 4km = 0\).%
\par
\hypertarget{p-215}{}%
In this case, the characteristic equation \hyperref[equation-characteristic-free-damped]{(\ref{equation-characteristic-free-damped})} has a repeated (real) root, and so the solution \(x(t)\) takes the form%
\begin{equation*}
x(t) = e^{r_{1}t}(c_{1} + c_{2}t).
\end{equation*}
This mass can pass through \(x = 0\) only once, at \(t = -\frac{c_{1}}{c_{2}}\). Once it does, the mass will "turn around" soon afterwards and beginning moving back to \(0\), as in the first case. We call this type of motion \terminology{critically damped}, since it's right on the border between overdamped motion and oscillating motion.%
\item\hypertarget{li-19}{}\hypertarget{p-216}{}%
\(c^{2} - 4km \lt 0\).%
\par
\hypertarget{p-217}{}%
In this case the characteristic equation \hyperref[equation-characteristic-free-damped]{(\ref{equation-characteristic-free-damped})} has two distinct complex roots of the form \(r = a \pm bi\), where%
\begin{equation*}
a = -\frac{c}{2m}\quad\text{and}\quad b = \frac{\sqrt{4km - c^{2}}}{2m}.
\end{equation*}
In particular, the real part \(a\) of these roots is always negative. The solution \(x(t)\) in this case takes the form%
\begin{equation*}
x(t) = e^{at}(A\cos bt + B\sin bt)
\end{equation*}
after applying Euler's formula. As in the previous two cases, \(x(t)\to0\) as \(t\to\infty\). However, oscillation is now present in the system for all time! We call this motion \terminology{underdamped}, since the damping term \(e^{at}\) is not strong enough to cancel out the oscillation present in the system. Note that the real part \(a\) contributes to the "amplitude" \(e^{at}\) of the motion, while the imaginary part \(b\) represents the angular frequency of the motion. The ordinary frequency of the motion is given by \(\frac{b}{2\pi}\).%
\end{enumerate}
\begin{example}{A Spring-Dashpot System.}{example-a-spring-dashpot-system}%
\hypertarget{p-218}{}%
Suppose that an object of mass \(m = 25\) is attached to both a spring and a dashpot. The mass is held \(1\) meter to the left of the spring's equilibrium position \(x = 0\). The force of the spring on the mass is \(F_{S} = -226x\) and the force of the dashpot on the mass is \(F_{R} = -10x'\), where \(x\) is the displacement of the mass. At time \(t = 0\), the mass is released. Find \(x(t)\).%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-31}{}\quad%
\hypertarget{p-219}{}%
The ODE that models the motion of this mass is%
\begin{equation*}
25x'' + 10x' + 226x = 0,
\end{equation*}
and the roots of the corresponding characteristic equation are%
\begin{equation*}
r_{1} = -\frac{1}{5} \pm \frac{1}{5}\sqrt{-225} = -\frac{1}{5}\pm3i.
\end{equation*}
We can already see that the motion must be underdamped since we have complex roots, and the position \(x(t)\) itself is given by%
\begin{equation*}
x(t) = e^{-\frac{t}{5}}(A\cos3t + B\sin3t).
\end{equation*}
%
\par
\hypertarget{p-220}{}%
Now we can use the initial conditions \(x(0) = -1\) and \(x'(0) = 0\) to find \(A\) and \(B\). Doing so, we quickly get \(A = -1\) and \(B = -\frac{1}{15}\). Hence%
\begin{equation*}
x(t) = -e^{-\frac{t}{5}}\left(\cos3t + \frac{1}{15}\sin3t\right).
\end{equation*}
%
\end{example}
\hypertarget{p-221}{}%
As mentioned previously, the exponential term in \(x(t)\) from \hyperref[example-a-spring-dashpot-system]{Example~\ref{example-a-spring-dashpot-system}} serves to dampen the motion of the spring. This is illustrated in \hyperref[figure-damped-motion]{Figure~\ref{figure-damped-motion}}.%
\begin{figure}
\centering
{
\begin{tikzpicture}[scale=0.8]
\begin{axis}[
enlargelimits=false,
legend cell align=left,
axis x line = middle,
xlabel = $t$,
axis y line = center,
ylabel = $x$,
grid=both
]
\addplot[domain=0:6*pi,samples=400,smooth,blue]{-exp(-.2*x)*cos(deg(3*x))-(1/15)*exp(-.2*x)*sin(deg(3*x))}; 
\addlegendentry{$x(t)$}

\addplot[domain=0:6*pi,samples=200,black,dashed]{-exp(-.2*x)};
\addlegendentry{$e^{-\frac{t}{5}}$}
\addplot[domain=0:6*pi,samples=200,black,dashed]{exp(-.2*x)}; 
\end{axis}
\end{tikzpicture}
}
\caption{An exponential term damping motion.\label{figure-damped-motion}}
\end{figure}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 2.4 Solutions of Non-homogeneous Equations}
\typeout{************************************************}
%
\begin{sectionptx}{Solutions of Non-homogeneous Equations}{}{Solutions of Non-homogeneous Equations}{}{}\label{section-solutions-of-nonhomogeneous-equations}
\begin{introduction}{}%
\hypertarget{p-222}{}%
In this section we'll deal with non-homogeneous equations and finding their solutions. This will help us to model systems involving an external force.%
\begin{aside}{}{aside-5}%
\hypertarget{p-223}{}%
This section corresponds to Section 2.7 of the text.%
\end{aside}
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 2.4.1 The Method of Undetermined Coefficients}
\typeout{************************************************}
%
\begin{subsectionptx}{The Method of Undetermined Coefficients}{}{The Method of Undetermined Coefficients}{}{}\label{subsection-the-method-of-undetermined-coefficients}
\hypertarget{p-224}{}%
Consider the non-homogeneous linear ODE with constant coefficients given by%
\begin{equation}
ay'' + by' + cy = f(x).\label{equation-non-homogeneous}
\end{equation}
If \(f(x)\) were zero then we could solve this by finding the roots of the characteristic equations and using them to determine the appropriate form of the solution. Although that's no longer enough if \(f(x)\neq0\), our method for solving homogeneous equations still plays an important role.%
\begin{theorem}{Solution of Non-homogeneous Equations.}{}{theorem-solution-of-non-homogeneous-equations}%
\hypertarget{p-225}{}%
Consider the ODE given in \hyperref[equation-non-homogeneous]{(\ref{equation-non-homogeneous})}. Let \(y_{c}\) (the \terminology{complementary solution}) denote the solution of the \terminology{associated homogeneous equation}%
\begin{equation*}
ay'' + by' + cy = 0
\end{equation*}
and let \(y_{p}\) (the \terminology{particular solution}) denote a single solution of \hyperref[equation-non-homogeneous]{(\ref{equation-non-homogeneous})}. Then the general solution of \hyperref[equation-non-homogeneous]{(\ref{equation-non-homogeneous})} is given by \(y = y_{c} + y_{p}\).%
\end{theorem}
\hypertarget{p-226}{}%
\hyperref[theorem-solution-of-non-homogeneous-equations]{Theorem~\ref{theorem-solution-of-non-homogeneous-equations}} shows that to solve \hyperref[equation-non-homogeneous]{(\ref{equation-non-homogeneous})}, we only need to solve the associated homogeneous equation (which we're quite used to by now!) and find a \emph{single} solution of \hyperref[equation-non-homogeneous]{(\ref{equation-non-homogeneous})}. The method we will use is the \terminology{method of undetermined coefficients}, which we'll demonstrate by example.%
\begin{example}{Using the Method of Undetermined Coefficients.}{example-using-the-method-of-undetermined-coefficients}%
\hypertarget{p-227}{}%
Find the general solution of the ODE given by%
\begin{equation*}
y'' - y' - 2y = 3x + 4.
\end{equation*}
%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-32}{}\quad%
\hypertarget{p-228}{}%
To find the general solution we need to do two things: find the complementary solution \(y_{c}\) of the associated homogeneous equation and find a single particular solution \(y_{p}\) of the given ODE. We already know how to find \(y_{c},\)\begin{aside}{}{aside-6}%
\hypertarget{p-229}{}%
The characteristic equation of the ODE is \((r + 1)(r - 2)\).%
\end{aside}
 which is just%
\begin{equation*}
y_{c} = c_{1}e^{x} + c_{2}e^{-2x}.
\end{equation*}
Once we can find a single particular solution \(y_{p}\) we'll be finished.%
\par
\hypertarget{p-230}{}%
If we stare that the ODE, then we see that \(y\) and its derivatives must cancel each other and leave a polynomial. So it's reasonable to guess that a polynomial might be a solution of the ODE, or equivalently, \(y_{p}\) \emph{should be a polynomial}. Since the degree\begin{aside}{}{aside-7}%
\hypertarget{p-231}{}%
Recall that the degree of a polynomial is just the highest power of the variable in the polynomial.%
\end{aside}
 of the right hand side is \(1\), then \(y_{p}\) should probably be degree \(1\) as well. This means that \(y_{p} = A_{1}x + A_{2}\) for some constants \(A_{1},A_{2}\).%
\par
\hypertarget{p-232}{}%
To find these constants (\terminology{undetermined coefficients}), we plug our guess into the ODE to get%
\begin{equation*}
0 - A_{1} - 2A_{1}x - 2A_{2} = 3x + 4.
\end{equation*}
The only way for this equation to be true is for%
\begin{align*}
-A_{1} - 2A_{2} \amp = 4 \\
-2A_{1} \amp = 3
\end{align*}
So \(A_{1} = -\frac{3}{2}, A_{2} = \frac{5}{4}\) and \(y_{p} = -\frac{3}{2}x + \frac{5}{4}\). Hence the general solution of the ODE is%
\begin{equation*}
y = y_{c} + y_{p} = c_{1}e^{x} + c_{2}e^{-2x} - \frac{3}{2}x + \frac{5}{4}.
\end{equation*}
%
\end{example}
\hypertarget{p-233}{}%
Note that in \hyperref[example-using-the-method-of-undetermined-coefficients]{Example~\ref{example-using-the-method-of-undetermined-coefficients}}, we didn't need any initial conditions to find \(y_{p}\). This means that if a non-homogeneous ODE like the one in \hyperref[example-using-the-method-of-undetermined-coefficients]{Example~\ref{example-using-the-method-of-undetermined-coefficients}} represents some physical system, then the initial configuration of that system \emph{has no effect on \(y_{p}\)}. We will see soon that particular solutions correspond to external forces on a system, like gravity, whereas complementary solutions correspond to internal forces in a system, such as the spring force.%
\begin{example}{}{example-36}%
\hypertarget{p-234}{}%
Find the general solution of%
\begin{equation*}
y'' - 2y' + y = x - \sin(2x).
\end{equation*}
%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-33}{}\quad%
\hypertarget{p-235}{}%
The general solution will take the form \(y = y_{c} + y_{p}\). Once again, we find \(y_{c}\) by solving the characteristic equation to get%
\begin{equation*}
y_{c} = c_{1}x + c_{2}xe^{x}.
\end{equation*}
%
\par
\hypertarget{p-236}{}%
Now we can make a guess as to what \(y_{p}\) should be, once again based on the right hand side of the ODE. If we want to differentiate \(y_{p}\) and obtain \(x - \sin(2x)\), then \(y_{p}\) should include both an \(x\) term and a \(\sin(2x)\) term. If we make the guess that \(y_{p} = A_{1}x + A_{2}\sin(2x)\), then we get%
\begin{align*}
A_{1}x - 2A_{1} \amp = x \\
-4A_{2}\cos(2x) - 3A_{2}\sin(2x) \amp = -\sin(2x) 
\end{align*}
This forces \(A_{1} = 1\) \emph{and} \(A_{1} = 0\), as well as \(A_{2} = \frac{1}{3}\) \emph{and} \(A_{2} = 0\). Obviously, this is a problem!%
\par
\hypertarget{p-237}{}%
What happened here is we didn't give our guess for \(y_{p}\) enough flexibility. We know we want \(y_{p}\) to involve \(x\) and \(\sin(2x)\), but as soon as we plug this into the ODE and start differentiating constant terms and cosine terms will begin to appear, and \emph{we need to account for these as well}. So we'll update our guess for \(y_{p}\), and assume%
\begin{equation*}
y_{p} = A_{1}x + A_{2} + A_{3}\cos(2x) + A_{4}\sin(2x).
\end{equation*}
Plugging this into the ODE and collecting like terms gives%
\begin{align*}
A_{1} \amp = 1\\
-2A_{1} + A_{2} \amp = 0\\
-3A_{3} - 4A_{4} \amp = 0\\
4A_{3} - 3A_{4} \amp = -1
\end{align*}
Hence%
\begin{align*}
A_{1} \amp = 1 \\
A_{2} \amp = 2 \\
C \amp = -\frac{4}{25} \\
D \amp = \frac{3}{25} 
\end{align*}
and the solution of our ODE is%
\begin{equation*}
c_{1}e^{x} + c_{2}xe^{x} + x + 2 - \frac{4}{25}\cos(2x) + \frac{3}{25}\sin(2x).
\end{equation*}
%
\end{example}
\begin{example}{Method of Undetermined Coefficients with Overlap.}{example-method-of-undetermined-coefficients-with-overlap}%
\hypertarget{p-238}{}%
Find the solution \(y(x)\)m> of the IVP%
\begin{equation*}
y''+9y = 3\cos(3x),\quad y(0) = 1,y'(0) = -1
\end{equation*}
%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-34}{}\quad%
\hypertarget{p-239}{}%
We can start this example the same way we've done the previous ones. First, we find \(y_{c}\) by solving \(y''+9y=0\). So%
\begin{equation*}
y_{c} = c_{1}\cos(3x)+c_{2}\sin(3x).
\end{equation*}
Now we find \(y_{p}\). Since the RHS of the ODE is \(3\cos(3x)\), we'll guess that \(y_{p} = A\cos(3x)+B\sin(3x)\). However, this will cause us problems! Since \(\cos(3x),\sin(3x)\) are both solutions of the corresponding homogeneous ODE, then plugging \(y_{p}\) into \(y''+9y\) will just give \(0\) again, instead of \(3\cos(3x)\).%
\par
\hypertarget{p-240}{}%
The problem here is that our guess for \(y_{p}\) overlaps with \(y_{c}\). To fix this, we'll multiply our guess for \(y_{p}\) by the \emph{smallest} power of \(x\) that removes the overlap. In this case, we'll just multiply by \(x\) to get%
\begin{equation*}
y_{p} = x[A\cos(3x)+B\sin(3x)]
\end{equation*}
Now, we'll plug our modified guess into the ODE and set it equal to \(3\cos(3x)\):%
\begin{align*}
3\cos(3x)\amp = y_{p}'' + 9y\\
\amp = -6A\sin(3x)+6B\cos(3x)
\end{align*}
So we need \(-6A = 0\) and \(6B = 3\), or just \(A = 0,B = \frac{1}{2}\). Hence%
\begin{equation*}
y_{p} = x\left[\frac{1}{2}\sin(3x)\right],
\end{equation*}
and the general solution is then%
\begin{equation*}
y = y_{c}+y_{p} = c_{1}\cos(3x)+c_{2}\sin(3x) + \frac{x}{2}\sin(3x).
\end{equation*}
%
\par
\hypertarget{p-241}{}%
To find the solution of the IVP, we just plug in the initial conditions. Since \(y(0) = 1\), this gives%
\begin{equation*}
1 = c_{1}.
\end{equation*}
And since%
\begin{equation*}
y' = -3c_{1}\sin(3x)+3c_{2}\cos(3x) + \frac{1}{2}\sin(3x)+\frac{3}{2}x\cos(3x),
\end{equation*}
\(y'(0)=-1\) gives%
\begin{equation*}
-1 = 3c_{2}\Rightarrow c_{2} = -\frac{1}{3}.
\end{equation*}
So%
\begin{equation*}
y = \cos(3x)-\frac{1}{3}\sin(3x)+\frac{x}{2}\sin(3x).
\end{equation*}
%
\end{example}
\hypertarget{p-242}{}%
What we did in \hyperref[example-method-of-undetermined-coefficients-with-overlap]{Example~\ref{example-method-of-undetermined-coefficients-with-overlap}} will work in general: if \(y_{c}\) and the initial guess for \(y_{p}\) overlap, i.e. contain linearly dependent terms, then we multiply \(y_{p}\) by the \emph{smallest} power of \(x\) (or the appropriate independent variable) that removes the overlap.%
\begin{example}{Determining the Appropriate Form of the Particular Solution.}{example-determining-the-appropriate-form-of-the-particular-solution}%
\hypertarget{p-243}{}%
Consider the ODE \(x'' + 4x' + 4 = 3t^{3} - t + t^{2}\sin(2t) + 3e^{-2t}.\) Find the correct guess for \(x_{p}\).%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-35}{}\quad%
\hypertarget{p-244}{}%
Before we can do anything with \(x_{p}\), we need to find the complementary solution \(x_{c}\). This is given by \(x_{c} = c_{1}e^{-2t} + c_{2}te^{-2t}.\) Now we can try to guess an appropriate form for \(x_{p}\) using the right hand side of the ODE. Each "component" of the right hand side contributes to our guess for \(x_{p}\) as follows: \begin{table}
\centering
\begin{tabular}{ll}\hrulethick
component&contribution to \(x_{p}\)\tabularnewline\hrulethick
\(3t^{3} - t\)&\(At^{3} + Bt^{2} + Ct + D\)\tabularnewline\hrulethick
\(t^{2}\sin(2t)\)&\((Et^{2} + Ft + G)\cos(2t) + (Ht^{2} + It + J)\sin(2t)\)\tabularnewline\hrulethick
\(3e^{-2t}\)&\(Ke^{-2t}\)\tabularnewline\hrulethick
\end{tabular}
\end{table}
 But now we have a problem, since \(Ke^{-2t}\) overlaps with \(x_{c}\). So we multiply by \(t^{2}\) to remove the overlap, and hence \(x_{p} = At^{3} + Bt^{2} + Ct + D + (Et^{2} + Ft + G)\cos(2t) + (Ht^{2} + It + J)\sin(2t) + 3e^{-2t} + Kt^{2}e^{-2t}.\)%
\end{example}
\end{subsectionptx}
\begin{conclusion}{}%
\hypertarget{p-245}{}%
SUGGESTED PROBLEMS: 1, 3, 5, 11%
\end{conclusion}%
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 2.5 Forced Oscillations and Resonance}
\typeout{************************************************}
%
\begin{sectionptx}{Forced Oscillations and Resonance}{}{Forced Oscillations and Resonance}{}{}\label{section-forced-oscillations-and-resonance}
\begin{introduction}{}%
\hypertarget{p-246}{}%
In this section we will develop models for certain systems under the influence of a periodic, external force. The presence of an external force leads to non-homogeneous models, and we will use the techniques we developed in \hyperref[section-solutions-of-nonhomogeneous-equations]{Section~\ref{section-solutions-of-nonhomogeneous-equations}} to deal with these systems.%
\end{introduction}%
\begin{aside}{}{aside-8}%
\hypertarget{p-247}{}%
This section corresponds to Section 2.8 of the text.%
\end{aside}
%
%
\typeout{************************************************}
\typeout{Subsection 2.5.1 Undamped Systems}
\typeout{************************************************}
%
\begin{subsectionptx}{Undamped Systems}{}{Undamped Systems}{}{}\label{subsection-undamped-systems}
\hypertarget{p-248}{}%
Consider the spring-mass system set up as in \hyperref[figure-spring-mass-system]{Figure~\ref{figure-spring-mass-system}}. Then we know that the displacement \(x(t)\) satisfies \(x'' + \omega_{0}^{2}x = 0\), where \(\omega_{0} = \sqrt{\frac{k}{m}}\).%
\par
\hypertarget{p-249}{}%
Now suppose that an external force \(F_{E} = F_{0}\cos(\omega t)\) also acts on the mass. Then the ODE that models the displacement \(x(t)\) is%
\begin{equation*}
x'' + \omega_{0}^{2}x = \frac{F_{0}}{m}\cos(\omega t).
\end{equation*}
The solution of this ODE is then \(x = x_{c} + x_{p}\), where%
\begin{align*}
x_{c} \amp= A\cos(\omega-{0}t) + B\sin(\omega_{0}t)\\
x_{p} \amp= \begin{cases} \frac{F_{0}}{m(\omega_{0}^{2} - \omega^{2})} \cos(\omega t) \amp\text{if }\omega\neq\omega_{0} \\ \frac{F_{0}}{2m\omega_{0}} t\sin(\omega_{0} t) \amp\text{if }\omega=\omega_{0} \end{cases}
\end{align*}
Systems where the \terminology{external frequency} \(\omega\) is equal to the \terminology{internal frequency} \(\omega_{0}\) are said to be in \terminology{resonance}. Without a damping force, the mass in such systems will move wildly out of control \(|x_{p}(t)|\) gets arbitrarily large as \(t\to\infty\).%
\begin{example}{Determining Resonance.}{example-determining-resonance}%
\hypertarget{p-250}{}%
An object with mass \SI{2}{\kilo\gram} is attached to a spring and is held \SI{1}{\meter} to the right of the spring's equilibrium position by a force of \SI{8}{\newton} At time \(t = 0\) seconds the mass is set in motion with an initial velocity of \SI{2}{\meter\per\second} to the left. Suppose an external force \(F_{E} = 3\cos(2t)\) acts on the mass as well. Will the spring eventually break?%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-36}{}\quad%
\hypertarget{p-251}{}%
We can answer this question by determining if resonance is present in this system. The external frequency is \(\omega = 2\), and the internal frequency is \(\omega_{0} = \sqrt{\frac{k}{m}}\). Since \(k = 8\) and \(m = 2\), we have \(\omega_{0} = \sqrt{\frac{8}{2}} = 2\), and so the frequencies match. Hence the system is in resonance, and we can expect the spring to eventually break.%
\end{example}
\begin{aside}{}{aside-9}%
\hypertarget{p-252}{}%
It's not too hard to solve for \(x(t)\) exactly here to get%
\begin{equation*}
x(t) = \frac{1}{4}\cos(2t) - \sin(2t) + \frac{3}{8}t\sin(2t).
\end{equation*}
Graphing this, we get%
\begin{figure}
\centering
{
\begin{tikzpicture}
\begin{axis}[mystyle,
enlargelimits=false,
legend cell align=left,
axis x line = middle,
xlabel = $t$,
axis y line = center,
ylabel = $x$,
grid=both
]
\addplot[domain=0:30,samples=200,thick,smooth,blue]{cos(2*deg(x))-sin(2*deg(x))+.375*x*sin(2*deg(x))};
\addlegendentry{$x(t)$} 
\end{axis}
\end{tikzpicture}
}
\caption{A plot of the motion of the mass in \hyperref[example-determining-resonance]{Example~\ref{example-determining-resonance}}.\label{figure-14}}
\end{figure}
\end{aside}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 2.5.2 Damped Systems}
\typeout{************************************************}
%
\begin{subsectionptx}{Damped Systems}{}{Damped Systems}{}{}\label{subsection-damped-systems}
\hypertarget{p-253}{}%
Now we'll take a look at forced, damped systems. Suppose a mass \(m\) is fixed to a spring with spring force \(F_{S} = -kx\), and is acted upon by a dashpot with force \(F_{R} = -cx'\), where \(c,k \gt 0\) and \(x\) represents the displacement of the mass at time \(t\). If the mass is still acted upon by an external force \(F_{E} = F_{0}\cos(\omega t)\), then by Newton's Second Law the displacement \(x\) must satisfy%
\begin{equation*}
mx'' + cx' + kx = F_{0}\cos(\omega t).
\end{equation*}
The solution is given by \(x = x_{c} + x_{p}\), where \(x_{c}\) is found as in \hyperref[subsection-free-damped-motion]{Subsection~\ref{subsection-free-damped-motion}} and goes to \(0\) as \(t\to\infty\). With a little help from a computer algebra system such as Sage (see below), we see that%
\begin{equation*}
x_{p} = \frac{m(\omega_{0}^{2} - \omega^{2})F_{0}}{m^{2}(\omega_{0}^{2} - \omega^{2})^{2} + \omega^{2}c^{2}}\cos(\omega t) + \frac{\omega c F_{0}}{m^{2}(\omega_{0}^{2} - \omega^{2})^{2} + \omega^{2}c^{2}}\sin(\omega t),
\end{equation*}
where \(\omega_{0} = \sqrt{\frac{k}{m}}\) as usual.%
\par
\hypertarget{p-254}{}%
Since \(x_{c}\) will always approach \(0\) in these situations, as time goes on the position is determined increasingly by \(x_{p}\). We call \(x_{c}\) the \terminology{transient solution} and \(x_{p}\) the \terminology{steady-state solution}. Note that resonance is impossible in this system since \(x_{c}\) and \(x_{p}\) can never overlap (assuming the external force is still a sinusoid). Therefore the smallest amount of damping prevents the mass from going out of control.%
\begin{sageinput}
# Set variables
t = var('t')
m, c, k, F0, omega, omega_0 = var('m c k F0 omega omega_0')

# Make assumption to help Sage/Maxima with computation; this corresponds to underdamped motion
assume(4*k*m - c^2 > 0)

# Define x as a function of t
x = function('x')(t)

# Set up and solve the ODE
P = desolve(m*diff(x, t, 2) + c*diff(x,t) + k*x == F0*cos(omega*t), x, ivar=t)

# Make "nice" output for solution
pretty_print(P.substitute(k == m*(omega_0)^2))
\end{sageinput}
\begin{sageoutput}
# Sage output without pretty printing.
(_K2*cos(1/2*sqrt(4*omega_0^2 - c^2/m^2)*t) + _K1*sin(1/2*sqrt(4*omega_0^2 - c^2/m^2)*t))*e^(-1/2*c*t/m) + (F0*c*omega*sin(omega*t) - (F0*m*omega^2 - F0*m*omega_0^2)*cos(omega*t))/(m^2*omega^4 + m^2*omega_0^4 - (2*m^2*omega_0^2 - c^2)*omega^2)
\end{sageoutput}
\begin{example}{Steady-State Approximation.}{example-steady-state-approximation}%
\hypertarget{p-255}{}%
An object of mass \SI{3}{\kilo\gram} is fixed to both a spring and a dashpot with respective forces \(F_{S} = -9x\) and \(F_{R} = -2x'\), where \(x\) is the displacement of the mass in meters and \(x = 0\) is the equilibrium position. An external force \(F_{E} = 5\cos(\sqrt{3}t)\) is also applied to the mass, where \(t\) is in seconds. The mass was set in motion with an unknown speed and unknown velocity approximately \SI{7}{\second} ago. What will be the approximate position of the mass in \SI{40}{\second}?%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-37}{}\quad%
\hypertarget{p-256}{}%
We know that the position will look like \(x = x_{c} + x_{p}\) where \(x_{c}\to0\) as \(t\to\infty\), but we can't find the exact form of the transient solution without knowing the initial conditions. So we'll assume that we can estimate the position of the mass using the steady-state solution \(x_{p}\). Since%
\begin{equation*}
\omega = \omega_{0} = \sqrt{3}, \quad F_{0} = 5\quad\text{and}\quad c = 2,
\end{equation*}
we get%
\begin{equation*}
x_{p} = \frac{5}{6}\sqrt{3}\sin(\sqrt{3}t).
\end{equation*}
So after \SI{40}{\second} more seconds the mass should be around \(x_{p}(47)\), or about \SI{-0.388}{\meter}.%
\end{example}
\hypertarget{p-257}{}%
In fact, the actual initial conditions used in \hyperref[example-steady-state-approximation]{Example~\ref{example-steady-state-approximation}} were \(x(0) = 1\) and \(x'(0) = -2\). The corresponding exact solution is%
\begin{equation*}
x = e^{-\frac{t}{3}}\left[\cos\frac{\sqrt{26}}{3}t - \frac{25}{52}\sin\frac{\sqrt{26}}{3}t\right] + \frac{5}{6}\sqrt{3}\sin(\sqrt{3}t).
\end{equation*}
The exact value of \(x(47)\) is within several \emph{millionths} of the approximation \(x_{p}(47)\).%
\end{subsectionptx}
\begin{conclusion}{}%
\hypertarget{p-258}{}%
SUGGESTED PROBLEMS: 3, 9%
\end{conclusion}%
\end{sectionptx}
\end{chapterptx}
%
%
\typeout{************************************************}
\typeout{Chapter 3 Higher Order Linear ODEs}
\typeout{************************************************}
%
\begin{chapterptx}{Higher Order Linear ODEs}{}{Higher Order Linear ODEs}{}{}\label{higher-order-linear-odes}
\begin{introduction}{}%
\hypertarget{p-259}{}%
This chapter applies many of the ideas developed in \hyperref[linear-odes-constant-coefficients]{Chapter~\ref{linear-odes-constant-coefficients}} to higher order linear ODEs. We'll begin by transferring many of the concepts and terms introduced in \hyperref[section-second-order-linear-odes]{Sections~\ref{section-second-order-linear-odes}--\ref{section-homogeneous-odes-with-constant-coefficients}}.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Section 3.1 Homogeneous Linear ODEs with Constant Coefficients}
\typeout{************************************************}
%
\begin{sectionptx}{Homogeneous Linear ODEs with Constant Coefficients}{}{Homogeneous Linear ODEs with Constant Coefficients}{}{}\label{section-homogeneous-linear-odes-with-constant-coefficients}
\hypertarget{p-260}{}%
Each tool that we used for solving second order linear ODEs with constant coefficients, in other words those ODEs of the form \(ay''+by'+cy=f(x)\), can be extended to solving more general \(n^{\text{th}}\) order linear ODEs with constant coefficients, which take the form%
\begin{equation}
a_{n}y^{(n)}+a_{n-1}y^{(n-1)}+\dots+a_{1}y'+a_{0}y=f(x)\label{equation-constant-coeffs}
\end{equation}
where \(a_{i},0\leq i\leq n\) are constants and \(a_{n}\neq0\). In this section, we'll focus on solutions of \textit{homogeneous} \(n^{\th}\) order linear ODEs with constant coefficients. These are the ODEs where \(f(x) = 0\) in \hyperref[equation-constant-coeffs]{(\ref{equation-constant-coeffs})}.%
\par
\hypertarget{p-261}{}%
Recall that in Chapter 2, the general solution of \(ay''+by'+cy=0\) could be obtained by finding \emph{two} linearly independent solutions \(y_{1},y_{2}\). The general solution was then \(y = c_{1}y_{1}+c_{2}y_{2}\) (which is guaranteed to be a solution by \hyperref[theorem-the-superposition-principle]{Theorem~\ref{theorem-the-superposition-principle}} where \(c_{1},c_{2}\) are arbitrary constants. Similarly, the general solution of \hyperref[equation-constant-coeffs]{(\ref{equation-constant-coeffs})} is found by obtaining \(n\) linearly independent solutions \(y_{1},\dots,y_{n}\). The general solution in this case is now \(y = \sum_{i=1}^{n}c_{i}y_{i}\), where \(c_{i},1\leq i\leq n\) are arbitrary constants. Our main tool for showing that a collection \(\{y_{1},\dots,y_{n}\}\) of solutions is in fact linearly independent is again the \emph{Wronskian}.%
\begin{definition}{The Wronskian of Several Functions.}{definition-the-wronskian-of-several-functions}%
\index{Wronskian!Wronskian of several functions}\(\{y_{1},\dots,y_{n}\}\)\(\{y_{1},\dots,y_{n}\}\)\(W(y_{1},\dots,y_{n})\)%
\begin{equation*}
W(y_{1},\dots,y_{n}) = \left|\begin{array}{cccc}
y_{1} \amp y_{2} \amp \dots   \amp y_{n}   \\
y'_{1}  \amp y'_{2}  \amp \dots   \amp y'_{n}  \\
\vdots  \amp \vdots  \amp \ddots  \amp \vdots  \\
y^{(n-1)}_{1} \amp y^{(n-1)}_{2} \amp \dots   \amp y^{(n-1)}_{n} \\
\end{array}\right|.
\end{equation*}
\end{definition}
\hypertarget{p-262}{}%
Just as before, we have the following connection between the Wronskian and linear independence. This theorem is a restatement of \hyperref[theorem-linear-independence-and-the-wronskian]{Theorem~\ref{theorem-linear-independence-and-the-wronskian}} for collections involving more than two functions.%
\begin{theorem}{Linear Independence and the Wronskian (Several Functions).}{}{theorem-linear-independence-and-the-wronskian-several-functions}%
\hypertarget{p-263}{}%
Let \(I\) be some open interval (we often take \(I\) to be \((-\infty,\infty)\), but it doesn't have to be so) and let \(\set{y_{1},\dots,y_{n}}\) be solutions of \hyperref[equation-constant-coeffs]{(\ref{equation-constant-coeffs})}. If \(W(y_{1},\dots,y_{n})\neq0\) for some point \(x_{0}\in I\), then \(\set{y_{1},\dots,y_{n}}\) is linearly independent.%
\end{theorem}
\hypertarget{p-264}{}%
Now that we have a tool for determining linear independence of several functions, we can also define a \emph{basis of solutions} for higher order ODEs.%
\begin{definition}{Basis of Solutions (Higher Order ODEs).}{definition-basis-of-solutions-higher-order}%
\index{higher order ODEs!higher order linear ODEs!basis}\hypertarget{p-265}{}%
Let \(y_{1}, y_{2},\ldots,\) and \(y_{n}\) denote solutions of some \(n^{\text{th}}\) order linear homogeneous ODE. We call \(\{y_{1},y_{2},\ldots,y_{n}\}\) a \terminology{basis} if this set is also linearly independent.%
\end{definition}
\hypertarget{p-266}{}%
Bases are used to determine general solutions of linear ODEs.%
\begin{example}{Finding a Basis Set of Solutions.}{example-finding-a-basis-set-of-solutions}%
\hypertarget{p-267}{}%
Find the general solution of%
\begin{equation*}
y^{(3)}-6y''+11y'-6y=0
\end{equation*}
where \(y\) is a function of \(x\).%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-38}{}\quad%
\hypertarget{p-268}{}%
Just as we did for second order ODEs, we'll solve this by finding the characteristic equation. To get the characteristic equation, we replace derivatives of \(y\) with powers of \(r\) to get%
\begin{equation*}
r^{3}-6r^{2}+11r-6=0.
\end{equation*}
Now we need to solve this equation. It can factor (notice that \(r=1\) is a solution and then divide \(r^{3}-6r^{2}+11r-6\) by \(r-1\)) as%
\begin{equation*}
(r-1)(r-2)(r-3)=0
\end{equation*}
and so \(r=1,2,3.\) This means that the functions%
\begin{equation*}
y_{1} = e^{x},y_{2} = e^{2x},y_{3} = e^{3x}
\end{equation*}
are all solutions of the original ODE. If we can show that they're also linearly independent, then this will imply that the general solution of the ODE is given by%
\begin{equation*}
y = c_{1}e^{x}+c_{2}e^{2x}+c_{3}e^{3x}.
\end{equation*}
To do this, we just compute the Wronskian of these functions:%
%
\begin{align*}
W(e^{x},e^{2x},e^{3x})
\amp= \left|
\begin{array}{ccc}
e^{x} \amp e^{2x}  \amp e^{3x}  \\
e^{x} \amp 2e^{2x} \amp 3e^{3x} \\
e^{x} \amp 4e^{2x} \amp 9e^{3x} \\
\end{array}
\right|\\
\amp= e^{x}(18e^{5x}-12e^{5x})-e^{2x}(9e^{4x}-3e^{4x})+e^{3x}(4e^{3x}-2e^{3x})\\
\amp= 2e^{6x}\\
\amp\neq0.
\end{align*}
\hypertarget{p-269}{}%
Since the Wronskian is nonzero, \(y_{1},y_{2}\) and \(y_{3}\) are in fact linearly independent, and so the general solution of this ODE is%
\begin{equation*}
y = c_{1}e^{x}+c_{2}e^{2x}+c_{3}e^{3x}.
\end{equation*}
%
\end{example}
\begin{aside}{}{aside-10}%
\hypertarget{p-270}{}%
It can get tedious to try to compute the Wronskian every time when solving linear ODEs with constant coefficients, so it's good to note that \(\set{e^{r_{1}x},\dots,e^{r_{n}x}}\) is guaranteed to be linearly independent as long as each of the \(r_{i}\) are distinct from the others.%
\end{aside}
\begin{example}{}{example-42}%
\hypertarget{p-271}{}%
Find the general solution of \(y^{(4)}-y=0\), where \(y\) is a function of \(x\).%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-39}{}\quad%
\hypertarget{p-272}{}%
We begin by finding the characteristic equation, which is%
\begin{equation*}
r^{4}-1=0\quad\text{or}\quad (r^{2}-1)(r^{2}+1)=0.
\end{equation*}
This has solutions \(r=\pm1,\pm i\). This means that \(y_{1} = e^{x},y_{2}=e^{-x},y_{3}=e^{ix}\) and \(y=e^{-ix}\) are all solutions of the ODE. Since the roots of the characteristic equation are all distinct, this means that these solutions are linearly independent from each other. Since we have four linearly independent solutions, we can then construct the general solution of this ODE:%
\begin{equation*}
y = c_{1}e^{x}+c_{2}e^{-x}+c_{3}e^{ix}+c_{4}e^{-ix},
\end{equation*}
which we can also rewrite using Euler's Formula \(e^{i\theta} = \cos\theta+i\sin\theta\) to get%
\begin{equation*}
y = c_{1}e^{x}+c_{2}e^{-x}+A\cos x+B\sin x.
\end{equation*}
%
\end{example}
\hypertarget{p-273}{}%
In general, any root of the characteristic equation of the form \(r=a\pm bi\) contributes the term \(e^{ax}\brackets{A\cos bx+B\sin bx}\) to the general solution. As we saw in Chapter 2, it's possible for some characteristic equations to have repeated roots. In this case, we initially weren't able to get enough linearly independent solutions, so we had to adjust our method a bit. The same adjustment will work here.%
\begin{example}{Characteristic Equation with Repeated Roots.}{example-characteristic-equation-with-repeated-roots}%
\hypertarget{p-274}{}%
Find the general solution of%
\begin{equation*}
x^{(3)}+4x''+4x'=0
\end{equation*}
where \(x\) is a function of \(t\).%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-40}{}\quad%
\hypertarget{p-275}{}%
The characteristic equation is%
\begin{equation*}
r^{3}+4r^{2}+4r = 0\quad\text{or}\quad r(r+2)^{2}=0
\end{equation*}
so \(r=0,-2,-2\). One solution of the ODE will be \(x_{1} = e^{0t} = 1\), and a second solution will be \(x_{2} = e^{-2t}\). But since \(r=-2\) is a repeated root, it does not provide a third linearly independent solution \(x_{3}\). So we'll use the same trick we used before and multiply by \(t\) to get a third solution: \(x_{3} = te^{-2t}\). It can be verified that \(x_{3}\) is in fact a solution of the ODE, and is also linearly independent from \(x_{1},x_{2}\). Therefore the general solution of the ODE is%
\begin{equation*}
x = c_{1}+c_{2}e^{-2t}+c_{3}te^{-2t}.
\end{equation*}
%
\end{example}
\hypertarget{p-276}{}%
Solutions of linear, homogeneous ODEs with constant coefficients depend \emph{entirely} on the roots of the corresponding characteristic equation. If we write the independent variable as \(x\), and if \(r_{k}\) denotes a single root of the characteristic equation, then the general solution of the ODE will contain \(e^{r_{k}x},xe^{r_{k}x},x^{2}e^{r_{k}x},\dots\), with the number of exponentials contributed by \(r_{k}\) being equal to its multiplicity. That is, the number of times \(r_{k}\) appears as a solution of the characteristic equation.%
\begin{example}{}{example-44}%
\hypertarget{p-277}{}%
A linear, homogeneous ODE with constant coefficients (and independent variable \(t\)) has characteristic equation given by%
\begin{equation*}
r(r-1)(r+1)^{2}(2r-3)^{3} = 0.
\end{equation*}
What is the general solution of the ODE?%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-41}{}\quad%
\hypertarget{p-278}{}%
We'll set up a table listing each root, its multiplicity and its contribution to the general solution:%
\begin{table}
\centering
\begin{tabular}{lll}\hrulethick
Root&Multiplicity&Contribution\tabularnewline\hrulethick
\(0\)&\(1\)&\(1\)\tabularnewline\hrulethick
\(1\)&\(1\)&\(e^{t}\)\tabularnewline\hrulethick
\(-1\)&\(2\)&\(e^{-t},te^{-t}\)\tabularnewline\hrulethick
\(\frac{3}{2}\)&\(3\)&\(e^{3t/2},te^{3t/2},t^{2}e^{3t/2}\)\tabularnewline\hrulethick
\end{tabular}
\end{table}
 So the general solution of this ODE is%
\begin{equation*}
c_{1}+c_{2}e^{t}+c_{3}e^{-t}+c_{4}te^{-t}+c_{5}e^{3t/2}+c_{6}te^{3t/2}+c_{7}t^{2}e^{3t/2}.
\end{equation*}
\end{example}
\begin{example}{}{example-45}%
\hypertarget{p-279}{}%
An ODE (with independent variable \(x\)) has characteristic equation given by%
\begin{equation*}
r^{2}(r-3)(r^{2}+4)(r^{2}+6r+13)^{3}=0.
\end{equation*}
Find the general solution.%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-42}{}\quad%
\hypertarget{p-280}{}%
We'll set up another table help us determine the general solution:%
\begin{table}
\centering
\begin{tabular}{lll}\hrulethick
Root&Multiplicity&Contribution\tabularnewline\hrulethick
\(0\)&\(2\)&\(1,x\)\tabularnewline\hrulethick
\(3\)&\(1\)&\(e^{3x}\)\tabularnewline\hrulethick
\(\pm2i\)&\(1\)&\(\cos2x,\sin2x\)\tabularnewline\hrulethick
\(-3\pm2i\)&\(3\)&\(e^{-3x}\cos2x,e^{-3x}\sin2x,xe^{-3x}\cos2x,xe^{-3x}\sin2x,x^{2}e^{-3x}\cos2x,x^{2}e^{-3x}\sin2x\)\tabularnewline\hrulethick
\end{tabular}
\end{table}
\hypertarget{p-281}{}%
So the general solution is%
\begin{equation*}
c_{1}+c_{2}x+c_{3}e^{3x}+A\cos2x+B\sin2x+e^{-3x}\brackets{(A_{1}+A_{2}x+A_{3}x^{2})\cos2x+(B_{1}+B_{2}x+B_{3}x^{2})\sin2x}.
\end{equation*}
%
\end{example}
\begin{conclusion}{}%
\hypertarget{p-282}{}%
SUGGESTED PROBLEMS: 1, 3, 7, 9%
\end{conclusion}%
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 3.2 Non-homogeneous Linear ODEs with Constant Coefficients}
\typeout{************************************************}
%
\begin{sectionptx}{Non-homogeneous Linear ODEs with Constant Coefficients}{}{Non-homogeneous Linear ODEs with Constant Coefficients}{}{}\label{section-non-homogeneous-linear-odes-with-constant-coefficients}
\hypertarget{p-283}{}%
For second order ODEs that were nonhomogeneous, linear and had constant coefficients, we found their general solution by first finding the complementary solution \(y_{c}\) and then a corresponding particular solution \(y_{p}\). The general solution was then \(y=y_{c}+y_{p}\). \(y_{c}\) was found by solving the corresponding homogeneous equation and we used the method of undetermined coefficients to find \(y_{p}\). Although we are now looking at higher order ODEs, the method of undetermined coefficients remains unchanged.%
\begin{example}{}{example-46}%
\hypertarget{p-284}{}%
Find the general solution of%
\begin{equation*}
y^{(3)}-y' = \sinh 2x.
\end{equation*}
%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-43}{}\quad%
\hypertarget{p-285}{}%
The general solution takes the form \(y = y_{c}+y_{p}\), where \(y_{c}\) is a solution of the associated homogeneous equation \(y^{(3)}-y'=0\) and \(y_{p}\) is a single solution of the original ODE \(y^{(3)}-y'=\sinh 2x\). Since the characteristic equation of \(y^{(3)}-y'=0\) is \(r^{3}-r=0\), we get%
\begin{equation*}
y_{c} = c_{1}+c_{2}e^{x}+c_{3}e^{-x} = c_{1}+A\cosh x+B\sinh x.
\end{equation*}
Now we'll find \(y_{p}\). Since the right hand side of the ODE is \(\sinh 2x\), a good initial guess would be \(y_{p} = C\sinh 2x\). However, when we take this guess and plug it into the ODE, we'll start seeing terms involving \(\cosh 2x\) as well (since \(\frac{d}{dx}\sinh 2x = 2\cosh 2x\)) so this means we'll want to include \(\cosh 2x\) into our guess for \(y_{p}\) also. So we'll modify our guess to be \(y_{p} = C\cosh 2x+D\sinh 2x\).%
\par
\hypertarget{p-286}{}%
Since our guess for \(y_{p}\) doesn't overlap with \(y_{c}\), we can proceed with plugging our guess into the original ODE \(y^{(3)}-y'=\sinh 2x\) and equating coefficients, just as we did before.%
\begin{align*}
\sinh 2x \amp= y^{(3)}_{p}-y'_{p}\\
\amp= \parens{8C\sinh2x+8D\cosh2x}-\parens{2C\sinh2x+2D\cosh2x}\\
\amp= 6C\sinh2x+6D\cosh2x.
\end{align*}
So we get \(C = \frac{1}{6}\) and \(D=0\), which means that \(y_{p} = \frac{1}{6}\cosh2x\). When solving for \(y_{p}\), always remember to plug the values you find back into the guess for \(y_{p}\) that you used! So the general solution of the ODE is%
\begin{equation*}
y = c_{1}+A\cosh x+B\sinh x+\frac{1}{6}\cosh2x.
\end{equation*}
%
\end{example}
\hypertarget{p-287}{}%
Just as before, we also need to worry about overlaps.%
\begin{example}{}{example-47}%
\hypertarget{p-288}{}%
Find the appropriate form of \(x_{p}\) for the ODE%
\begin{equation*}
\dv[7]{x}{t}+8\dv[5]{x}{t}+16\dv[3]{x}{t} = 5t-3t^{2}+e^{-t}\cos2t-3t\sin2t.
\end{equation*}
%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-44}{}\quad%
\hypertarget{p-289}{}%
We need to find \(x_{c}\) first since \(x_{p}\) will change depending on \(x_{c}\). Since the characteristic equation of the associated homogeneous ODE \(\dv[7]{x}{t}+8\dv[5]{x}{t}+16\dv[3]{x}{t}=0\) is%
\begin{equation*}
r^{7}+8r^{5}+16r^{3} = 0\quad\text{or}\quad r^{3}(r^{2}+4)^{2}=0,
\end{equation*}
we get%
\begin{equation*}
x_{c} = c_{1}+c_{2}t+c_{3}t^{2}+A\cos2t+B\sin2t + t\brackets{C\cos2t+D\sin2t}.
\end{equation*}
%
\par
\hypertarget{p-290}{}%
Now we come up with a guess for \(x_{p}\) using the right hand side of the original ODE and dividing it into ``components:''%
\begin{table}
\centering
\begin{tabular}{ll}\hrulethick
Component&Contribution to \(x_{p}\)\tabularnewline\hrulethick
\(2t-3t^{2}\)&\(C_{1}t^{2}+C_{2}t+C_{3}\)\tabularnewline[0pt]
\(e^{-t}\cos2t\)&\(e^{-t}\brackets{C_{4}\cos2t+C_{5}\sin2t}\)\tabularnewline[0pt]
\(-3t\sin2t\)&\(\parens{C_{6}t+C_{7}}\cos2t+\parens{C_{8}t+C_{9}}\sin2t\)\tabularnewline\hrulethick
\end{tabular}
\caption{Initial guess of \(x_{p}\) for \(\dv[7]{x}{t}+8\dv[5]{x}{t}+16\dv[3]{x}{t} = 5t-3t^{2}+e^{-t}\cos2t-3t\sin2t.\)\label{table-6}}
\end{table}
\hypertarget{p-291}{}%
However, we now have a problem with overlaps between \(x_{p}\) and \(x_{c}\). The guess corresponding to the first component overlaps with \(x_{c}\), so we need to multiply it by \(t^{3}\) to remove the overlap. Similarly, the guess corresponding to the third component overlaps, so we must multiply it by \(t^{2}\). Therefore, our guess for \(x_{p}\) should be%
\begin{equation*}
x_{p} = C_{1}t^{5}+C_{2}t^{4}+C_{3}t^{3}+e^{-t}\brackets{C_{4}\cos2t+C_{5}\sin2t}+(C_{6}t^{3}+C_{7}t^{2})\cos2t+(C_{8}t^{3}+C_{9}t^{2})\sin2t.
\end{equation*}
%
\end{example}
\hypertarget{p-292}{}%
The method of undetermined coefficients applied to the ODE%
\begin{equation*}
a_{n}y^{(n)}+a_{n-1}y^{(n-1)}+\dots+a_{1}y'+a_{0}y = f(x)   
\end{equation*}
can be summarized by the following table:%
\begin{table}
\centering
\begin{tabular}{ll}\hrulethick
Component of \(f(x)\)&Contribution to \(y_{p}\)\tabularnewline\hrulethick
\(c_{k}x^{k}+\dots+c_{1}x+c_{0}\)&\(x^{m}(C_{k}x^{k}+C_{k-1}x^{k-1}+\dots+C_{1}x+C_{0})\)\tabularnewline[0pt]
\((c_{k}x^{k}+\dots+c_{1}x+c_{0})e^{ax}\sin bx\)&\(x^{m}e^{ax}\brackets{(C_{k}x^{k}+\dots+C_{1}x+C_{0})\cos bx+(D_{k}x^{k}+\dots+D_{1}x+D_{0})\sin bx}\)\tabularnewline[0pt]
\((c_{k}x^{k}+\dots+c_{1}x+c_{0})e^{ax}\cos bx\)&\(x^{m}e^{ax}\brackets{(C_{k}x^{k}+\dots+C_{1}x+C_{0})\cos bx+(D_{k}x^{k}+\dots+D_{1}x+D_{0})\sin bx}\)\tabularnewline[0pt]
\((c_{k}x^{k}+\dots+c_{1}x+c_{0})e^{ax}\sinh bx\)&\(x^{m}e^{ax}\brackets{(C_{k}x^{k}+\dots+C_{1}x+C_{0})\cosh bx+(D_{k}x^{k}+\dots+D_{1}x+D_{0})\sinh bx}\)\tabularnewline[0pt]
\((c_{k}x^{k}+\dots+c_{1}x+c_{0})e^{ax}\cosh bx\)&\(x^{m}e^{ax}\brackets{(C_{k}x^{k}+\dots+C_{1}x+C_{0})\cosh bx+(D_{k}x^{k}+\dots+D_{1}x+D_{0})\sinh bx}\)\tabularnewline\hrulethick
\end{tabular}
\caption{\(x^m\) is the \emph{smallest} power of \(x\) required to remove any overlaps with \(y_{c}\).\label{table-7}}
\end{table}
\begin{example}{}{example-48}%
\hypertarget{p-293}{}%
Find the general solution of%
\begin{equation*}
y^{(3)}-2y''+3y'= x+e^{-3x}\sin x
\end{equation*}
%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-45}{}\quad%
\hypertarget{p-294}{}%
We begin by finding \(y_{c}\). Since the characteristic equation of the corresponding homogeneous ODE is \(r^{3}-2r^{2}+3r=0\), we get \(r=-0,\frac{2\pm\sqrt{4-12}}{2}\) or just \(r=0,1\pm i\sqrt{2}\). So%
\begin{equation*}
y_{c} = c_{1}+e^{x}(A\cos\sqrt{2}x+B\sin\sqrt{2}x).
\end{equation*}
Now we can set up \(y_{p}\):%
\begin{table}
\centering
\begin{tabular}{ll}\hrulethick
Component&Contribution to \(y_{p}\)\tabularnewline\hrulethick
\(x\)&\(x(C_{1}x+C_{2})\)\tabularnewline[0pt]
\(e^{-3x}\sin x\)&\(e^{-3x}\brackets{C_{3}\cos x+C_{4}\sin x}\)\tabularnewline\hrulethick
\end{tabular}
\end{table}
\hypertarget{p-295}{}%
So our initial guess for \(y_{p}\) is given by \(y_{p} = C_{1}x^{2}+C_{2}x+C_{3}e^{-3x}\cos x+C_{4}e^{-3x}\sin x\). Plugging this into the ODE into a CAS such as Maple or Sage gives%
\begin{align*}
x+e^{-3x}\sin x \amp= y^{(3)}_{p}-2y''_{p}+3y'_{p}\\
\amp= 6C_{1}x+(3C_{2}-4C_{1}) \\
\amp\quad + \parens{-43C_{3}+41C_{4}}e^{-3x}\cos x+\parens{-41C_{3}-43C_{4}}e^{-3x}\sin x
\end{align*}
This gives us the system of equations%
\begin{align*}
6C_{1}  \amp=  1\\
3C_{2}-4C_{1} \amp=  0\\
-43C_{3}+41C_{4}  \amp=  0\\
-41C_{3}-43C_{4}  \amp= 1
\end{align*}
which we can solve using Sage to get%
\begin{equation*}
C_{1} = \frac{1}{6},C_{2} = \frac{2}{9},C_{3} = -\frac{41}{3530},C_{4}=-\frac{43}{3530}.
\end{equation*}
%
\par
\hypertarget{p-296}{}%
So the general solution of the ODE is%
\begin{equation*}
y = y_{c}+y_{p} = c_{1}+e^{x}(A\cos\sqrt{2}x+B\sin\sqrt{2}x) +\frac{1}{6}x^{2}+\frac{2}{9}x-\frac{e^{-3x}}{3530}\brackets{41\cos x+43\sin x}.
\end{equation*}
%
\end{example}
\begin{sageinput}
# Set variables
c1, c2, c3, c4 = var('c1 c2 c3 c4')

# Set up equations as variables for clarity
eqn1 = 6*c1
eqn2 = 3*c2 - 4*c1
eqn3 = -43*c3 + 41*c4
eqn4 = -41*c3 - 43*c4

solve([eqn1 == 1, eqn2 == 0, eqn3 == 0, eqn4 == 1], c1, c2, c3, c4)
\end{sageinput}
\begin{sageoutput}
[[c1 == (1/6), c2 == (2/9), c3 == (-41/3530), c4 == (-43/3530)]]
\end{sageoutput}
\end{sectionptx}
\end{chapterptx}
%
%
\typeout{************************************************}
\typeout{Chapter 4 Systems of Ordinary Differential Equations}
\typeout{************************************************}
%
\begin{chapterptx}{Systems of Ordinary Differential Equations}{}{Systems of Ordinary Differential Equations}{}{}\label{systems-of-odes}
%
%
\typeout{************************************************}
\typeout{Section 4.1 Systems of ODEs as Models}
\typeout{************************************************}
%
\begin{sectionptx}{Systems of ODEs as Models}{}{Systems of ODEs as Models}{}{}\label{section-systems-of-odes-as-models}
\hypertarget{p-297}{}%
Interdependent quantities can often be represented mathematically by a system of equations. If we have information about the rates of change of these quantities, then we may be able to develop a model using a system of differential equations.%
\begin{definition}{}{definition-first-order-system}%
\index{first-order systems!definition}\hypertarget{p-298}{}%
A \terminology{first order system} of ODEs is a system of differential equations involving some collection of functions and their first derivatives.%
\end{definition}
\hypertarget{p-299}{}%
We are still only dealing with ordinary differential equations which means that we will only ever have one independent variable. However, when dealing with systems of ODEs we will be working with several \emph{dependent} variables.%
\par
\hypertarget{p-300}{}%
The systems of ODEs that we will consider will typically look like the following:%
\begin{align*}
x_{1}'  \amp=  a_{11}x_{1} +a_{12}x_{2}+\dots+a_{1n}x_{n}\\
x'_{2}  \amp=  a_{21}x_{1} + a_{22}x_{2} + \dots + a_{2n}x_{2}\\
\amp\vdots\\
x'_{n}  \amp=  a_{n1}x_{1} + a_{n2}x_{2} + \dots + a_{nn}x_{n}
\end{align*}
where \(a_{ij}\) are constants and \(y_{i}\) are functions of \(t\).%
\begin{example}{}{example-interconnected-tanks}%
\hypertarget{p-301}{}%
Two brine tanks are set up as in \hyperref[figure-interconnected-tanks]{Figure~\ref{figure-interconnected-tanks}}. Fresh water flows into the tank at a rate of \(r_{1}\), well-mixed solution flows from Tank 1 to Tank 2 at a rate of \(r_{2}\) and well-mixed solution flows out of Tank 2 at a rate of \(r_{3}\). Suppose that \(r_{1}, r_{2}\) and  \(r_{3}\) are \SI{5}{\gallon\per\minute}, the volume of solution in Tank 1 is \SI{10}{\gallon} and the volume of solution in Tank 2 is \SI{7}{\gallon}. Suppose Tank 1 has \SI{5}{\pound} of salt at time \(t=0\) and Tank 2 has \SI{2}{\pound} of salt at time \(t=0\). Set up a first-order system that describes the amount of salt in each tank at time \(t\).%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-46}{}\quad%
\hypertarget{p-302}{}%
Let \(x_{1}(t)\) denote the amount of salt in Tank 1 at time \(t\), and \(x_{2}(t)\) denote the amount of salt in Tank 2 at time \(t\). Using the mixture ODE \(\dv{x}{t} = r_{i}c_{i}-r_{o}\frac{x}{V(t)}\) developed in \hyperref[section-first-order-linear-odes]{Section~\ref{section-first-order-linear-odes}}, we can write%
\begin{align*}
\dv{x_{1}}{t} \amp= 5\cdot0 - 5\frac{x_{1}}{10}\\
\dv{x_{2}}{t} \amp= 5\frac{x_{1}}{10}-5\frac{x_{2}}{7}
\end{align*}
or just%
\begin{align*}
x'_{1}  \amp=  -\frac{1}{2}x_{1}\\
x'_{2}  \amp=  \frac{1}{2}x_{1}-\frac{5}{7}x_{2},
\end{align*}
with initial conditions \(x_{1}(0) = 5\) and \(x_{2}(0) = 2\).%
\end{example}
\begin{figure}
\centering
{
\begin{tikzpicture}[scale=.7]
% stolen shamelessly from stackexchange somebody CALL THE COPS
% draw the tanks
\draw (0,6)--(0,0)--(3,0)--(3,1)--(4,1)--(4,0)--(6,0)--(6,-1);
\draw (7,-1)--(7,5)--(4,5)--(4,4)--(3,4)--(3,5)--(1,5)--(1,6);
% fill Tank 1 with water (in the background)
\begin{pgfonlayer}{background}
\filldraw[blue!40] (0,4.5)--(3,4.5)--(3,4)% tank 1
--(4,4)         % connection
--(4,1)--(3,1)--(3,0)--(0,0) %back to tank 1
-- cycle;
\end{pgfonlayer}
% fill Tank 2 with water (in the background)
\begin{pgfonlayer}{background}
\filldraw[blue!40] (4,3.5)--(7,3.5)--(7,-1)--(6,-1)--(6,0)--(4,0) % tank 2
-- cycle;
\end{pgfonlayer}

% connection piece
\filldraw[white,draw=white] (3,2)--(3,5)--(4,5)--(4,2)--cycle;
\draw[color = black] (3,5)--(3,2)--(4,2)--(4,5);

% add the rates
\draw[->] (0.5,7)--(0.5,5)node[pos=0,anchor=south west]{$r_{1}$};
\draw[->] (3,1.5)--(4,1.5)node[midway, yshift = .5cm]{$r_{2}$};
\draw[->] (6.5,0)--(6.5,-2)node[pos=1,anchor=north]{$r_{3}$};
\node at (1,1){Tank 1};
\node at (6,1){Tank 2};
\end{tikzpicture}
}
\caption{The two interconnected tanks from \hyperref[example-interconnected-tanks]{Example~\ref{example-interconnected-tanks}}.\label{figure-interconnected-tanks}}
\end{figure}
\hypertarget{p-303}{}%
To actually solve systems of ODEs, we'll use \emph{matrices} to rewrite these systems as \emph{matrix ODEs}.%
\begin{definition}{}{definition-matrices-and-vectors}%
\index{matrices!definition}\index{vectors!definition|seealso{matrices}}\hypertarget{p-304}{}%
An \(m\times n\) \terminology{matrix} is an array of \(m\) rows and \(n\) columns. \(m\times1\) matrices are called (\terminology{column}) \terminology{vectors}. Matrices are typically denoted with capital italic letters (such as \(A\), \(M\)) and vectors are often denoted with lower case bold letters (such as \(\vec{v},\vec{x})\). A \terminology{zero matrix} will be denoted using \(\vec{0}\).%
\end{definition}
\hypertarget{p-305}{}%
As a brief example, let%
\begin{equation*}
A = \begin{bmatrix} 1\amp2\amp-1\\3\amp0\amp0\end{bmatrix}\quad\text{and}\quad \vec{y} = \begin{bmatrix} 1\\-1\\1 \end{bmatrix}.
\end{equation*}
Then \(A\) is a \(2\times3\) matrix and \(\vec{y}\) is a \(3\times 1\) vector.%
\begin{definition}{Matrix-Vector Product.}{definition-matrix-vector-product}%
\hypertarget{p-306}{}%
Let \(A\) be the \(2\times 2\) matrix%
\begin{equation*}
A = \begin{bmatrix} a_{11}\amp a_{12}\\a_{21}\amp a_{22} \end{bmatrix}
\end{equation*}
and let \(\vec{v} = \begin{bmatrix} v_{1}\\v_{2} \end{bmatrix}\). Then their \terminology{product} \(A\vec{v}\) is the vector defined to be%
\begin{equation*}
A\vec{v} = \begin{bmatrix} a_{11}v_{1}+a_{12}v_{2}\\a_{21}v_{1}+a_{22}v_{2} \end{bmatrix}.
\end{equation*}
The \(2\times 2\) \terminology{identity matrix} is the matrix \(I = \begin{bmatrix}1\amp0\\0\amp1\end{bmatrix}\). A \terminology{scalar} is just a constant. To multiply a scalar \(c\) with a matrix \(A\), just multiply every element of \(A\) with \(c\).%
\end{definition}
\hypertarget{p-307}{}%
If \(A\) is any \(2\times2\) matrix and \(\vec{v}\) and \(2\times1\) vector, then \(AI=IA=A\) and \(I\vec{v} = \vec{v}\).%
\begin{example}{}{example-50}%
\hypertarget{p-308}{}%
Let \(A = \begin{bmatrix} 1\amp0\\-3\amp2 \end{bmatrix},\vec{v}_{1} = \begin{bmatrix}1\\1\end{bmatrix}\) and \(\vec{v}_{2} = \begin{bmatrix}0\\5\end{bmatrix}\). Compute \(A\vec{v}_{1}\) and \(A\vec{v}_{2}\).%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-47}{}\quad%
\hypertarget{p-309}{}%
By definition,%
\begin{equation*}
A\vec{v}_{1} = \begin{bmatrix}1\cdot1+0\cdot1\\-3\cdot1+2\cdot1\end{bmatrix} = \begin{bmatrix}1\\-1\end{bmatrix}\quad\text{and}\quad A\vec{v}_{2} = \begin{bmatrix}1\cdot0+0\cdot5\\-3\cdot0+2\cdot5\end{bmatrix} = \begin{bmatrix}0\\10\end{bmatrix}.
\end{equation*}
%
\end{example}
\hypertarget{p-310}{}%
In the last example, notice that \(A\vec{v}_{2} = 2\vec{v}_{2}\). This means that \(A\) didn't really do all that much to \(\vec{v}_{2}\) except to stretch it by a factor of \(2\). Vectors with this property will turn out to be the key to solving our systems of ODEs.%
\begin{definition}{Eigenvectors and eigenvalues.}{definition-eigenvectors-and-eigenvalues}%
\hypertarget{p-311}{}%
Let \(A\) be a matrix. A nonzero vector \(\vec{v}\) is an \terminology{eigenvector} of \(A\) if \(A\vec{v} = \lambda\vec{v}\) for some scalar \(\lambda\). We call \(\lambda\) an \terminology{eigenvalue} of \(A\) corresponding to the eigenvector \(\vec{v}\).%
\end{definition}
\begin{example}{}{example-eigenvalue-eigenvector}%
\hypertarget{p-312}{}%
Determine if \(\vec{v} = \begin{bmatrix}-2\\1\end{bmatrix}\) is an eigenvector of \(A = \begin{bmatrix}1\amp4\\1\amp1\end{bmatrix}\).%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-48}{}\quad%
\hypertarget{p-313}{}%
To do this, we just need to compute \(A\vec{v}:\)%
\begin{equation*}
A\vec{v} = \begin{bmatrix}1\amp4\\1\amp1\end{bmatrix}\begin{bmatrix}-2\\1\end{bmatrix} = \begin{bmatrix}2\\-1\end{bmatrix} = -\vec{v}.
\end{equation*}
So \(\vec{v}\) is an eigenvector of \(A\) with corresponding eigenvalue \(\lambda=-1\).%
\end{example}
\hypertarget{p-314}{}%
Since we will be looking at systems of ODEs which involve functions, we will need to define vector-valued functions.%
\begin{definition}{Vector-Valued Functions.}{definition-vector-valued-function}%
\hypertarget{p-315}{}%
A \terminology{vector-valued function} is a vector whose elements are functions. If each of the functions in a vector \(\vec{x}\) depends on the variable \(t\), we often write \(\vec{x}(t)\) to denote this. The derivative of a vector-valued function \(\vec{x}(t) = \begin{bmatrix}x_{1}(t)\\x_{2}(t)\end{bmatrix}\) is the new vector-valued function \(\vec{x}'(t)=\begin{bmatrix}x'_{1}(t)\\x'_{2}(t)\end{bmatrix}\).%
\end{definition}
\hypertarget{p-316}{}%
We now have all of the tools we need to rewrite a first-order system as a matrix ODE. Let%
\begin{align*}
x' \amp= a_{11}x+a_{12}y\\
y' \amp= a_{21}x+a_{22}y
\end{align*}
If \(A = \begin{bmatrix}a_{11}\amp a_{12} \\ a_{21}\amp a_{22}\end{bmatrix}\) and \(\vec{x} = \begin{bmatrix}x\\y\end{bmatrix}\), then%
\begin{equation*}
A\vec{x} = \begin{bmatrix}x'\\y'\end{bmatrix} = \vec{x}'.
\end{equation*}
In other words, we may rewrite the system as the matrix ODE%
\begin{equation*}
\vec{x}' =A\vec{x}.
\end{equation*}
%
\begin{example}{}{example-52}%
\hypertarget{p-317}{}%
Write the system%
\begin{align*}
x'_{1}  \amp = -\frac{1}{2}x_{1}\\
x'_{2}  \amp = \frac{1}{2}x_{1}-\frac{5}{7}x_{2}
\end{align*}
as a matrix ODE.%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-49}{}\quad%
\hypertarget{p-318}{}%
We need to find a matrix \(A\) and vector \(\vec{x}\) to let us rewrite this system. The matrix \(A\) is formed from the coefficients of \(x_{1},x_{2}\) on the right hand side of the system:%
\begin{equation*}
A = \begin{bmatrix}-\frac{1}{2}\amp 0\\\frac{1}{2}\amp -\frac{5}{7}\end{bmatrix}.
\end{equation*}
The vector \(\vec{x}\) is just made up of the dependent variables \(x_{1},x_{2}\):%
\begin{equation*}
\vec{x} = \begin{bmatrix}x_{1}\\x_{2}\end{bmatrix}.
\end{equation*}
With these terms, the original system of ODEs is equivalent to the single matrix ODE%
\begin{equation*}
\vec{x}' = A\vec{x}.
\end{equation*}
%
\end{example}
\begin{example}{}{example-53}%
\hypertarget{p-319}{}%
Show that \(e^{-t}\vec{x}_{0}\) where \(\vec{x}_{0} = \begin{bmatrix}-2\\1\end{bmatrix}\) is a solution of the system%
\begin{equation*}
\vec{x}' = \begin{bmatrix}1\amp 4\\1\amp 1\end{bmatrix}\vec{x}.
\end{equation*}
%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-50}{}\quad%
\hypertarget{p-320}{}%
We'll check that \(\vec{x}_{0}\) is a solution of the matrix ODE just as we check solutions for normal ODEs: plug the potential solution into the ODE and check both sides. If we do so, we get%
\begin{equation*}
\dv{}{t}\brackets*{e^{-t}\vec{x}_{0}} = -e^{-t}\begin{bmatrix}-2\\1\end{bmatrix} = e^{-t}\begin{bmatrix}2\\-1\end{bmatrix}
\end{equation*}
and%
\begin{equation*}
\begin{bmatrix}1\amp 4\\1\amp 1\end{bmatrix}e^{-t}\vec{x}_{0} = e^{-t}\begin{bmatrix}1\amp 4\\1\amp 1\end{bmatrix}\begin{bmatrix}-2\\1\end{bmatrix} = e^{-t}\begin{bmatrix}2\\-1\end{bmatrix}.
\end{equation*}
Since these expressions match, this means that \(e^{-t}\vec{x}_{0}\) is a solution of the ODE.%
\end{example}
\hypertarget{p-321}{}%
One thing to note about the previous example is that \(\begin{bmatrix}-2\\1\end{bmatrix}\) was an eigenvector of \(\begin{bmatrix}1\amp 4\\1\amp 1\end{bmatrix}\) with corresponding eigenvalue \(\lambda=-1\). See \hyperref[example-eigenvalue-eigenvector]{Example~\ref{example-eigenvalue-eigenvector}}. This suggests that solutions of the matrix ODE \(\vec{x}' = A\vec{x}\) take the form \(\vec{x} = e^{\lambda t}\vec{x}_{0}\), where \(\lambda\) is an eigenvalue of \(A\) with corresponding eigenvector \(\vec{x}_{0}\). One last concept we need is that of linear independence of vectors.%
\begin{definition}{Linear Independence of Vectors.}{definition-linear-independence-of-vectors}%
\index{linear independence!vectors}\hypertarget{p-322}{}%
Let \(\vec{x}_{1},\dots,\vec{x}_{n}\) denote a collection of vectors. We say that the vectors are \terminology{linearly independent} if the equality%
\begin{equation*}
\sum_{i=1}^{n}c_{i}\vec{x}_{i} = \vec{0}
\end{equation*}
is possible if and only if \(c_{1}=\dots=c_{n}=0\). Otherwise, we say that the vectors are \terminology{linearly dependent}.%
\end{definition}
\hypertarget{p-323}{}%
Just as before, our primary tool for showing if a collection is linearly independent is the Wronskian.%
\begin{definition}{}{definition-wronskian-of-vectors}%
\index{Wronskian!vectors}\hypertarget{p-324}{}%
The \terminology{Wronskian} of \(\vec{x}_{1},\dots,\vec{x}_{n}\) is the number \(W(\vec{x}_{1},\dots,\vec{x}_{n})\) defined by%
\begin{equation*}
W(\vec{x}_{1},\dots,\vec{x}_{n}) = \begin{vmatrix}\vec{x}_{1}  \amp  \dots   \amp  \vec{x}_{n}\end{vmatrix}.
\end{equation*}
The vectors \(\vec{x}_{1},\dots,\vec{x}_{n}\) are linearly independent if and only if their Wronskian is nonzero.%
\end{definition}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 4.2 Constant Coefficient Systems and the Phase Plane}
\typeout{************************************************}
%
\begin{sectionptx}{Constant Coefficient Systems and the Phase Plane}{}{Constant Coefficient Systems and the Phase Plane}{}{}\label{section-constant-coefficient-systems-and-the-phase-plane}
\begin{introduction}{}%
\begin{aside}{}{aside-11}%
\hypertarget{p-325}{}%
This section corresponds to Section 4.3 of the text.%
\end{aside}
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 4.2.1 Solutions of \(\vec{x}' = A\vec{x}\)}
\typeout{************************************************}
%
\begin{subsectionptx}{Solutions of \(\vec{x}' = A\vec{x}\)}{}{Solutions of \(\vec{x}' = A\vec{x}\)}{}{}\label{subsection-solutions-of--vec-x-a-vec-x-m-}
\begin{theorem}{Solutions of Systems.}{}{theorem-solutions-of-systems}%
\hypertarget{p-326}{}%
Let \(A\) be an \(n\times n\) constant matrix, and suppose that \(A\) has \(n\) linearly independent eigenvectors \(\vec{x}_{1},\dots,\vec{x}_{n}\) with corresponding eigenvalues \(\lambda_{1},\dots,\lambda_{1}\). Then the general solution of \(\vec{x}'=A\vec{x}\) is given by%
\begin{equation*}
\vec{x} = \sum_{i=1}^{n}c_{i}e^{\lambda_{i}t}\vec{x}_{i}.
\end{equation*}
%
\end{theorem}
\begin{example}{}{example-54}%
\hypertarget{p-327}{}%
Find the general solution of the system%
\begin{align*}
x_{1}'  \amp = x_{1}-\frac{1}{2}x_{2}-\frac{1}{2}x_{3}\\
x'_{2}  \amp =  -\frac{1}{2}x_{1}+x_{2}-\frac{1}{2}x_{3}\\
x'_{3}  \amp =  -\frac{1}{2}x_{1}-\frac{1}{2}x_{2}+x_{3}
\end{align*}
given that%
\begin{equation*}
\vec{x}_{1} = \begin{bmatrix}1\\1\\1\end{bmatrix},\vec{x}_{2} = \begin{bmatrix}-1\\1\\0\end{bmatrix}\quad\text{and}\quad\vec{x}_{3} = \begin{bmatrix}-\frac{1}{2}\\-\frac{1}{2}\\1\end{bmatrix}
\end{equation*}
are eigenvectors of the matrix%
\begin{equation*}
G = \begin{bmatrix}1 \amp  -\frac{1}{2}  \amp  -\frac{1}{2}\\-\frac{1}{2}  \amp  1 \amp  -\frac{1}{2} \\ -\frac{1}{2}  \amp  -\frac{1}{2}  \amp    1\end{bmatrix}
\end{equation*}
with corresponding eigenvalues \(\lambda_{1} = 0,\lambda_{2} = \lambda_{3} = \frac{3}{2}\).%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-51}{}\quad%
\hypertarget{p-328}{}%
First, note that the system we need to solve is equivalent to the matrix ODE \(\vec{x}' = G\vec{x}\). If we can show that \(\vec{x}_{1},\vec{x}_{2},\vec{x}_{3}\) are linearly independent, then we can use \hyperref[theorem-solutions-of-systems]{Theorem~\ref{theorem-solutions-of-systems}} to find the general solution of the system. So we'll compute their Wronskian:%
\begin{align*}
W(\vec{x}_{1},\vec{x}_{2},\vec{x}_{3}) \amp = \begin{vmatrix} 1  \amp  -1  \amp  -\frac{1}{2} \\ 1 \amp  1 \amp  -\frac{1}{2} \\ 1 \amp  0 \amp  1\end{vmatrix}\\
\amp = 1+\frac{3}{2}+\frac{1}{2}\\
\amp = 3
\end{align*}
%
\par
\hypertarget{p-329}{}%
Since the Wronskian is nonzero, these eigenvectors are linearly independent. Therefore the general solution of the system is given by%
\begin{align*}
\vec{x} \amp = c_{1}e^{0t}\vec{x}_{1}+c_{2}e^{3t/2}\vec{x}_{2}+c_{3}e^{3t/2}\vec{x}_{3}\\
\amp = \begin{bmatrix}c_{1}-c_{2}e^{3t/2}-\frac{1}{2}c_{3}e^{3t/2} \\ c_{1}+c_{2}e^{3t/2}-\frac{1}{2}c_{3}e^{3t/2} \\ c_{1}+c_{3}e^{3t/2}\end{bmatrix}
\end{align*}
or just%
\begin{align*}
x_{1} \amp = c_{1}-\parens*{c_{2}-\frac{1}{2}c_{3}}e^{3t/2}\\
x_{2} \amp = c_{1}+\parens*{c_{2}-\frac{1}{2}c_{3}}e^{3t/2}\\
x_{3} \amp = c_{1}+c_{3}e^{3t/2}
\end{align*}
%
\end{example}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 4.2.2 Finding Eigenvalues and Eigenvectors}
\typeout{************************************************}
%
\begin{subsectionptx}{Finding Eigenvalues and Eigenvectors}{}{Finding Eigenvalues and Eigenvectors}{}{}\label{subsection-finding-eigenvalues-and-eigenvectors}
\hypertarget{p-330}{}%
\hyperref[theorem-solutions-of-systems]{Theorem~\ref{theorem-solutions-of-systems}} shows that solving systems of first-order ODEs comes down to finding eigenvalues and eigenvectors of the corresponding matrix ODE. So it's important for us to know how to find these.%
\par
\hypertarget{p-331}{}%
Let \(A\) be an \(n\times n\) matrix and suppose that \(\vec{v}\) is an eigenvector with corresponding eigenvalue \(\lambda\). Then%
\begin{equation*}
A\vec{v} = \lambda\vec{v}.
\end{equation*}
We can rearrange this to get%
\begin{equation*}
A\vec{v}-\lambda\vec{v} = (A-\lambda I)\vec{v} = \vec{0}
\end{equation*}
where \(I\) is the identity matrix. Since \(\vec{v}\neq\vec{0}\) (since it's an eigenvector!), linear algebra tells us that \(\det(A-\lambda I) = 0\). This gives us the following theorem.%
\begin{theorem}{}{}{theorem-theorem-eigenvalues-from-characteristic-equation}%
\hypertarget{p-332}{}%
The eigenvalues of a square matrix \(A\) are the solutions of the equation \(\det(A-\lambda I) = 0\).%
\end{theorem}
\begin{definition}{}{definition-characteristic-equation}%
\hypertarget{p-333}{}%
\(\det(A-\lambda I)=0\) is called the \terminology{characteristic equation} of the matrix \(A\).%
\end{definition}
\begin{example}{}{example-55}%
\hypertarget{p-334}{}%
Find the eigenvalues of the matrix \(A = \begin{bmatrix}1\amp 4\\1\amp 1\end{bmatrix}\).%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-52}{}\quad%
\hypertarget{p-335}{}%
First, we need to set up the characteristic equation of \(A\). Since%
\begin{equation*}
A-\lambda I = \begin{bmatrix}1-\lambda \amp  4 \\ 1 \amp  1-\lambda\end{bmatrix},
\end{equation*}
we get%
\begin{equation*}
\det(A-\lambda I) = (1-\lambda)^{2} - 4 = \lambda^{2}-2\lambda+3
\end{equation*}
so the characteristic equation of \(A\) is%
\begin{equation*}
\lambda^{2}-2\lambda+3 = 0
\end{equation*}
which has solutions \(\lambda_{1} = -1,\lambda_{2} = 3\). So the eigenvalues of \(A\) are \(-1,3\).%
\end{example}
\hypertarget{p-336}{}%
A useful fact to remember is that the eigenvalues of a ``triangular'' matrix are just the diagonal entries.%
\begin{example}{}{example-56}%
\hypertarget{p-337}{}%
Let%
\begin{equation*}
A = \begin{bmatrix}1 \amp  3 \amp  -4 \amp  5 \\ 0 \amp  3 \amp  -2 \amp  -2 \\ 0 \amp  0 \amp  1 \amp  10^{50\pi-300} \\ 0 \amp  0 \amp  0 \amp  0\end{bmatrix}.
\end{equation*}
Find the eigenvalues of \(A\).%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-53}{}\quad%
\hypertarget{p-338}{}%
\(A\) is a triangular matrix since everything below the main diagonal is \(0\). So the eigenvalues of \(A\) are \(1,3,1,0\).%
\end{example}
\begin{example}{}{example-57}%
\hypertarget{p-339}{}%
Find eigenvectors of \(A = \begin{bmatrix}1 \amp  4 \\ 1 \amp  1\end{bmatrix}\) corresponding to the eigenvalues \(\lambda_{1} = -1\) and \(\lambda_{2} = 3\).%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-54}{}\quad%
\hypertarget{p-340}{}%
Suppose that \(\vec{v} = \begin{bmatrix} v_{1} \\ v_{2} \end{bmatrix}\) is an eigenvector corresponding to \(\lambda\). Then we know that%
\begin{equation*}
\begin{bmatrix}1 \amp  4 \\ 1 \amp  1\end{bmatrix}\vec{v} = \lambda\vec{v} \Rightarrow \begin{bmatrix}v_{1}+4v_{2} \\ v_{1} + v_{2}\end{bmatrix} = \begin{bmatrix} \lambda v_{1} \\ \lambda v_{2} \end{bmatrix}.
\end{equation*}
This tells us that if \(\vec{v} = \begin{bmatrix}v_{1} \\ v_{2} \end{bmatrix}\) is an eigenvector for \(\lambda\), then its entries need to satisfy%
\begin{align}
v_{1}+4v_{2}\amp =-v_{1}\notag\\
v_{1}+v_{2} \amp = -v_{2}\notag
\end{align}
which boils down to%
\begin{align*}
(1-\lambda)v_{1}+4v_{2} \amp = 0\\
v_{1} + (1-\lambda)v_{2} \amp = 0.
\end{align*}
%
\par
\hypertarget{p-341}{}%
Now set \(\lambda = -1\) to get the system%
\begin{align*}
2v_{1} + 4v_{2} \amp = 0\\
v_{1} + 2v_{2} \amp = 0
\end{align*}
and so \(v_{1} = -2v_{2}\). We don't really care about what the entries of \(\vec{v}\) look like so long as \(\vec{v}\) is an eigenvector, so we can pick \(v_{1},v_{2}\) however we want, just so long as they satisfy this relation (and are not both \(0\)!). So pick \(v_{2} = 1\), which forces \(v_{1} = -2\). Then%
\begin{equation*}
\vec{v} = \begin{bmatrix}-2\\1\end{bmatrix}
\end{equation*}
is an eigenvector of \(A\) corresponding to the eigenvalue \(\lambda_{1} = -1\).%
\par
\hypertarget{p-342}{}%
To find an eigenvector for \(\lambda_{2} = 3\) we just set \(\lambda  = 3\) in \ref{eqn:eigenvector-relation} and run through the same process:%
\begin{align*}
-2v_{1}+4v_{2} \amp = 0\\
v_{1} - 2v_{2} \amp = 0
\end{align*}
The second equation simplifies to \(v_{1} = 2v_{2}\), so one eigenvector for \(\lambda_{2}\) is%
\begin{equation*}
\vec{v} = \begin{bmatrix}2 \\ 1\end{bmatrix}.
\end{equation*}
%
\end{example}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 4.2.3 Solving Matrix ODEs}
\typeout{************************************************}
%
\begin{subsectionptx}{Solving Matrix ODEs}{}{Solving Matrix ODEs}{}{}\label{subsection-solving-matrix-odes}
\hypertarget{p-343}{}%
We now have the tools we need to begin solving matrix ODEs. Recall that if \(A\) is an \(n\times n\) matrix with constant entries, and if \(\vec{x}_{1},\vec{x}_{2},\ldots,\vec{x}_{n}\) are \(n\) linearly independent solutions of the matrix ODE \(\vec{x}'=A\vec{x}\), then the general solution of the matrix ODE is%
\begin{equation*}
\vec{x} = \sum_{k=1}^{n}c_{k}\vec{x}_{k}.
\end{equation*}
Furthermore, if \(\lambda\) is an eigenvalue of \(A\) with eigenvector \(\vec{v}\), then \(e^{\lambda t}\vec{v}\) is a solution of \(\vec{x}'=A\vec{x}\). So to solve the matrix ODE \(\vec{x}'=A\vec{x}\) requires finding enough eigenvectors and eigenvalues. A useful theorem is the following:%
\begin{theorem}{}{}{theorem-linear-independence-distinct-eigenvalues}%
\hypertarget{p-344}{}%
Let \(A\) be an \(n\times n\) matrix with constant entries. If the eigenvalues \(\lambda_{1},\ldots,\lambda_{n}\) of \(A\) are distinct (that is, none are repeated) then eigenvectors associated with different eigenvalues are linearly independent. That is, if \(\vec{v}_{i}\) is an eigenvector corresponding to \(\lambda_{i}\) then the eigenvectors \(\vec{v}_{1},\ldots,\vec{v}_{n}\) are linearly independent.%
\end{theorem}
\begin{example}{}{example-58}%
\hypertarget{p-345}{}%
Solve the matrix ODE given by \(\vec{x}' = A\vec{x}\) where%
\begin{equation*}
A = \begin{bmatrix}1\amp 4\\1\amp 1\end{bmatrix}.
\end{equation*}
%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-55}{}\quad%
\hypertarget{p-346}{}%
We already have everything we need. We know that the eigenvalues of \(A\) are \(\lambda_{1}=-1\) and \(\lambda_{2}=3\) and some corresponding eigenvectors are%
\begin{equation*}
\vec{v}_{1} = \begin{bmatrix}-2\\1\end{bmatrix}\qq{and} \vec{v}_{2} = \begin{bmatrix}2\\1\end{bmatrix}.
\end{equation*}
Since the eigenvalues are distinct it follows that these eigenvectors are linearly independent (we could also check this using the Wronskian). We can therefore build two linearly independent solutions to the matrix ODE:%
\begin{equation*}
\vec{x}_{1} = e^{\lambda_{1}t}\vec{v}_{1} = e^{-t}\begin{bmatrix}-2\\1\end{bmatrix}\qq{and} \vec{x}_{2} = e^{\lambda_{2}t}\vec{v}_{2} = e^{3t}\begin{bmatrix}2\\1\end{bmatrix}
\end{equation*}
So the general solution of the matrix ODE is%
\begin{equation*}
\vec{x} = c_{1}\vec{x}_{1} + c_{2}\vec{x}_{2} = c_{1}e^{-t}\begin{bmatrix}-2\\1\end{bmatrix} + c_{2}e^{3t}\begin{bmatrix}2\\1\end{bmatrix}.
\end{equation*}
Note that the choice of eigenvector \emph{doesn't matter}. Just so long as we find some particular eigenvector for each distinct eigenvalue.%
\end{example}
\begin{example}{}{example-59}%
\hypertarget{p-347}{}%
Solve the first-order system given by%
\begin{align*}
x_{1}' \amp = x_{1} - 5x_{2}\\
x_{2}' \amp = x_{1} - x_{2}
\end{align*}
where \(x_{1}\) and \(x_{2}\) are functions of \(t\).%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-56}{}\quad%
\hypertarget{p-348}{}%
First, note that this system is equivalent to the matrix ODE \(\vec{x}' = A\vec{x}\) where%
\begin{equation*}
\vec{x} = \begin{bmatrix}x_{1} \\ x_{2}\end{bmatrix}\qq{and} A = \begin{bmatrix}1 \amp  -5 \\ 1 \amp  -1\end{bmatrix}.
\end{equation*}
To solve this system we need to find the eigenvalues and eigenvectors of \(A\), and then use these to build our general solution. \leavevmode%
\begin{enumerate}
\item\hypertarget{li-20}{}\hypertarget{p-349}{}%
Find the eigenvalues.%
\par
\hypertarget{p-350}{}%
We find the eigenvalues of \(A\) by solving the characteristic equation \(\det(A - \lambda I) = 0\) for \(\lambda\). Since \(\det(A - \lambda I) = \lambda^{2}+4\), we see that the eigenvalues of \(A\) are \(\lambda_{1} = -2i\) and \(\lambda_{2} = 2i\). The fact that these eigenvalues are complex is \emph{not} a problem. They're still distinct, so our method will work.%
\item\hypertarget{li-21}{}\hypertarget{p-351}{}%
Find corresponding eigenvectors.%
\par
\hypertarget{p-352}{}%
Set \(\vec{v} = \begin{bmatrix}v_{1} \\ v_{2}\end{bmatrix}\). Then \(A\vec{v} = \lambda\vec{v}\) implies that%
\begin{align*}
v_{1} - 5v_{2}  \amp =  \lambda v_{1}\\
v_{1} -v_{2}  \amp =  \lambda v_{2}
\end{align*}
or just%
\begin{align*}
(1-\lambda)v_{1} - 5v_{2} \amp =0\\
v_{1} - (1+\lambda)v_{2} \amp = 0.
\end{align*}
Setting \(\lambda=-2i\) in the second equation gives \(v_{1} = (1-2i)v_{2}\), so an eigenvector of \(A\) corresponding to \(\lambda_{1} = -2i\) is%
\begin{equation*}
\vec{v} = \begin{bmatrix}1-2i \\ 1\end{bmatrix}.
\end{equation*}
Similarly, an eigenvector corresponding to \(\lambda_{2}=2i\) is%
\begin{equation*}
\vec{v}_{2} = \begin{bmatrix}1+2i\\1\end{bmatrix}.
\end{equation*}
%
\item\hypertarget{li-22}{}\hypertarget{p-353}{}%
Find the general solution.%
\par
\hypertarget{p-354}{}%
At this step it is easy to construct the solution of the matrix ODE. It's just%
\begin{equation*}
\vec{x} = c_{1}e^{\lambda_{1}t}\vec{v}_{1} + c_{2}e^{\lambda_{2}t}\vec{v}_{2} = \begin{bmatrix}c_{1}e^{-2it}(1-2i)+c_{2}e^{2it}(1+2i) \\ c_{1}e^{-2it}+c_{2}e^{2it}\end{bmatrix}.
\end{equation*}
%
\end{enumerate}
%
\end{example}
\begin{example}{}{example-60}%
\hypertarget{p-355}{}%
Solve the first-order system%
\begin{align*}
\dv{x_{1}}{t} \amp = 3x_{1}+x_{3}\\
\dv{x_{2}}{t} \amp = 9x_{1}-x_{2}+2x_{3}\\
\dv{x_{3}}{t} \amp = -9x_{1} + 4x_{2} - x_{3}
\end{align*}
%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-57}{}\quad%
\hypertarget{p-356}{}%
As long as this system has distinct eigenvalues the above method will work. Once again we rewrite the system as a matrix ODE; in this case, the matrix ODE we must solve is%
\begin{equation*}
\vec{x}' = \begin{bmatrix}3 \amp  0 \amp  1 \\ 9 \amp  -1 \amp  2 \\ -9 \amp  4 \amp  -1\end{bmatrix}\vec{x} = A\vec{x}.
\end{equation*}
%
\par
\hypertarget{p-357}{}%
To find the eigenvalues we must solve the characteristic equation \(\det(A-\lambda I)=0\). However, we can also use Sage (see code cell after this example). This produces a list containing the eigenvalues of \(A\) as well as the corresponding eigenvectors. So we see that the eigenvalues are given by%
\begin{equation*}
\lambda_{1} = 3, \quad\lambda_{2} = -1 - i\quad\text{and}\quad\lambda_{3} = -1 + i,
\end{equation*}
while the corresponding eigenvectors are given by%
\begin{equation*}
\vec{v}_{1} = \begin{bmatrix}1 \\ \frac{9}{4} \\ 0\end{bmatrix}, \quad\vec{v}_{2} = \begin{bmatrix} 1 \\ 2 + i \\ -4 - i \end{bmatrix}\quad\text{and}\vec{v}_{3} = \begin{bmatrix} 1 \\ 2 - i \\ -4 + i \end{bmatrix}
\end{equation*}
%
\par
\hypertarget{p-358}{}%
We now have everything we need for the general solution of the matrix ODE. It's just%
\begin{equation*}
\vec{x} = c_{1}e^{3t}\begin{bmatrix}1 \\ \frac{9}{4} \\ 0\end{bmatrix} + c_{2}e^{(-1 - i)t}\begin{bmatrix} 1 \\ 2 + i \\ -4 - i \end{bmatrix} + c_{3}e^{(-1 + i)t}\begin{bmatrix} 1 \\ 2 - i \\ -4 + i \end{bmatrix}.
\end{equation*}
%
\end{example}
\begin{sageinput}
# Define our matrix
M = matrix([ [3, 0, 1],
             [9, -1, 2],
             [-9, 4, -1]] )

# Finds eigenvectors, corresponding eigenvalues and "algebraic multiplicty".
pretty_print(M.eigenvectors_right())
\end{sageinput}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 4.2.4 Applications of Matrix ODEs}
\typeout{************************************************}
%
\begin{subsectionptx}{Applications of Matrix ODEs}{}{Applications of Matrix ODEs}{}{}\label{subsection-applications-of-matrix-odes}
\hypertarget{p-359}{}%
Now we use matrix ODEs to model physical systems. The methods we've developed for solving matrix ODEs will then let us come up with descriptions for such systems. Recall that we introduced systems of ODEs (and then matrix ODEs) to model quantities that depended on time (an independent variable) and each other (dependent variables). The physical systems we will consider will be ones where the quantities of interest depend on each other in some way.%
\begin{example}{}{example-61}%
\hypertarget{p-360}{}%
Two brine tanks are set up as in \hyperref[figure-interconnected-tanks]{Figure~\ref{figure-interconnected-tanks}}. Fresh water flows into the tank at a rate of \(r_{1}\), well-mixed solution flows from Tank 1 to Tank 2 at a rate of \(r_{2}\) and well-mixed solution flows out of Tank 2 at a rate of \(r_{3}\). Suppose that \(r_{1}, r_{2}\) and  \(r_{3}\) are \SI{5}{\gallon\per\minute}, the volume of solution in Tank 1 is \SI{10}{\gallon} and the volume of solution in Tank 2 is \SI{7}{\gallon}. Suppose Tank 1 has \SI{5}{\pound} of salt at time \(t=0\) and Tank 2 has \SI{2}{\pound} of salt at time \(t=0\). How much salt is in each tank at time \(t\)?%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-58}{}\quad%
\hypertarget{p-361}{}%
To start, let \(x_{1}(t)\) denote the amount of salt in Tank 1 at time \(t\) and \(x_{2}(t)\) denote the amount of salt in Tank 2 at time \(t\), where \(t\) is in minutes. Then from Section 4.1, we know that%
\begin{align*}
x'_{1} \amp = -\frac{1}{2}x_{1}\\
x'_{2} \amp = \frac{1}{2}x_{1}-\frac{5}{7}x_{2}
\end{align*}
If we set%
\begin{equation*}
\vec{x} = \begin{bmatrix} x_{1} \\ x_{2} \end{bmatrix} \qq{and} A = \begin{bmatrix}-\frac{1}{2} \amp  0 \\ \frac{1}{2} \amp  -\frac{5}{7}\end{bmatrix}
\end{equation*}
then this system is equivalent to the matrix ODE \(\vec{x}' = A\vec{x}\). To solve this, we find the eigenvalues and corresponding eigenvectors. To find the eigenvalues, we could solve the characteristic equation \(\det(A-\lambda I) = 0\) or use Maple, but it's easier to note that \(A\) is a triangular matrix. So the eigenvalues are just \(\lambda_{1} = -\frac{1}{2},\lambda_{2} = -\frac{5}{7}\).%
\par
\hypertarget{p-362}{}%
Now we find eigenvectors. So let%
\begin{equation*}
\vec{v} = \begin{bmatrix}v_{1} \\ v_{2}\end{bmatrix}.
\end{equation*}
If \(\vec{v}\) is an eigenvector for \(\lambda\), then we know \(A\vec{v} = \lambda\vec{v}\), which gives the system%
\begin{align*}
(-\frac{1}{2}-\lambda)v_{1} \amp = 0\\
\frac{1}{2}v_{1} + (-\frac{5}{7}-\lambda)v_{2} \amp = 0
\end{align*}
If we set \(\lambda=-\frac{1}{2}\), then we just get \(v_{1} = \frac{3}{14}v_{2}\). So an eigenvector corresponding to \(\lambda_{1} = -\frac{1}{2}\) is%
\begin{equation*}
\vec{v}_{1} = \begin{bmatrix}3\\14\end{bmatrix}.
\end{equation*}
%
\par
\hypertarget{p-363}{}%
Similarly, if we set \(\lambda=-\frac{5}{7}\) we get \(v_{1} = 0\), but no restrictions on \(v_{2}\). So an eigenvector corresponding to \(\lambda_{2} = -\frac{5}{7}\) is%
\begin{equation*}
\vec{v}_{2} = \begin{bmatrix}0\\1\end{bmatrix}.
\end{equation*}
%
\par
\hypertarget{p-364}{}%
The general solution of our matrix ODE is then%
\begin{equation*}
\vec{x} = c_{1}e^{-\frac{5t}{7}}\begin{bmatrix}0\\1\end{bmatrix} + c_{2}e^{-\frac{t}{2}}\begin{bmatrix}3\\14\end{bmatrix} = \begin{bmatrix}3c_{2}e^{-\frac{t}{2}} \\ c_{1}e^{-\frac{5t}{7}}+14c_{2}e^{-\frac{t}{2}}\end{bmatrix}
\end{equation*}
%
\par
\hypertarget{p-365}{}%
But we're not done yet, since we have the initial conditions \(x_{1}(0) = 5\) and \(x_{2}(0) = 2\), or in terms of our matrix ODE%
\begin{equation*}
\vec{x}(0) = \begin{bmatrix}5\\2\end{bmatrix}.
\end{equation*}
We can use this to find \(c_{1}\) and \(c_{2}\). If we set \(t=0\), then we get%
\begin{equation*}
\begin{bmatrix}3c_{2} \\ c_{1} + 14c_{2}\end{bmatrix} = \begin{bmatrix}5\\2\end{bmatrix}
\end{equation*}
so \(c_{2} = \frac{5}{3}\) and \(c_{1} = 2 - 14\frac{5}{3} = -\frac{64}{3}\).%
\par
\hypertarget{p-366}{}%
So the solution of the matrix ODE (and hence the original system) is%
\begin{equation*}
\vec{x} = \begin{bmatrix}5e^{-\frac{t}{2}} \\ -\frac{64}{3}e^{-\frac{5t}{7}}+\frac{70}{3}e^{-\frac{t}{2}}\end{bmatrix}
\end{equation*}
The amount of salt in the first tank, \(x_{1}\), is given by the top entry and the amount of salt in the second tank, \(x_{2}\), is given by the bottom entry.%
\end{example}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 4.2.5 The Phase Plane}
\typeout{************************************************}
%
\begin{subsectionptx}{The Phase Plane}{}{The Phase Plane}{}{}\label{subsection-the-phase-plane}
\hypertarget{p-367}{}%
Just as we were able to plot direction fields for first-order ODEs, we can do something similar for first-order systems with two equations. Consider the first-order system%
\begin{align}
y'_{1}  \amp =  a_{11}y_{1} + a_{12}y_{2}\notag\\
y'_{2}  \amp =  a_{21}y_{1}+  a_{22}y_{2}\notag
\end{align}
or%
\begin{equation*}
\vec{y}' = A\vec{y}\quad\text{where}\quad A = \begin{bmatrix}a_{11}  \amp  a_{12}  \\  a_{21}  \amp  a_{22}\end{bmatrix}.
\end{equation*}
%
\par
\hypertarget{p-368}{}%
The solution of this looks like \(\vec{y}(t) = \begin{bmatrix}y_{1}(t) \\ y_{2}(t)\end{bmatrix}\). As \(t\) varies, \(\vec{y}(t)\) will trace out a curve in the \(y_{1}y_{2}\)-plane, which we call the \terminology{trajectory}. The \(y_{1}y_{2}\)-plane is called the \terminology{phase plane}, and the collection of all trajectories of the system \hyperref[equation-2-by-2-system]{Display Mathematics~\ref{equation-2-by-2-system}} is called the \terminology{phase portrait}. The phase portrait of a system provides us with a way to study the behavior of solutions of \hyperref[equation-2-by-2-system]{Display Mathematics~\ref{equation-2-by-2-system}} without actually solving the system.%
\begin{example}{}{example-sketch-phase-portrait}%
\hypertarget{p-369}{}%
Sketch a phase portrait for the system%
\begin{align*}
\dv{y_{1}}{t}  \amp =  2y_{1} - 3y_{2}\\
\dv{y_{2}}{t}  \amp =  -2y_{1} + y_{2}.
\end{align*}
%
\par\smallskip%
\noindent\textbf{Solution}.\hypertarget{solution-59}{}\quad%
\hypertarget{p-370}{}%
First, note that we can rewrite the system as \(\vec{y}' = A\vec{y}\) using%
\begin{equation*}
\vec{y} = \begin{bmatrix}y_{1}\\y_{2}\end{bmatrix}\quad\text{and}\quad A = \begin{bmatrix}2 \amp  -3 \\-2 \amp  1\end{bmatrix}.
\end{equation*}
Now, we can view \(\vec{y}\) as corresponding to a point in the phase plane. Hence \(\vec{y}'\) corresponds to a \emph{tangent} at the point \(\vec{y}\). For example, let's find the tangent at the point \(\vec{y} = \begin{bmatrix}2\\2\end{bmatrix}\):%
\begin{equation*}
\vec{y}' = A\vec{y} = \begin{bmatrix}2 \amp  -3 \\ -2 \amp  1\end{bmatrix}\begin{bmatrix}2\\2\end{bmatrix} = \begin{bmatrix}-2 \\ -2\end{bmatrix}.
\end{equation*}
%
\par
\hypertarget{p-371}{}%
So at the point \((2,2)\) in the phase plane, the trajectory should be heading in the direction of the point \((-2,-2)\) from the origin. Similarly, if we let \(\vec{y} = \begin{bmatrix}0\\1\end{bmatrix}\) then we get%
\begin{equation*}
\vec{y}' = A\vec{y} = \begin{bmatrix}2 \amp  -3 \\ -2 \amp  1\end{bmatrix}\begin{bmatrix}0\\1\end{bmatrix} = \begin{bmatrix}-3 \\ 1\end{bmatrix}.
\end{equation*}
So the trajectory going through \((0,1)\) in the phase plane should be heading in the direction of \((-3,1)\) viewed from the origin.%
\par
\hypertarget{p-372}{}%
Plotting other points in the phase plane like this, we get \hyperref[figure-sketch-phase-portrait]{Figure~\ref{figure-sketch-phase-portrait}}. One thing we can see from this is that trajectories that lie on the line, equivalently, those with initial conditions \(y_{1}(0) = y_{2}(0)\), appear to approach the origin while all others move away from the origin. We can see why this is by looking at the general solution of the original system, which is%
\begin{equation*}
\vec{y} = c_{1}e^{4t}\begin{bmatrix}-3\\2\end{bmatrix}+c_{2}e^{-t}\begin{bmatrix}1\\1\end{bmatrix}.
\end{equation*}
%
\par
\hypertarget{p-373}{}%
If \(\vec{y}\) lies on the line \(y_{2} = y_{1}\), then \(c_{1}\) has to equal \(0\), which follows from the fact that \(\begin{bmatrix}-3\\2\end{bmatrix}\) and \(\begin{bmatrix}1\\1\end{bmatrix}\) are linearly independent. So trajectories that lie on the line \(y_{2} = y_{1}\) must take the form \(\vec{y} = c_{2}e^{-t}\begin{bmatrix}1\\1\end{bmatrix}\), and every solution of this form goes to \(\vec{0}\) as \(t\to\infty\). \emph{Every other trajectory} will move away from the origin as \(t\to\infty\), although the trajectories that lie on the line \(y_{2} = -\frac{2}{3}y_{1}\) will travel to the origin as \(t\to-\infty\) (i.e. ``backwards in time''):%
\end{example}
\begin{figure}
\centering
\includegraphics[width=1\linewidth]{images/image-15.pdf}
\caption{The phase portrait from \hyperref[example-sketch-phase-portrait]{Example~\ref{example-sketch-phase-portrait}}.\label{figure-sketch-phase-portrait}}
\end{figure}
\hypertarget{p-374}{}%
Note that \(\vec{y}=\vec{0}\) is \emph{always} a solution of \(\vec{y}'=A\vec{y}\). This is because \(\vec{0}'=A\vec{0} = \vec{0}\). We call \(\vec{y} = \vec{0}\) the \terminology{equilibrium solution} or \terminology{critical point} of the system \(\vec{y}'=A\vec{y}\). In the next section, we will be concerned with the behavior of trajectories of the system \(\vec{y}'=A\vec{y}\) near the equilibrium solution. One thing we will see is that the behavior is determined in large part by the eigenvalues of the matrix \(A\).%
\end{subsectionptx}
\end{sectionptx}
\end{chapterptx}
%
%
\typeout{************************************************}
\typeout{Chapter 5 Fourier Analysis}
\typeout{************************************************}
%
\begin{chapterptx}{Fourier Analysis}{}{Fourier Analysis}{}{}\label{fourier-analysis}
\begin{introduction}{}%
\hypertarget{p-375}{}%
Our goal now is to move to solving \emph{partial} differential equations (PDEs), which are differential equations that involve multiple independent variables. Such equations are particularly useful for modeling quantities that depend on position \(x\) and time \(t\). It turns out that these partial differential equations often involve periodic functions. So our first step to solving PDEs will be to find useful descriptions of periodic (and in some cases, non-periodic) functions.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Section 5.1 Fourier Series}
\typeout{************************************************}
%
\begin{sectionptx}{Fourier Series}{}{Fourier Series}{}{}\label{section-fourier-series}
\begin{introduction}{}%
\hypertarget{p-376}{}%
The main idea behind Fourier series, and the field of harmonic analysis in general, is to represent more complicated objects in terms of simpler objects. A fundamental example of this idea comes from the field of linear algebra in the form of \emph{orthonormal bases}. Knowing an orthonormal basis for a vector space \(V\) can greatly simplify linear algebra in that vector space. In this section, we'll do something similar with periodic functions.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 5.1.1 Periodic Functions}
\typeout{************************************************}
%
\begin{subsectionptx}{Periodic Functions}{}{Periodic Functions}{}{}\label{subsection-periodic-functions}
\hypertarget{p-377}{}%
Consider the function \(f(x)\) given by the following graph:%
\begin{figure}
\centering
\IfFileExists{images/image-sageplot-periodic-function.pdf}%
{\includegraphics[width=1\linewidth]{images/image-sageplot-periodic-function.pdf}}%
{\includegraphics[width=1\linewidth]{images/image-sageplot-periodic-function.png}}
\caption{A periodic function.\label{figure-sageplot-periodic-function}}
\end{figure}
\hypertarget{p-378}{}%
This function can be plotted using the following code:%
\begin{sageinput}
reset

import matplotlib.pyplot as plt
import numpy as np

# The following is here to adjust text on the graph... not a huge deal.
from matplotlib import rc
rc('font',**{'family':'sans-serif','sans-serif':['Helvetica']})
rc('text', usetex=True)

# This is setting up our graph.
x = np.linspace(-3*np.pi,3*np.pi,200)
y1 = np.cos(5*x)
y2 = np.sin(3*x)

# This actually plots the graph.
p = plt.plot(x,y1-5*y2,label=r'$f(x)$')
plt.legend()
plt.show()
\end{sageinput}
\hypertarget{p-379}{}%
If we look at the graph, we see that it repeats itself if we wait long enough. Functions that have this property are called \terminology{periodic functions}.%
\begin{definition}{Periodic Functions.}{definition-periodic-functions}%
\index{Functions!periodic}\hypertarget{p-380}{}%
Let \(f(x)\) be a real function defined for all \(x\). We say that \(f\) is a periodic function if there exists a positive number \(p\) such that%
\begin{equation*}
f(x+p) = f(x)
\end{equation*}
for all \(x\).%
\end{definition}
 \hypertarget{p-381}{}%
Let \(n\) be any integer. Then the functions \(\sin nx\) and \(\cos nx\) are both periodic and have period \(2\pi\) since%
\begin{align*}
\sin[n(x+2\pi)] & = \sin nx\cos2\pi + \cos nx\sin2\pi = \sin nx \\
\cos[n(x+2\pi)] & = \cos nx\cos2\pi - \sin nx\sin2\pi = \cos nx 
\end{align*}
The periodic nature of these functions can also be seen from their graphs:%
 \begin{sageinput}
# This is setting up our graph.
x = np.linspace(-3*np.pi,3*np.pi,200)
y1 = np.cos(5*x)
y2 = np.sin(2*x)

# This actually plots the graphs.
plt.subplot(2,1,1)
plt.plot(x,y1,label=r'$\cos5x$')
plt.legend()

plt.subplot(2,1,2)
plt.plot(x,y2,label=r'$\sin2x$')
plt.legend()
plt.show()
\end{sageinput}
\hypertarget{p-382}{}%
If you go back to the first plot, you may notice from the code used to generate the function \(f(x)\) that \(f(x)\) is just the sum of two basic trigonometric functions:%
\begin{equation*}
f(x) = \cos5x-5\sin3x.
\end{equation*}
In other words, the (finite) sum of functions of the form \(\sin nx,\cos mx\) where \(n,m\) are integers is also periodic, and also has period \(2\pi\). One of the greatest accomplishments in mathematics was the realization that many other periodic functions can be written in this way if we allow \emph{infinite} sums of this form, which we call \terminology{trigonometric series}.%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 5.1.2 Trigonometric Series and Fourier Series}
\typeout{************************************************}
%
\begin{subsectionptx}{Trigonometric Series and Fourier Series}{}{Trigonometric Series and Fourier Series}{}{}\label{subsection-trig-and-fourier-series}
\begin{definition}{Trigonometric Series.}{definition-trigonometric-series}%
\index{Series!trigonometric}\hypertarget{p-383}{}%
A trigonometric series is a series of the form%
\begin{equation*}
\sum_{k=0}^{\infty}(a_{k}\cos kx+b_{k}\sin kx) = a_{0} + \sum_{k=1}^{\infty}(a_{k}\cos kx+b_{k}\sin kx)
\end{equation*}
where \(a_{k},b_{k}\) are constants, called the \terminology{coefficients} of the series.%
\end{definition}
\hypertarget{p-384}{}%
Our primary goal in this section is to take a function \(f(x)\) of period \(2\pi\) and express it as a trigonometric series. To see how, we'll suppose that we have the trigonometric series we want, i.e. that%
\begin{equation*}
f(x) = a_{0} + \sum_{k=1}^{\infty}(a_{k}\cos kx+b_{k}\sin kx),
\end{equation*}
and we'll look at what the coefficients of the series need to be to make this equation true. To do this, we'll need the so-called \terminology{orthogonality relations} for \(\sin nx,\cos mx\)%
\begin{theorem}{Orthogonality Relations.}{}{theorem-orthogonality-relations}%
\index{Orthogonality relations}\hypertarget{p-385}{}%
Let \(m,n\) be whole numbers with \(m,n>0\). Then%
\begin{equation*}
\int_{-\pi}^{\pi}\sin mx\cos nx\,dx = 0
\end{equation*}
and%
\begin{equation*}
\int_{-\pi}^{\pi}\sin mx\sin nx\,dx = \begin{cases} \pi & m=n \\ 0 & m\neq n\end{cases}\text{ and }\int_{-\pi}^{\pi}\cos mx\cos nx\,dx = \begin{cases} \pi & m=n \\ 0 & m\neq n\end{cases}
\end{equation*}
%
\end{theorem}
\hypertarget{p-386}{}%
We can verify Theorem \hyperref[theorem-orthogonality-relations]{Theorem~\ref{theorem-orthogonality-relations}} using a computer algebra system. Proving it is a little bit more work, but can be done using trigonometric identities or Euler's formula.%
\begin{sageinput}
# Declare variables.
var('x,m,n')
assume(m,n,'integer')

# Perform the integrations.
I1 = integral(sin(m*x)*cos(n*x),x,-pi,pi)
I2 = integral(sin(m*x)*sin(n*x),x,-pi,pi)
I3 = integral(cos(m*x)*cos(n*x),x,-pi,pi)
I4 = integral(sin(m*x)*sin(m*x),x,-pi,pi)
I5 = integral(cos(n*x)*cos(n*x),x,-pi,pi)

# List the results.
I1,I2,I3,I4,I5
\end{sageinput}
\hypertarget{p-387}{}%
Theorem \hyperref[theorem-orthogonality-relations]{Theorem~\ref{theorem-orthogonality-relations}} will be our primary tool for expressing a function \(f(x)\) as a trigonometric series. To see how, suppose that we have%
\begin{equation*}
f(x) = a_{0} + \sum_{k=1}^{\infty}(a_{k}\cos kx+b_{k}\sin kx).
\end{equation*}
If this equation were true, then we should be able to integrate both sides of it and get another true equation. Since Theorem \hyperref[theorem-orthogonality-relations]{Theorem~\ref{theorem-orthogonality-relations}} suggests that integrals involving \(\sin nx,\cos nx\) simplify very nicely, we'll try to integrate both sides of the equation against \(\sin nx,\cos nx\) from \(x=-\pi\) to \(x=\pi\) for some \(n>0\). If we do this, we get%
\begin{align*}
\int_{-\pi}^{\pi}f(x)\sin nx\,dx & = a_{0}\int_{-\pi}^{\pi}\sin nx\,dx + \sum_{k=1}^{\infty}\left(a_{k}\int_{-\pi}^{\pi}\cos kx\sin nx\,dx + b_{k}\int_{-\pi}^{\pi}\sin kx\sin nx\,dx\right)\\
& = b_{n}\int_{-\pi}^{\pi}\sin nx \sin nx \,dx\\
& = \pi b_{n}
\end{align*}
This lets us solve for \(b_{n}\)! We have%
\begin{equation*}
b_{n} = \frac{1}{\pi}\int_{-\pi}^{\pi}f(x)\sin nx\,dx\text{ for $n\geq 1$.}
\end{equation*}
Similarly,%
\begin{align*}
a_{n} & = \frac{1}{\pi}\int_{-\pi}^{\pi}f(x)\cos nx\,dx\text{ for $n\geq1$.}\\
a_{0} & = \frac{1}{2\pi}\int_{-\pi}^{\pi}f(x)\,dx
\end{align*}
These formulas are useful enough that we'll place them together in a theorem.%
\begin{theorem}{Fourier Series Coefficients.}{}{theorem-fourier-series-coefficients}%
\index{Fourier series!Coefficients}\hypertarget{p-388}{}%
Let \(f(x)\) be a periodic function with period \(2\pi\). Then the Fourier coefficients of \(f(x)\) are given by%
\begin{align*}
a_{0} &= \frac{1}{2\pi}\int_{-\pi}^{\pi}f(x)\,dx\\
a_{n} & = \frac{1}{\pi}\int_{-\pi}^{\pi}f(x)\cos nx\,dx\text{ for $n\geq1$.}\\
b_{n} &= \frac{1}{\pi}\int_{-\pi}^{\pi}f(x)\sin nx\,dx\text{ for $n\geq 1$.}
\end{align*}
%
\end{theorem}
\begin{example}{The Fourier series of \(x^{3}\).}{example-fourier-series-of-x-cubed}%
\hypertarget{p-389}{}%
Define \(f(x) = x^{3}\) for \(-\pi\leq x\leq \pi\). To find its Fourier series, we can just use the previous formulas to find the values of the coefficients \(a_{0},a_{k},b_{k}\) for \(k\geq1\). We know that%
\begin{align*}
a_{0} & = \frac{1}{2\pi}\int_{-\pi}^{\pi}x^{3}\,dx\\
a_{k} & = \frac{1}{\pi}\int_{-\pi}^{\pi}x^{3}\cos kx\,dx \\
b_{k} & = \frac{1}{\pi}\int_{-\pi}^{\pi}x^{3}\sin kx\,dx.
\end{align*}
As nasty as these are, the first two are actually very easy to compute. Here's why: \(x^{3}\) and \(x^{3}\cos kx\) are both \emph{odd} functions, and the integral of any odd function in an interval that is symmetric about \(0\) is always \(0\) (since the areas cancel out). So \(a_{0} = a_{k} = 0\) for all \(k\geq0\). The last term is a bit more complicated, but we can use integration by parts (and I definitely recommend using a computer here) to show that%
\begin{equation*}
\int x^{3}\sin kx\,dx = -\frac{{\left(k^{3} x^{3} - 6 \, k x\right)} \cos\left(k x\right) - 3 \, {\left(k^{2} x^{2} - 2\right)} \sin\left(k x\right)}{k^{4}} + C.
\end{equation*}
If we plug in the limits of integration and simplify (again, computers are handy for this!), we get%
\begin{equation*}
b_{k} = \frac{2 \, {\left(6 \, \pi - \pi^{3} k^{2}\right)} \left(-1\right)^{k}}{\pi k^{3}}.
\end{equation*}
So the Fourier series for \(f(x) = x^{3}\) is given by%
\begin{align*}
a_{0} + \sum_{k=1}^{\infty}(a_{k}\cos kx+b_{k}\sin kx) &= \sum_{k=1}^{\infty}b_{k}\sin kx \\
&= \sum_{k=1}^{\infty}\frac{2 \, {\left(6 \, \pi - \pi^{3} k^{2}\right)} \left(-1\right)^{k}}{\pi k^{3}}\sin kx. 
\end{align*}
%
\end{example}
\hypertarget{p-390}{}%
A very good question at this point is, what relationship does the Fourier series that we found in the previous example have with the original function \(f(x)\)? Are they actually equal? If we use the following code (adapted from \href{https://doxdrum.wordpress.com/2011/01/31/sage-tip-fourier-series-approximation/}{here}) to compare the partial sums%
\begin{equation*}
\sum_{k=1}^{n}\frac{2 \, {\left(6 \, \pi - \pi^{3} k^{2}\right)} \left(-1\right)^{k}}{\pi k^{3}}\sin kx
\end{equation*}
of the Fourier series with \(f(x) = x^{3}\), then it looks like the partial sums get closer and closer if we choose larger values of \(n\).%
\begin{sageinput}
var('x,k,i')

# Defines the function to determine Fourier series of. Feel free to play around with this.
f(x) = x**3

# Defines the Fourier coefficients.
def a(k):
coeff = integral(f(x)*cos(k*x), (x,-pi,pi))/pi
return coeff

def b(k):
coeff = integral(f(x)*sin(k*x), (x,-pi,pi))/pi
return coeff

# Defines the corresponding (partial) Fourier series.
def FS(k): 
return a(0)/2 + sum(a(i)*cos(i*x) + b(i)*sin(i*x), i, 1, k)

n = 3
p = plot(FS(n),(x,-pi,pi), color='red') + plot(f(x),(x,-pi,pi))
p
\end{sageinput}
\hypertarget{p-391}{}%
In general, the question of whether or not a given Fourier series makes sense is a difficult one to answer.\footnote{In fact, the convergence of Fourier series for what one might consider to be the more "well-behaved" functions in mathematics was an open question until the 1960s. See \href{https://en.wikipedia.org/wiki/Carleson\%27s_theorem}{Carleson's Theorem}.\label{footnote-convergence-of-fourier-series}} However, for many of the functions we care about in this course we have the following theorem.%
\begin{theorem}{Fourier Series of Piecewise Continuous Functions.}{}{theorem-pointwise-convergence-of-fourier-series}%
\index{Fourier series!convergence}\hypertarget{p-392}{}%
Let \(f(x)\) be a piecewise continuous function on the interval \(-\pi\leq x\leq\pi\), and suppose that it's also periodic with period \(2\pi\), and is differentiable everywhere that it's continuous. Then the Fourier series of \(f(x)\) converges to \(f(x)\) except at the points where \(f(x)\) is continuous.%
\end{theorem}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 5.2 Functions of Arbitrary Period; Even and Odd Extensions}
\typeout{************************************************}
%
\begin{sectionptx}{Functions of Arbitrary Period; Even and Odd Extensions}{}{Functions of Arbitrary Period; Even and Odd Extensions}{}{}\label{section-functions-of-arbitrary-period-even-and-odd-extensions}
\begin{introduction}{}%
\hypertarget{p-393}{}%
Now that we know how to find Fourier series of periodic functions with period \(2\pi\), we'd like to extend this idea to more general periodic functions, and then eventually to find Fourier series to represent (in some way) functions that aren't periodic.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 5.2.1 Fourier Series of Functions of Arbitrary Period}
\typeout{************************************************}
%
\begin{subsectionptx}{Fourier Series of Functions of Arbitrary Period}{}{Fourier Series of Functions of Arbitrary Period}{}{}\label{subsection-fourier-series-of-functions-of-arbitrary-period}
\hypertarget{p-394}{}%
We know how to find the Fourier series of a function of period \(2\pi\) by using Theorem \hyperref[theorem-fourier-series-coefficients]{Theorem~\ref{theorem-fourier-series-coefficients}}. So we'd like to adapt this to functions that have period \(p = 2L\) instead of \(2\pi\). This actually won't be too hard to do, since any function of period \(2L\) can be scaled into a function with period \(2\pi\).%
\par
\hypertarget{p-395}{}%
To see how, let \(f(x)\) denote a function of period \(2L\). Then we want to find a constant \(c\) so that \(f(cx)\) has period \(2\pi\), that is, so that%
\begin{equation*}
f(c(x+2\pi)) = f(cx).
\end{equation*}
For this to be true, we need \(2\pi c = 2L\), or in other words \(c = \frac{L}{\pi}\). So if \(f(x)\) has period \(2L,\) then \(f(\frac{L}{\pi}x)\) has period \(2\pi\), and furthermore \(f(\frac{L}{\pi}x)\) has Fourier coefficients given by%
\begin{align*}
a_{0} &= \frac{1}{2\pi}\int_{-\pi}^{\pi}f\left(\frac{L}{\pi}x\right)\,dx\\
a_{k} &= \frac{1}{\pi}\int_{-\pi}^{\pi}f\left(\frac{L}{\pi}x\right)\cos kx\,dx\text{ for $k\geq1$.}\\
b_{k} &= \frac{1}{\pi}\int_{-\pi}^{\pi}f\left(\frac{L}{\pi}x\right)\sin kx\,dx\text{ for $k\geq1$.}
\end{align*}
Now we need to get everything back in terms of \(f(x)\), the function we started with. We can do this by making the substitution \(u = \frac{L}{\pi}x\). This gives us the following theorem after a little algebra.%
\begin{theorem}{Fourier Series of Functions with Arbitrary Period.}{}{theorem-fourier-series-of-functions-with-arbitrary-period}%
\index{Fourier series!Functions with period \(2L\)}\hypertarget{p-396}{}%
Let \(f(x)\) be a function with period \(p = 2L\). Then the Fourier coefficients of \(f(x)\) are given by%
\begin{align*}
a_{0} &= \frac{1}{2L}\int_{-L}^{L}f\left(x\right)\,dx\\
a_{k} &= \frac{1}{L}\int_{-L}^{L}f\left(x\right)\cos\left(\frac{k\pi}{L}x\right)\,dx\text{ for $k\geq1$}\\
b_{k} &= \frac{1}{L}\int_{-L}^{L}f\left(x\right)\sin\left(\frac{k\pi}{L}x\right)\,dx\text{ for $k\geq1$}
\end{align*}
and the corresponding Fourier series is%
\begin{equation*}
a_{0}+\sum_{k=1}^{\infty}\left(a_{k}\cos\left(\frac{k\pi}{L}x\right)+b_{k}\sin\left(\frac{k\pi}{L}x\right)\right).
\end{equation*}
%
\end{theorem}
\begin{example}{Fourier Series of \(f(x) = x^{2}\).}{example-fourier-series-of-x-squared}%
\hypertarget{p-397}{}%
Let \(f(x) = x^{2}\) for \(-1\leq x\leq 1\) and have period \(p=2\). We can find its Fourier series using Theorem \hyperref[theorem-fourier-series-of-functions-with-arbitrary-period]{Theorem~\ref{theorem-fourier-series-of-functions-with-arbitrary-period}}. If we do so, we get%
\begin{align*}
a_{0} &= \frac{1}{3}\\
a_{k} &= \frac{4 \, \left(-1\right)^{k}}{\pi^{2} k^{2}}\\
b_{k} &= 0
\end{align*}
So the Fourier series of \(f(x)\) is given by%
\begin{equation*}
\frac{1}{3} + \sum_{k=1}^{\infty}\frac{4 \, \left(-1\right)^{k}}{\pi^{2} k^{2}}\cos\left(k\pi x\right)
\end{equation*}
%
\end{example}
\begin{sageinput}
var('x,k,i')
assume(k,i,'integer')

# Defines the function to determine Fourier series of. Feel free to play around with this.
f(x) = x**2
L = 1

# Defines the Fourier coefficients.
def a(k):
coeff = integral(f(x)*cos(k*pi*x/L), (x,-L,L))/L
return coeff

def b(k):
coeff = integral(f(x)*sin(k*pi*x/L), (x,-L,L))/L
return coeff

# Defines the corresponding (partial) Fourier series.
def FS(k): 
return a(0)/2 + sum(a(i)*cos(i*pi*x/L) + b(i)*sin(i*pi*x/L), i, 1, k)

n = 3
p = plot(FS(n),(x,-L,L), color='red') + plot(f(x),(x,-L,L))
p
\end{sageinput}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 5.2.2 Even and Odd Extensions}
\typeout{************************************************}
%
\begin{subsectionptx}{Even and Odd Extensions}{}{Even and Odd Extensions}{}{}\label{subsection-even-and-odd-extensions}
\hypertarget{p-398}{}%
If you look at Examples \hyperref[example-fourier-series-of-x-cubed]{Example~\ref{example-fourier-series-of-x-cubed}} and \hyperref[example-fourier-series-of-x-squared]{Example~\ref{example-fourier-series-of-x-squared}}, then you'll notice that a lot of the Fourier coefficients were \(0\). In particular, \(a_{k} = 0\) for \(k\geq0\) for the first example, and \(b_{k}=0\) for the second. The reason for this has to do with \terminology{even and odd functions}.%
\begin{definition}{Even and Odd Functions.}{definition-even-and-odd-functions}%
\index{Even and odd functions}\hypertarget{p-399}{}%
Let \(f(x)\) be a function. We say that \(f(x)\) is%
\begin{align*}
\text{even if } & f(-x) = f(x)\\
\text{odd if } & f(-x) = -f(x).
\end{align*}
%
\end{definition}
\hypertarget{p-400}{}%
In other words, a function \(f(x)\) is even if and only if its graph is symmetric about the \(y\)-axis, and is odd if and only if its graph is symmetric about the origin.%
\begin{theorem}{Fourier Series of Even and Odd Functions.}{}{theorem-fourier-series-of-even-and-odd-functions}%
\index{Fourier series!Fourier series for even and odd functions}\hypertarget{p-401}{}%
Let \(f(x)\) be a periodic function with period \(p = 2L\), with corresponding Fourier series%
\begin{equation*}
a_{0}+\sum_{k=1}^{\infty}\left(a_{k}\cos\left(\frac{k\pi}{L}x\right)+b_{k}\sin\left(\frac{k\pi}{L}x\right)\right).
\end{equation*}
If \(f(x)\) is an odd function, then \(a_{k} = 0\) for \(k\geq0\). If \(f(x)\) is an even function, then \(b_{k}=0\) for \(k\geq1\).%
\end{theorem}
\hypertarget{p-402}{}%
In Examples \hyperref[example-fourier-series-of-x-cubed]{Example~\ref{example-fourier-series-of-x-cubed}} and \hyperref[example-fourier-series-of-x-squared]{Example~\ref{example-fourier-series-of-x-squared}} we began with functions that typically aren't thought of as periodic and found their Fourier series. Essentially what we did was we restricted our view of each function to a limited interval\footnote{\([-\pi,\pi]\) in the case of \(x^{3}\) and \([-1,1]\) in the case of \(x^{2}\)\label{footnote-periodic-extensions}} and then viewed that segment as defining a periodic function. This is the h idea behind \terminology{even and odd extensions} of functions.%
\begin{definition}{Even and Odd Extensions.}{definition-even-and-odd-extensions}%
\index{Fourier series!Even and odd extensions}\hypertarget{p-403}{}%
Let \(f(x)\) be a function defined on \([0,L]\). The even extension of \(f(x)\) is the even periodic function defined by extending the graph of \(f(x)\) on \([0,L]\) to the rest of the real numbers in such a way that the resulting function is even and has period \(2L\). The odd extension of \(f(x)\) is defined similarly.%
\end{definition}
\hypertarget{p-404}{}%
Computing Fourier series for even and odd functions is simpler than the general case.%
\begin{theorem}{Fourier Coefficients of Even and Odd Functions.}{}{theorem-fourier-coefficients-of-even-and-odd-functions}%
\index{Fourier series!Fourier coefficients for even and odd functions}\hypertarget{p-405}{}%
Let \(f(x)\) be periodic with period \(2L\). If \(f\) is even, then the Fourier coefficients of \(f(x)\) satisfy%
\begin{equation*}
a_{0} = \frac{1}{L}\int_{0}^{L}f(x)\,dx, a_{k} = \frac{2}{L}\int_{0}^{L}f(x)\cos\left(\frac{k\pi}{L}x\right)\,dx\text{ and } b_{k} = 0
\end{equation*}
for \(k\geq1\). If \(f\) is odd, then the Fourier coefficients of \(f(x)\) are%
\begin{equation*}
b_{k} = \frac{2}{L}\int_{0}^{L}f(x)\sin\left(\frac{k\pi}{L}x\right)\,dx\text{ and } a_{k} = 0.
\end{equation*}
%
\end{theorem}
\begin{example}{Even Extension of a Piecewise Function.}{example-even-extension-of-a-piecewise-function}%
\hypertarget{p-406}{}%
Define the piecewise function \(f(x)\) by%
\begin{equation*}
f(x) = \begin{cases}x & 0\leq x\leq \frac{\pi}{2} \\ \frac{\pi}{2} & \frac{\pi}{2}\leq x\leq \pi\end{cases}.
\end{equation*}
Then the even extension of \(f(x)\) is the new function \(f_{1}(x)\) given by%
\begin{equation*}
f_{1}(x) = \begin{cases}|x| & -\frac{\pi}{2}\leq x\leq \frac{\pi}{2} \\ \frac{\pi}{2} & \frac{\pi}{2}\leq |x|\leq \pi\end{cases}.
\end{equation*}
We can use Theorem \hyperref[theorem-fourier-coefficients-of-even-and-odd-functions]{Theorem~\ref{theorem-fourier-coefficients-of-even-and-odd-functions}} to help us find the Fourier series for \(f_{1}(x)\). With a little bit of help, we get \(a_{0} = \frac{3\pi}{8}\) and \(a_{k} = \frac{2\cos(\frac{\pi k}{2})-2}{\pi k^{2}}\), and so the Fourier series of \(f_{1}(x)\) is%
\begin{equation*}
\frac{3\pi}{8}+\sum_{k=1}^{\infty}\frac{(-1)^{k}-1}{2\pi k^{2}}\cos(2kx).
\end{equation*}
%
\end{example}
\begin{sageinput}
var('x,k,i')
assume(k,i,'integer')
L = pi

# Defines the Fourier coefficients.
def a(k):
coeff1 = (2/L)*integral(x*cos(k*pi*x/L), (x,0,pi/2))
coeff2 = (2/L)*integral((pi/2)*cos(k*pi*x/L), (x,pi/2,pi))
return coeff1+coeff2

# Defines the corresponding (partial) Fourier series.
def FS(k): 
return a(0)/2 + sum(a(i)*cos(i*pi*x/L), i, 1, k)

n = 25
p = plot(FS(n),(x,-L,L), color='red')
p
\end{sageinput}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 5.3 Complex Fourier Series and Parseval's Identity}
\typeout{************************************************}
%
\begin{sectionptx}{Complex Fourier Series and Parseval's Identity}{}{Complex Fourier Series and Parseval's Identity}{}{}\label{section-complex-fourier-series-and-parsevals-identity}
\begin{introduction}{}%
\hypertarget{p-407}{}%
Although we have a decent formula for Fourier series (see Theorem \hyperref[theorem-fourier-series-of-functions-with-arbitrary-period]{Theorem~\ref{theorem-fourier-series-of-functions-with-arbitrary-period}}), it's a little unwieldy due to the different expressions for \(a_{k},b_{k}\) and \(a_{0}\). We can fix this, perhaps surprisingly, by using complex exponentials and Euler's formula.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 5.3.1 Complex Fourier Series}
\typeout{************************************************}
%
\begin{subsectionptx}{Complex Fourier Series}{}{Complex Fourier Series}{}{}\label{subsection-complex-fourier-series}
\hypertarget{p-408}{}%
First, recall \hyperref[theorem-euler-s-formula]{Euler's formula~\ref{theorem-euler-s-formula}}, which allows us to rewrite complex exponentials in terms of sine and cosine.%
\par
\hypertarget{p-409}{}%
We can use \hyperref[theorem-euler-s-formula]{Theorem~\ref{theorem-euler-s-formula}} to rewrite the Fourier series in \hyperref[theorem-fourier-series-of-functions-with-arbitrary-period]{Theorem~\ref{theorem-fourier-series-of-functions-with-arbitrary-period}}. Our goal now is to find a \terminology{complex Fourier series}%
\begin{equation*}
\sum_{k=-\infty}^{\infty}c_{k}e^{i\frac{k\pi}{L}x}.
\end{equation*}
for functions \(f(x)\) with period \(p=2L\). We will also include the statement of \hyperref[theorem-pointwise-convergence-of-fourier-series]{Theorem~\ref{theorem-pointwise-convergence-of-fourier-series}} in this new context.%
\begin{theorem}{Complex Fourier Series.}{}{theorem-complex-fourier-series}%
\index{Fourier series!complex form}\hypertarget{p-410}{}%
Let \(f(x)\) be a piecewise smooth function with period \(p=2L\). Then the complex Fourier series of \(f(x)\) is given by%
\begin{equation*}
\sum_{k=-\infty}^{\infty}c_{k}e^{i\frac{k\pi}{L}x},
\end{equation*}
where%
\begin{equation*}
c_{k} = \frac{1}{2L}\int_{-L}^{L}f(x)e^{-i\frac{k\pi}{L}x}\,dx.
\end{equation*}
This Fourier series converges to \(f(x)\) wherever \(f(x)\) is continuous.%
\end{theorem}
\begin{proof}\hypertarget{proof-2}{}
\hypertarget{p-411}{}%
We need to use another orthogonality relation like we had in the real case, except now it will be written in terms of complex exponentials instead of sine and cosine. In particular, the relation we will use is the following:%
\begin{equation*}
\int_{-L}^{L}e^{i\frac{(m+n)\pi}{L}x}\,dx = \begin{cases} 2L & m=-n \\ 0 & \text{otherwise.}\end{cases}
\end{equation*}
So if we set \(f(x)\) equal to a complex Fourier series and integrate both sides against \(e^{-i\frac{n\pi}{L}x}\) for \(x\) from \(-L\) to \(L\), we get%
\begin{align*}
\int_{-L}^{L}f(x)e^{-i\frac{n\pi}{L}x}\,dx & = \int_{-L}^{L}\sum_{k=-\infty}^{\infty}c_{k}e^{i\frac{k\pi}{L}x}e^{-i\frac{n\pi}{L}x}\,dx \\
&= \sum_{k=-\infty}^{\infty}c_{k}\int_{-L}^{L}e^{i\frac{(k-n)\pi}{L}x}\,dx\\
&= 2Lc_{n}
\end{align*}
where the last equality follows from the orthogonality relation we just proved. Therefore%
\begin{equation*}
c_{n} = \frac{1}{2L}\int_{-L}^{L}f(x)e^{-i\frac{n\pi}{L}x}\,dx.\qedhere
\end{equation*}
%
\end{proof}
\begin{example}{Complex Fourier Series of Exponential Function.}{example-complex-fourier-series-of-exponential-function}%
\hypertarget{p-412}{}%
Let \(f(x) = e^{2x}\) on \(-\pi<x<\pi\) and suppose that \(f(x)\) is periodic with period \(2\pi\). We want to find the complex Fourier series for \(f(x)\). We can do this by finding the correct coefficients \(c_{k}\):%
\begin{align*}
c_{k} & = \frac{1}{2L}\int_{-L}^{L}f(x)e^{-i\frac{k\pi}{L}x}\,dx\\
& = \frac{1}{2\pi}\int_{-\pi}^{\pi}e^{2x}e^{-ikx}\,dx \\
& = \frac{1}{2\pi}\int_{-\pi}^{\pi}e^{(2-ik)x}\,dx \\
& = \frac{(-1)^{k}\sinh2\pi}{\pi(2-ik)} \\
& = \frac{(-1)^{k}\sinh2\pi(2+ik)}{\pi(4+k^{2})}
\end{align*}
So we have%
\begin{equation*}
f(x) = \sum_{k=-\infty}^{\infty}\frac{(-1)^{k}(2+ik)\sinh2\pi}{\pi(4+k^{2})}e^{ikx}
\end{equation*}
for \(x\neq k\pi\), since this is where \(f(x)\) has discontinuities.%
\end{example}
\hypertarget{p-413}{}%
Although the complex Fourier series can be easier to compute in some cases, there may be cases where we'd like to go back to the real Fourier series. The following formula lets us do so.%
\begin{theorem}{Real Fourier Series from Complex Fourier Series.}{}{theorem-real-fourier-series-from-complex-fourier-series}%
\index{Fourier series!convert complex to real}\hypertarget{p-414}{}%
Suppose \(f(x)\) has the complex Fourier series%
\begin{equation*}
\sum_{k=-\infty}^{\infty}c_{k}e^{i\frac{k\pi}{L}x}.
\end{equation*}
Then the corresponding coefficients \(a_{k}\) and \(b_{k}\) for the real Fourier series%
\begin{equation*}
a_{0} + \sum_{k=1}^{\infty}\left(a_{k}\cos\left(\frac{k\pi}{L}x\right)+b_{k}\sin\left(\frac{k\pi}{L}x\right)\right)
\end{equation*}
are given by%
\begin{align*}
a_{0} & = c_{0} \\
a_{k} & = c_{k} + c_{-k} \\
b_{k} & = i(c_{k}-c_{-k}) 
\end{align*}
%
\end{theorem}
\hypertarget{p-415}{}%
The real Fourier series corresponding to the complex Fourier series for \(f(x)\) from Example \hyperref[example-complex-fourier-series-of-exponential-function]{Example~\ref{example-complex-fourier-series-of-exponential-function}} has coefficients%
\begin{align*}
a_{0} & = c_{0} & &= \frac{\sinh2\pi}{2\pi} \\
a_{k} & = c_{k} + c_{-k} & &= \frac{4(-1)^{k}\sinh2\pi}{\pi(4+k^{2})} \\
b_{k} & = i(c_{k}-c_{-k}) & &= -\frac{2k(-1)^{k}\sinh2\pi}{\pi(4+k^{2})}. 
\end{align*}
Either way, we get the following Fourier series.%
\begin{sageinput}
# Defines our function.
f = lambda x:e**(2*x)
L = pi
f = piecewise([[(-L,L),f]])

# Partial sums of the Fourier series
def FS(k):
fourier = f.fourier_series_partial_sum(k,L)
return fourier

n = 15
p = plot(FS(n),(x,-L,L),color='red') + plot(f,(x,-L,L))
p
\end{sageinput}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 5.3.2 Parseval's Identity}
\typeout{************************************************}
%
\begin{subsectionptx}{Parseval's Identity}{}{Parseval's Identity}{}{}\label{subsection-parseval-s-identity}
\hypertarget{p-416}{}%
One of the most important identities in mathematics is \terminology{Parseval's identity}, which we state next.%
\begin{theorem}{Parseval's Identity.}{}{theorem-parseval-s-identity}%
\index{Fourier series!Parseval's identity}\hypertarget{p-417}{}%
Let \(f(x)\) denote a piecewise-differentiable (real-valued) function on \([-L,L]\) with real Fourier coefficients \(a_{k},b_{k}\) and complex Fourier coefficients \(c_{k}\). If \(\int_{-L}^{L}f(x)^{2}\,dx\) exists and is finite, then%
\begin{equation*}
\frac{1}{2L}\int_{-L}^{L}f(x)^{2}\,dx = a^{2}_{0} + \frac{1}{2}\sum_{k=1}^{\infty}(a^{2}_{k}+b^{2}_{k}) = \sum_{k=-\infty}^{\infty}|c_{k}|^{2}.
\end{equation*}
%
\end{theorem}
\hypertarget{p-418}{}%
One of the great strengths of this identity is that it allows potentially complicated sums to be computed using integrals instead.%
\begin{example}{The Basel Problem.}{example-the-basel-problem}%
\index{Basel problem}\hypertarget{p-419}{}%
In the early \(18^{\text{th}}\) century, one of the most renowned problems in mathematics was the Basel problem, which asked for the value of%
\begin{equation*}
\sum_{k=1}^{\infty}\frac{1}{k^{2}}.
\end{equation*}
Euler was the first person to show that the sum is actually \(\frac{\pi^{2}}{6},\) and it was this solution that made him famous\footnote{Or at least math famous.\label{fn-7}} in the first place. We can solve this by using Parseval's identity. To do so, let \(f(x) = x\) for \(-1< x < 1\). Then with a little bit of work we can find the (real) Fourier coefficients:%
\begin{align*}
a_{0} & = 0 \\
a_{k} & = 0 \text{ for } k\geq 1 \\
b_{k} & = \frac{2(-1)^{k}}{\pi k} 
\end{align*}
By Parseval's identity, it then follows that%
\begin{equation*}
\frac{1}{2}\int_{-1}^{1}x^{2}\,dx = \frac{1}{2}\sum_{k=1}^{\infty}\frac{4}{\pi^{2}k^{2}},
\end{equation*}
which simplifies down to%
\begin{equation*}
\frac{2}{3} = \frac{4}{\pi^{2}}\sum_{k=1}^{\infty}\frac{1}{k^{2}}.
\end{equation*}
In other words, \(\sum_{k=1}^{\infty}\frac{1}{k^{2}} = \frac{\pi^{2}}{6}.\)%
\end{example}
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 5.4 The Fourier Transform}
\typeout{************************************************}
%
\begin{sectionptx}{The Fourier Transform}{}{The Fourier Transform}{}{}\label{subsection-the-fourier-transform}
\hypertarget{p-420}{}%
If \(f(x)\) is a periodic function with period \(p=2L\), then we know how to find its Fourier series, both real and complex. But what do we do if our function \(f(x)\) is not periodic? Can we still get a similar representation?%
\par
\hypertarget{p-421}{}%
Let \(f(x)\) be some piecewise-differentiable function, not necessarily periodic. Then we can't find it's Fourier series. However, we can truncate the graph of \(f(x)\), and replace it with a periodic function that is equal to \(f(x)\) on some interval \((-L,L)\). Then we can find the Fourier series of \emph{this} function, which by Theorem \hyperref[theorem-complex-fourier-series]{Theorem~\ref{theorem-complex-fourier-series}} is given by \(\sum_{k=-\infty}^{\infty}c_{k}e^{i\frac{k\pi}{L}x}\) where%
\begin{equation*}
c_{k} = \frac{1}{2L}\int_{-L}^{L}f(x)e^{-i\frac{k\pi}{L}x}\,dx.
\end{equation*}
So we can write%
\begin{equation*}
f(x) = \sum_{k=-\infty}^{\infty}\left(\frac{1}{2L}\int_{-L}^{L}f(x)e^{-i\frac{k\pi}{L}x}\,dx\right)e^{i\frac{k\pi}{L}x}
\end{equation*}
wherever \(f(x)\) is continuous on \(-L<x<x\). The idea now is that the larger that \(T\) gets, this expression can be used to represent \(f(x)\) for more and more values of \(x\). So we want to see what happens to this as \(T\to\infty\). First, we'll clean this up a little bit by writing \(w_{k} = \frac{k\pi}{L}\) and \(\Delta w = w_{k+1} - w_{k}\), so that \(\frac{1}{2L} = \frac{\Delta w}{2\pi}\). Then if \(x\) is in \((-L,L)\) and \(f\) is continuous at \(x\), then we can say%
\begin{align*}
f(x) & = \sum_{k=-\infty}^{\infty}\left(\frac{1}{2L}\int_{-L}^{L}f(x)e^{-i\frac{k\pi}{L}x}\,dx\right)e^{i\frac{k\pi}{L}x} \\
& = \sum_{k=-\infty}^{\infty}\left(\frac{1}{2\pi}\int_{-L}^{L}f(x)e^{-iw_{k}x}\,dx\right)e^{iw_{k}x}\Delta w. 
\end{align*}
As \emph{awful} as this looks, we can relate this to a Riemann sum! As \(L\to\infty,\) \(\Delta w\to0\), we can replace \(w_{k}\) with the new variable \(\omega\) and this expression becomes%
\begin{equation*}
f(x) = \int_{-\infty}^{\infty}\left(\frac{1}{2\pi}\int_{-\infty}^{\infty}f(x)e^{-i\omega x}\,dx\right)e^{i\omega x}\,d\omega.
\end{equation*}
This leads to the definition of the \terminology{Fourier transform}. But first we need another definition.%
\begin{definition}{Absolutely Integrable Functions.}{definition-absolutely-integrable-functions}%
\index{Absolutely Integrable Functions}\hypertarget{p-422}{}%
Let \(f(x)\) be a piecewise continuous function. Then \(f(x)\) is absolutely integrable if \(\int_{-\infty}^{\infty}|f(x)|\,dx<\infty.\)%
\end{definition}
\begin{definition}{The Fourier Transform.}{definition-the-fourier-transform}%
\index{Fourier Transform!definition}\hypertarget{p-423}{}%
Let \(f(x)\) be an absolutely integrable piecewise continuous function. The Fourier transform of \(f(x)\) is the function \(\hat{f}(\omega)\) defined by%
\begin{equation*}
\hat{f}(\omega) = \frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}f(x)e^{-i\omega x}\,dx.
\end{equation*}
We often write \(\mathcal{F}(f)\) to denote the Fourier transform as well.%
\end{definition}
\begin{example}{Fourier transform of a piecewise exponential.}{example-fourier-transform-of-a-piecewise-exponential}%
\hypertarget{p-424}{}%
Let \(f(x) = e^{-2x}\) for \(x>-5\) and \(0\) otherwise. Then the Fourier transform of \(f(x)\) is%
\begin{align*}
\hat{f}(\omega) & = \frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}f(x)e^{-i\omega x}\,dx \\
& = \frac{1}{\sqrt{2\pi}}\int_{-5}^{\infty}e^{-2x}e^{-i\omega x}\,dx \\
& = \frac{1}{\sqrt{2\pi}}\int_{-5}^{\infty}e^{-(2+i\omega)x}\,dx \\
& = -\frac{1}{(2+i\omega)\sqrt{2\pi}}e^{-(2+i\omega)x}\Big]_{-5}^{\infty}\\
& = \frac{e^{(2+i\omega)5}}{(2+i\omega)\sqrt{2\pi}}. 
\end{align*}
%
\end{example}
\hypertarget{p-425}{}%
As with the Laplace transform, the Fourier transform of a function is said to be in the \terminology{frequency domain}. In fact, the magnitude of \(\hat{f}(\omega)\) represents the \terminology{frequency content} of the function \(f(x)\) (thought of as a signal) at the frequency \(\omega\). It's also a quick jump to get the \terminology{inverse Fourier transform}.%
\begin{definition}{The Inverse Fourier Transform.}{definition-the-inverse-fourier-transform}%
\index{Fourier Transform!inverse transform}\hypertarget{p-426}{}%
The inverse Fourier transform of \(\hat{f}(\omega)\) is%
\begin{equation*}
\mathcal{F}^{-1}(\hat{f}) = \frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}\hat{f}(\omega)e^{i\omega x}\,d\omega.
\end{equation*}
%
\end{definition}
\begin{theorem}{Fourier Inversion Theorem.}{}{theorem-fourier-integral-representation}%
\index{Fourier Transform!inversion theorem}\hypertarget{p-427}{}%
Let \(f(x)\) be an absolutely integrable, piecewise differentiable function. Then \(f(x) = \mathcal{F}^{-1}(\hat{f})\) wherever \(f(x)\) is continuous.%
\end{theorem}
\begin{example}{Inverse Fourier transform of a step function.}{example-inverse-fourier-transform-of-a-step-function}%
\hypertarget{p-428}{}%
Define \(\hat{f}(\omega)\) by%
\begin{equation*}
\hat{f}(\omega) = \begin{cases} 1 & -1 < x < 1 \\ 0 & \text{otherwise.}\end{cases}
\end{equation*}
Then we can find the inverse transform using \hyperref[definition-the-inverse-fourier-transform]{Definition~\ref{definition-the-inverse-fourier-transform}}:%
\begin{align*}
\mathcal{F}^{-1}\{\hat{f}\} & = \frac{1}{2\pi}\int_{-\infty}^{\infty}\hat{f}(\omega)e^{i\omega x}\,d\omega \\
& = \frac{1}{2\pi}\int_{-1}^{1}e^{i\omega x}\,d\omega \\
& = \frac{1}{2\pi}\frac{e^{i\omega x}}{ix}\Big]_{-1}^{1} \\
& = \frac{1}{2\pi}\frac{e^{ix}-e^{-ix}}{ix} \\
& = \frac{1}{\pi}\frac{\sin x}{x}. 
\end{align*}
%
\end{example}
\hypertarget{p-429}{}%
The Fourier and inverse Fourier transforms are also linear like the Laplace transform: if \(a,b\) are constants and \(f,g\) are functions, then%
\begin{equation*}
\mathcal{F}\{af+bg\} = a\hat{f}+b\hat{g}
\end{equation*}
and%
\begin{equation*}
\mathcal{F}^{-1}(a\hat{f}+b\hat{g}) = af + bg.
\end{equation*}
The Fourier transform also works well with derivatives.%
\begin{theorem}{Fourier Transforms and Derivatives.}{}{theorem-fourier-transforms-and-derivatives}%
\index{Fourier Transform!transforms fo derivatives}\hypertarget{p-430}{}%
Let \(f(x)\) be differentiable with derivative \(f'(x)\). Suppose that both \(f(x)\) and \(f'(x)\) are absolutely integrable. Then%
\begin{equation*}
\mathcal{F}(f') = i\omega\hat{f}(\omega).
\end{equation*}
%
\end{theorem}
\hypertarget{p-431}{}%
Fourier transforms also behave well with another type of convolution.%
\begin{theorem}{Convolution Theorem.}{}{theorem-convolution-theorem}%
\index{Fourier Transform!convolution theorem}\hypertarget{p-432}{}%
Suppose that \(f(x),g(x)\) are piecewise continuous, bounded and absolutely integrable. Define \(f\ast g\) by%
\begin{equation*}
f\ast g = \int_{-\infty}^{\infty}f(\tau)g(x-\tau)\,d\tau.
\end{equation*}
Then \(\mathcal{F}(f\ast g) = \hat{f}\hat{g}.\)%
\end{theorem}
\end{sectionptx}
\end{chapterptx}
%
%
\typeout{************************************************}
\typeout{Chapter 6 Partial Differential Equations}
\typeout{************************************************}
%
\begin{chapterptx}{Partial Differential Equations}{}{Partial Differential Equations}{}{}\label{partial-differential-equations}
\begin{introduction}{}%
\hypertarget{p-433}{}%
Consider a rod that's recently been pulled out of the oven and is now cooling in a room. Let \(T(t)\) denote the temperature of the rod at time \(t\), where \(t\) represents the amount of time since the rod was pulled out of the oven. Then we can model \(T(t)\) by using Newton's Law of Cooling, which states that%
\begin{equation*}
\frac{dT}{dt} = -k(T-A),
\end{equation*}
where \(k\) is a positive constant and \(A\) represents the ambient temperature of the room. This is an ordinary differential equation since it involves only one independent variable (\(t\)).%
\par
\hypertarget{p-434}{}%
This works just fine as a simple model of the temperature of the rod, but in reality the situation is likely to be more complicated. For instance, the temperature of the rod will likely vary over the surface of the rod at any given time \(t\). So it's reasonable to assume that the temperature of the rod should depend on \emph{two} variables, say, \(x\) (position on the rod) and \(t\) (time). So the temperature of the rod would be more accurately described by a function \(u(x,t)\). In fact, as we will see later, the temperature \(u(x,t)\) can be described by the \terminology{heat equation}:%
%
\begin{equation*}
\frac{\partial u}{\partial t} = \frac{\partial^{2}u}{\partial x^{2}}.
\end{equation*}
\hypertarget{p-435}{}%
This is an example of a \terminology{partial differential equation}.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Section 6.1 Basic Concepts}
\typeout{************************************************}
%
\begin{sectionptx}{Basic Concepts}{}{Basic Concepts}{}{}\label{section-basic-concepts}
%
%
\typeout{************************************************}
\typeout{Subsection 6.1.1 Partial derivatives and PDEs}
\typeout{************************************************}
%
\begin{subsectionptx}{Partial derivatives and PDEs}{}{Partial derivatives and PDEs}{}{}\label{subsection-partial-derivatives-and-pdes}
\hypertarget{p-436}{}%
Given some quantity \(u(x)\) that depends solely on the variable \(x\), \(\frac{du}{dx} = u'(x)\) represents the rate of change of \(u\) with respect to \(x\). More generally, given some quantity \(u(x,t)\) that depends on \(x,t\), we can attempt to find the rate of change of \(u\) with respect to each of the variables \(x,t\). This idea leads to \terminology{partial derivatives}.%
\begin{definition}{Partial derivatives.}{definition-partial-derivatives}%
\index{Partial derivatives}\hypertarget{p-437}{}%
Let \(u(x,t)\) denote a function depending on the variables \(x,t\). Then the partial derivative of \(u\) with respect to \(x\) is found by differentiating \(u(x,t)\) while treating \(t\) as a constant. The partial derivative of \(u\) with respect to \(x\) is denoted by%
\begin{equation*}
\frac{\partial}{\partial x}u\text{ or }\frac{\partial u}{\partial x}\text{ or }u_{x}.
\end{equation*}
The partial derivative of \(u\) with respect to \(t\) is found similarly, and is likewise denoted by%
\begin{equation*}
\frac{\partial}{\partial t}u\text{ or }\frac{\partial u}{\partial t}\text{ or }u_{t}.
\end{equation*}
%
\end{definition}
\hypertarget{p-438}{}%
From here we can define higher order partial derivatives, such as%
\begin{equation*}
\frac{\partial^{2}u}{\partial x^{2}} = \frac{\partial}{\partial x}\frac{\partial u}{\partial x}
\end{equation*}
or%
\begin{equation*}
u_{txx} = \frac{\partial}{\partial x}\left(\frac{\partial}{\partial x}\left(\frac{\partial}{\partial t}u\right)\right) = \frac{\partial^{3}u}{\partial x^{2}\partial t}.
\end{equation*}
The \terminology{order} of each of these partial derivatives is \(2\) and \(3\), respectively.%
\begin{definition}{Partial differential equation.}{definition-partial-differential-equation}%
\index{Partial differential equations!Definition}\hypertarget{p-439}{}%
A partial differential equation (PDE) is an equation involving one or more (partial) derivatives of an unknown function \(u\) that depends on two or more independent variables, usually thought of as time and position. The highest derivative appearing in a PDE is called the order of the PDE.%
\end{definition}
\hypertarget{p-440}{}%
Just as ODEs in practice typically appear as initial value problems, PDEs can appear as \terminology{boundary value problems}. Boundary value problems involve conditions of the form%
\begin{equation*}
u(0,t) = u_{0},\quad u(L,t) = u_{1} \quad \text{ and }\quad u(x,0) = f(x).
\end{equation*}
These are examples of \terminology{boundary conditions}. In other words, boundary conditions can represent initial data at infinitely many points, as opposed to finitely many points like we had for our IVPs.%
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 6.1.2 Linear homogeneous PDEs and the superposition principle}
\typeout{************************************************}
%
\begin{subsectionptx}{Linear homogeneous PDEs and the superposition principle}{}{Linear homogeneous PDEs and the superposition principle}{}{}\label{subsection-linear-homogeneous-pdes-and-the-superposition-principle}
\hypertarget{p-441}{}%
We will mostly be concerned with \terminology{linear PDEs}, which are PDEs where the only thing we're allowed to do to the function \(u\) and its derivatives is multiply it by a constant. A linear PDE is \terminology{homogeneous} if every term contains the function \(u\) or one of its derivatives. A \terminology{solution} of a PDE is a function \(u\) that satisfies the PDE.%
\begin{example}{Solution of the heat equation.}{example-solution-of-the-heat-equation}%
\hypertarget{p-442}{}%
Let \(u(x,t) = e^{-9t}\sin3x\). We'll show that this is a solution of the boundary value problem%
\begin{equation*}
u_{t} = u_{xx},\quad u(0,t) = u(\pi,t) = 0\quad\text{and}\quad u(x,0) = \sin3x.
\end{equation*}
%
\par
\hypertarget{p-443}{}%
To do so, we need to compute the partial derivatives of \(u(x,t):\)%
%
\begin{align*}
u_{t}(x,t) & = \frac{\partial u}{\partial t} = -9e^{-9t}\sin3x \\
u_{x}(x,t) & = \frac{\partial u}{\partial x} = 3e^{-9t}\cos3x \\
u_{xx}(x,t) & = \frac{\partial}{\partial x}u_{x} = 9e^{-9t}\sin3x. 
\end{align*}
\hypertarget{p-444}{}%
So we see that \(u_{t} = u_{xx}\), which means that \(u(x,t) = e^{-9t}\sin3x\) is a solution of \(u_{t} = u_{xx}\). Now it remains to show that \(u(x,t)\) satisfies the boundary conditions, which we can do without too much trouble.%
\end{example}
\hypertarget{p-445}{}%
Just as with linear homogeneous ODEs, PDEs that are linear and homogeneous satisfy the \terminology{superposition principle}.%
\begin{principle}{Superposition principle.}{}{principle-superposition-principle}%
\index{Superposition principle!partial differential equations}\hypertarget{p-446}{}%
Let \(c_{1}\) and \(c_{2}\) denote arbitrary constants, and suppose that \(u_{1}\) and \(u_{2}\) are both solutions of the same linear homogeneous PDE. Then%
\begin{equation*}
u = c_{1}u_{1}+c_{2}u_{2}
\end{equation*}
is also a solution of the same PDE.%
\end{principle}
\hypertarget{p-447}{}%
The superposition principle is incredibly useful since it allows us to find general solutions of PDEs, which makes solving linear homogeneous PDEs somewhat tractable. If a PDE fails to be linear or homogeneous, the superposition principle is not guaranteed to hold.%
\begin{example}{Failure of the superposition principle.}{example-failure-of-the-superposition-principle}%
\hypertarget{p-448}{}%
Consider the PDE given by%
\begin{equation*}
u_{t}+uu_{x} = 0.
\end{equation*}
This PDE fails to be linear because the second term involves multiplying \(u\) with its derivative \(u_{x}\). However, it's not too hard to check that \(u(x,t) = \frac{x}{t+1}\) is a solution of the PDE, since if we plug this function into the PDE we get%
\begin{align*}
u_{t} + uu_{x} & = -\frac{x}{(t+1)^{2}} + \frac{x}{t+1}\frac{1}{t+1} \\
& = 0. 
\end{align*}
However, the closely related function \(v(x,t) = 3u(x,t) = \frac{3x}{t+1}\) is \emph{not} a solution of the same PDE, since%
\begin{equation*}
v_{t}+vv_{x} = \frac{6x}{(t+1)^{2}}\neq0
\end{equation*}
So the superposition principle does not hold for this PDE.%
\end{example}
\end{subsectionptx}
%
%
\typeout{************************************************}
\typeout{Subsection 6.1.3 Important PDEs}
\typeout{************************************************}
%
\begin{subsectionptx}{Important PDEs}{}{Important PDEs}{}{}\label{subsection-important-pdes}
\hypertarget{p-449}{}%
As mentioned in the introduction, PDEs are useful for modeling quantities that depend on multiple independent variables. We finish this section by listing several of the simplest and most studied PDEs.%
\leavevmode%
\begin{enumerate}
\item\hypertarget{li-23}{}\(u_{t} = c^{2}u_{xx}\) where \(c>0\). This is called the \terminology{heat} or \terminology{diffusion equation}. This equation is used for modeling the spread of a quantity, such as how temperature diffuses along a rod.%
\item\hypertarget{li-24}{}\(u_{tt} = c^{2}u_{xx}\) where \(c>0\). This is called the \terminology{wave equation}, and is used for modeling vibrating motion, such as that along a plucked string.%
\end{enumerate}
\hypertarget{p-450}{}%
Our goal in the next section will be to determine how to solve PDEs such as these.%
\end{subsectionptx}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 6.2 The Wave Equation and Separation of Variables}
\typeout{************************************************}
%
\begin{sectionptx}{The Wave Equation and Separation of Variables}{}{The Wave Equation and Separation of Variables}{}{}\label{section-wave-equation-and-separation-of-variables}
\hypertarget{p-451}{}%
The main difficulty in solving PDEs (even linear ones) as compared with ODEs is that any solution of a PDE typically depends on more than one variable. Adding this extra degree of freedom into the problem greatly complicates matters. However, we can make this problem more reasonable by assuming that our solution \(u(x,t)\) depends on each variable \emph{separately}. That is, we'll assume that the function we want to find, \(u(x,t),\) satisfies the constraint \(u(x,t) = X(x)T(t)\). This technique is known as \terminology{separation of variables}.%
\par
\hypertarget{p-452}{}%
Consider a one-dimensional string of length \(L\) that vibrates in the vertical direction. The vertical displacement of such a string depends on the horizontal position along the string, \(x\), and the time \(t\). So let \(u(x,t)\) denote the vertical displacement of the string at position \(x\) and at time \(t\). If we assume that the string has constant density and that the force of gravity of the string is negligible, then \(u(x,t)\) satisfies the wave equation%
%
\begin{align}
\frac{\partial^{2}u}{\partial t^{2}} & = c^{2}\frac{\partial^{2}u}{\partial x^{2}} \label{equation-wave-equation}
\end{align}
\hypertarget{p-453}{}%
for some constant \(c\).%
\par
\hypertarget{p-454}{}%
Suppose that the string is also subject to the \terminology{boundary conditions}%
%
\begin{align}
u(0,t) = 0 &\text{ and } u(L,t) = 0. \label{equation-boundary-conditions}
\end{align}
\hypertarget{p-455}{}%
In other words, the string is held fixed at both ends. We'll also suppose that we know the initial position of the string and the initial velocity of the string, represented by the \terminology{initial conditions}%
%
\begin{align}
u(x,0) = f(x) & \text{ and } u_{t}(x,0) = g(x). \label{equation-initial-condition}
\end{align}
\hypertarget{p-456}{}%
Our goal will be to find \(u(x,t)\) subject to these conditions. To start, assume that \(u(x,t) = X(x)T(t).\) If we plug this into \hyperref[equation-wave-equation]{(\ref{equation-wave-equation})}, then we get%
%
\begin{equation*}
X(x)T''(t) = c^{2}X''(x)T(t).
\end{equation*}
\hypertarget{p-457}{}%
If we assume that \(X(x),T(t)\) are both nonzero, then we can rewrite this to get%
%
\begin{equation*}
\frac{T''(t)}{c^{2}T(t)} = \frac{X''(x)}{X(x)}.
\end{equation*}
\hypertarget{p-458}{}%
This may not look that helpful, but it actually places some serious restrictions on \(X\) and \(T\). The left hand side of this equation only depends on \(t\) whereas the right hand side depends only on \(x\). So the only way for this equation to be true for \emph{all} \(x,t\) is if both sides are constant:%
%
\begin{equation*}
\frac{T''(t)}{c^{2}T(t)} = \frac{X''(x)}{X(x)} = k
\end{equation*}
\hypertarget{p-459}{}%
for some \(k\). This now gives us two separate \emph{ordinary} differential equations for \(T(t)\) and \(X(x)\):%
%
\begin{align}
X''(x) - kX(x) & = 0 \label{equation-separation-of-variables-1}\\
T''(t) - kc^{2}T(t) & = 0. \label{equation-separation-of-variables-2}
\end{align}
\hypertarget{p-460}{}%
We can add a few more restrictions to these ODEs to help us solve them. Note that the boundary conditions \hyperref[equation-boundary-conditions]{(\ref{equation-boundary-conditions})} force either \(X(0) = X(L) = 0\) or \(T(t) = 0\) for all \(t\), which leads to \(u(x,t) = 0\). So to avoid this trivial solution, we'll set \(X(0) = X(L) = 0\). The solutions of these equations depend on \(k\). We'll solve \hyperref[equation-separation-of-variables-1]{(\ref{equation-separation-of-variables-1})} first since we have extra information to use. So to start, suppose that \(k>0\) and write \(k = \mu^{2}\) for some nonzero \(\mu\). Then \hyperref[equation-separation-of-variables-1]{(\ref{equation-separation-of-variables-1})} becomes \(X''-\mu^{2}X = 0\) and has solution given by%
%
\begin{equation*}
X(x) = c_{1}\sinh\mu x + c_{2}\cosh \mu x.
\end{equation*}
\hypertarget{p-461}{}%
Now, \(X(0)=0\) forces \(c_{2} = 0\), so we get \(X(x) = c_{1}\sinh\mu x\). However, since \(X(L) = 0\) as well, we get \(c_{1}\sinh\mu L = 0\). But the only way to solve this is to set \(c_{1} = 0\) since \(\sinh u = 0\) only if \(u=0\). So in other words, if we assume that \(k = \mu^{2}>0\), then the only way to solve \hyperref[equation-separation-of-variables-1]{(\ref{equation-separation-of-variables-1})} is to set \(X(x) = 0\), which also forces \(u(x,t) = 0\). Obviously, this isn't very useful. Similarly, if we assume that \(k=0\) then we get the same problem. So let's assume that \(k=-\mu^{2}<0\) for some nonzero \(\mu\). Then \hyperref[equation-separation-of-variables-1]{(\ref{equation-separation-of-variables-1})} becomes \(X''+\mu^{2}X = 0\), which has solution%
%
\begin{equation*}
X(x) = c_{1}\sin\mu x + c_{2}\cos \mu x.
\end{equation*}
\hypertarget{p-462}{}%
The condition \(X(0) = 0\) forces \(c_{2} = 0\), and the second boundary condition \(X(L) = 0\) forces \(c_{1}\sin \mu L = 0\). We want to avoid setting \(c_{1}\) equal to \(0\) since this would give us \(X=0\) again, so we'll set \(\sin \mu L= 0\) instead. \emph{This} tells us that \(\mu L = n\pi\) for some integer \(n\), or just \(\mu = \frac{n\pi}{L}\). So nontrivial solutions of \hyperref[equation-separation-of-variables-1]{(\ref{equation-separation-of-variables-1})} that satisfy the boundary conditions \(X(0)=X(L) = 0\) can occur only if \(k = -\mu^{2}\) where \(\mu = \frac{n\pi}{L}\) and \(n=\pm1,\pm2,\ldots\). For each choice of \(n\) (ignoring sign), we get the solution \(X_{n} = \sin\frac{n\pi}{L}x\).%
\par
\hypertarget{p-463}{}%
Now we move on to solving \hyperref[equation-separation-of-variables-2]{(\ref{equation-separation-of-variables-2})}, but we still need to keep the condition \(k=-(\frac{n\pi}{L})^{2}\) for \(n=\pm1,\pm2,\ldots\). If we do so, then \hyperref[equation-separation-of-variables-2]{(\ref{equation-separation-of-variables-2})} becomes \(T''+(c\frac{n\pi}{L})^{2}T=0\), which has solutions given by%
%
\begin{equation*}
T_{n} = b_{n}\cos\lambda_{n}t+b^{*}_{n}\sin\lambda_{n}t,
\end{equation*}
\hypertarget{p-464}{}%
where \(\lambda_{n} = c\frac{n\pi}{L}\).%
\par
\hypertarget{p-465}{}%
So this means that every function of the form%
%
\begin{equation*}
u_{n}(x,t) = X_{n}T_{n} = \sin\frac{n\pi}{L}x\left(b_{n}\cos\lambda_{n}t+b^{*}_{n}\sin\lambda_{n}t\right)
\end{equation*}
\hypertarget{p-466}{}%
is a solution of \hyperref[equation-wave-equation]{(\ref{equation-wave-equation})} subject to the boundary conditions \hyperref[equation-boundary-conditions]{(\ref{equation-boundary-conditions})}. It also follows from the superposition principle that any (finite) linear combination of these functions will give another solution that satisfies the boundary conditions. However, this does \emph{not} guarantee that we can solve for the initial conditions in \hyperref[equation-initial-condition]{(\ref{equation-initial-condition})}. To give ourselves as general a solution as possible, we will guess that the solution to the wave equation is actually a linear combination of all possible \(u_{n}\). That is, we'll say that%
%
\begin{equation*}
u(x,t) = \sum_{n=1}^{\infty}\sin\frac{n\pi}{L}x\left(b_{n}\cos\lambda_{n}t+b^{*}_{n}\sin\lambda_{n}t\right).
\end{equation*}
\hypertarget{p-467}{}%
Now we'll use the initial conditions to actually determine \(b_{n},b^{*}_{n}\). To start, note that we must have%
%
\begin{equation*}
f(x) = u(x,0) = \sum_{n=1}^{\infty}b_{n}\sin\frac{n\pi}{L}x.
\end{equation*}
\hypertarget{p-468}{}%
\emph{This is a Fourier series}, and in particular it's the Fourier series of the odd extension of \(f(x)\) with period \(2L\).\footnote{See \hyperref[theorem-fourier-coefficients-of-even-and-odd-functions]{Theorem~\ref{theorem-fourier-coefficients-of-even-and-odd-functions}}.\label{fn-8}} So it follows that%
%
\begin{equation*}
b_{n} = \frac{2}{L}\int_{0}^{L}f(x)\sin\frac{n\pi}{L}x\,dx.
\end{equation*}
\hypertarget{p-469}{}%
Similarly, we must have%
%
\begin{equation*}
g(x) = u_{t}(x,0) = \sum_{n=1}^{\infty}b_{n}^{*}\lambda_{n}\sin\frac{n\pi}{L}x.
\end{equation*}
\hypertarget{p-470}{}%
This is the Fourier series for the odd extension of \(g(x)\) with period \(2\pi\). Therefore%
%
\begin{equation*}
b^{*}_{n}\lambda_{n} = \frac{2}{L}\int_{0}^{L}g(x)\sin\frac{n\pi}{L}x\,dx,
\end{equation*}
\hypertarget{p-471}{}%
or just%
%
\begin{equation*}
b^{*}_{n} = \frac{2}{cn\pi}\int_{0}^{L}g(x)\sin\frac{n\pi}{L}x\,dx.
\end{equation*}
\hypertarget{p-472}{}%
We can put all of this together into the following theorem.%
\begin{theorem}{Solution of the Wave Equation.}{}{theorem-solution-of-the-wave-equation}%
\index{Wave equation!solution}\hypertarget{p-473}{}%
The solution of the wave equation \hyperref[equation-wave-equation]{(\ref{equation-wave-equation})} with boundary conditions \hyperref[equation-boundary-conditions]{(\ref{equation-boundary-conditions})} and initial conditions \hyperref[equation-initial-condition]{(\ref{equation-initial-condition})} is given by%
%
\begin{equation*}
u(x,t) = \sum_{n=1}^{\infty}\sin\frac{n\pi}{L}x(b_{n}\cos\lambda_{n}t+b^{*}_{b}\sin\lambda_{n}t),
\end{equation*}
\hypertarget{p-474}{}%
where%
%
\begin{equation*}
b_{n} = \frac{2}{L}\int_{0}^{L}f(x)\sin\frac{n\pi}{L}\,dx\text{ and }b^{*}_{n} = \frac{2}{cn\pi}\int_{0}^{L}g(x)\sin\frac{n\pi}{L}x\,dx
\end{equation*}
\hypertarget{p-475}{}%
and \(\lambda_{n} = c\frac{n\pi}{L}\) for \(n=1,2,\ldots\).%
\end{theorem}
\begin{example}{A string with fixed ends.}{example-a-string-with-fixed-ends}%
\hypertarget{p-476}{}%
A string at rest has unit length, and is fixed at both ends. Suppose that the string is now stretched into the triangular shape given by the graph of%
%
\begin{equation*}
f(x) = \begin{cases} 2x & 0\leq x\leq \frac{1}{2} \\ 2(1-x) & \frac{1}{2}\leq x\leq 1 \end{cases}.
\end{equation*}
\hypertarget{p-477}{}%
The string is then released at time \(t=0\). Given \(c=4\), we want to find the function \(u(x,t)\) that models the vertical displacement of the string at position \(x\) at time \(t\). We can model \(u(x,t)\) as the solution of the wave equation%
%
\begin{equation*}
\pdv[2]{u}{t} = 16\pdv[2]{u}{x}
\end{equation*}
\hypertarget{p-478}{}%
with boundary conditions \(u(0,t) = u(1,t) = 0\) and initial conditions%
%
\begin{equation*}
u(x,0) = f(x)\text{ and }u_{t}(x,0) = 0.
\end{equation*}
\hypertarget{p-479}{}%
We can find \(u(x,t)\) from \hyperref[theorem-solution-of-the-wave-equation]{Theorem~\ref{theorem-solution-of-the-wave-equation}}. Using the Sage box below, we get%
%
\begin{equation*}
b_{n} = \frac{8\sin\left(\frac{1}{2} \pi n\right)}{\pi^{2} n^{2}},
\end{equation*}
\hypertarget{p-480}{}%
and since \(g(x) = 0\) this forces \(b^{*}_{n} = 0\) as well. Hence the solution is%
%
\begin{equation*}
u(x,t) = \sum_{n=1}^{\infty}\frac{8\sin\left(\frac{1}{2} \pi n\right)}{\pi^{2} n^{2}}\sin(n\pi x)\cos(4n\pi t).
\end{equation*}
\end{example}
\begin{sageinput}
  # Defines the odd extension of the function f(x).
f1(x) = 2*x
f2(x) = 2*(1-x)
f = piecewise([[(-1,-1/2),-f2(-x)],[(-1/2,0),-f1(-x)],[(0,1/2),f1],[(1/2,1),f2]])

# Gets Fourier sine coefficients for odd extension of f(x).
L = 1
var('n')
assume(n,'integer')

def b(n):
    return f.fourier_series_sine_coefficient(n,L).full_simplify()   

pretty_print(b(n))
\end{sageinput}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 6.3 d'Alembert's Solution of the Wave Equation}
\typeout{************************************************}
%
\begin{sectionptx}{d'Alembert's Solution of the Wave Equation}{}{d'Alembert's Solution of the Wave Equation}{}{}\label{section-d-alembert-s-solution-of-the-wave-equation}
\hypertarget{p-481}{}%
Although \hyperref[theorem-solution-of-the-wave-equation]{Theorem~\ref{theorem-solution-of-the-wave-equation}} solves the wave equation, it's a little complicated to work with. We'll try to express the solution in a simpler way. In particular, we'll start by trying to simplify the solution of the boundary value problem in \hyperref[example-a-string-with-fixed-ends]{Example~\ref{example-a-string-with-fixed-ends}}. In that example, we saw that the solution of%
%
\begin{equation*}
u_{tt} = 16u_{xx}
\end{equation*}
\hypertarget{p-482}{}%
with boundary conditions \(u(0,t) = u(1,t) = 0\) and initial conditions%
%
\begin{equation*}
u(x,0) = f(x) = \begin{cases} 2x \amp 0\leq x\leq \frac{1}{2} \\ 2(1-x) \amp \frac{1}{2}\leq x\leq 1 \end{cases},\quad u_{t}(x,0) = 0
\end{equation*}
\hypertarget{p-483}{}%
was given by%
%
\begin{equation*}
u(x,t) = \sum_{n=1}^{\infty}b_{n}\sin(n\pi x)\cos(4n\pi t),
\end{equation*}
\hypertarget{p-484}{}%
where \(b_{n}\) was the \(n^{\th}\) Fourier coefficient of the odd extension of \(f(x)\). If we look at this, it looks kind of like a Fourier series except that we have a product of sine and cosine. We can make this look more like a Fourier series by using one of the product-to-sum formulas from trigonometry:%
%
\begin{equation*}
\sin x\cos y = \frac{1}{2}[\sin(x+y)+\sin(x-y)].
\end{equation*}
\hypertarget{p-485}{}%
Using this formula, we get%
%
\begin{equation*}
\sin(n\pi x)\cos(4n\pi t) = \frac{1}{2}[\sin[n\pi(x+4t)]+\sin[n\pi(x-4t)],
\end{equation*}
\hypertarget{p-486}{}%
which means we can write the solution \(u(x,t)\) as%
%
\begin{equation*}
u(x,t) = \frac{1}{2}\left[\sum_{n=1}^{\infty}b_{n}\sin[n\pi(x+4t)] + \sum_{n=1}^{\infty}b_{n}\sin[n\pi(x-4t)]\right].
\end{equation*}
\hypertarget{p-487}{}%
Here's how this helps us. Since \(b_{n}\) is the \(n^{\th}\) Fourier coefficient of the odd extension of \(f(x)\), each of these sums must be a Fourier series for the odd extension of \(f(x)\)! In particular, if we denote the odd extension by \(f^{*}(x)\) then we can simply say that%
%
\begin{equation*}
u(x,t) = \frac{1}{2}[f^{*}(x+4t)+f^{*}(x-4t)].
\end{equation*}
\hypertarget{p-488}{}%
We can extend this to other boundary value problems without an initial velocity component.%
\begin{theorem}{d'Alembert's Solution without Initial Velocity.}{}{theorem-d-alembert-s-solution-without-initial-velocity}%
\index{Wave equation!d'Alembert's solution!zero initial velocity}\hypertarget{p-489}{}%
Let \(c\gt0\), and consider the boundary value problem%
%
\begin{align*}
u_{tt} & = c^{2}u_{xx} \\
u(0,t) & = 0 \\
u(L,t) & = 0 \\
u(x,0) & = f(x) \\
u_{t}(x,0) & = 0. 
\end{align*}
\hypertarget{p-490}{}%
Assuming that \(f(x)\) is piecewise twice differentiable, then the solution of this boundary value problem is given by%
%
\begin{equation*}
u(x,t) = \frac{1}{2}[f^{*}(x-ct)+f^{*}(x+ct)]
\end{equation*}
\hypertarget{p-491}{}%
where \(f^{*}\) denotes the odd extension of \(f(x)\).%
\end{theorem}
\begin{example}{Boundary value problem with sinusoidal deflection.}{example-boundary-value-problem-with-sinusoidal-deflection}%
\hypertarget{p-492}{}%
A string of length \(L=1\) has initial deflection, or position, given by \(f(x) = \sin\pi x - \frac{1}{2}\sin2\pi x\) for \(0\leq x\leq 1\). The string is released at time \(t=0\). Suppose \(c=1\), and we want to find \(u(x,t)\). Then we can do so very easily with \hyperref[theorem-d-alembert-s-solution-without-initial-velocity]{Theorem~\ref{theorem-d-alembert-s-solution-without-initial-velocity}}, since the initial velocity of the string is \(0\). So we have%
%
\begin{equation*}
u(x,t) = \frac{1}{2}[f^{*}(x-t)+f^{*}(x+t)],
\end{equation*}
\hypertarget{p-493}{}%
where \(f^{*}\) is the odd extension of \(f(x)\). However, since \(f(x)\) is itself an odd function, it follows that the odd extension is simply \(\sin\pi x-\frac{1}{2}\sin2\pi x\). Therefore the solution is%
%
\begin{equation*}
u(x,t) = \frac{1}{2}\left[\sin(\pi(x-t))-\frac{1}{2}\sin(2\pi(x-t)) + \sin(\pi(x+t)) - \frac{1}{2}\sin(2\pi(x+t))\right].
\end{equation*}
\end{example}
\hypertarget{p-494}{}%
d'Alembert's solution is very useful if we want to model a vibrating string with zero initial velocity. But what can we do if the string has an initial velocity? d'Alembert's solution actually suggests a possible approach to take. If we look at \hyperref[theorem-d-alembert-s-solution-without-initial-velocity]{Theorem~\ref{theorem-d-alembert-s-solution-without-initial-velocity}}, it essentially states that the solution of the wave equation (assuming zero initial velocity) is the superposition of the rightward traveling wave \(f(x-ct)\) with the leftward traveling wave \(f(x+ct)\). This suggests that superpositions of waves are fundamental to solutions of the wave equation.%
\par
\hypertarget{p-495}{}%
We'll try something similar for the case \(u_{t}(x,0) = g(x)\). We'll assume that adding in this initial velocity also adds in a new rightward traveling wave \(G(x-ct)\) and a new leftward traveling wave \(H(x+ct)\) into our solution \(u(x,t)\), so that we have%
%
\begin{equation*}
u(x,t) = \frac{1}{2}[f^{*}(x-ct)+f^{*}(x+ct)] + G(x-ct) + H(x+ct).
\end{equation*}
\hypertarget{p-496}{}%
Now we'll try to use the initial conditions to find \(G\) and \(H\). Now, since we need \(u(x,0) = f(x)\) this forces%
%
\begin{equation*}
G(x) + H(x) = 0\Rightarrow H(x) = -G(x).
\end{equation*}
\hypertarget{p-497}{}%
Therefore our solution becomes%
%
\begin{equation*}
u(x,t) = \frac{1}{2}[f^{*}(x-ct)+f^{*}(x+ct)] + G(x-ct) - G(x+ct).
\end{equation*}
If we use the second initial condition \(u_{t}(x,0) = g(x),\) then we get%
\begin{equation*}
g(x) = -cG'(x) - cG'(x) = -2cG'(x) \Rightarrow G'(x) = -\frac{1}{2c}g(x).
\end{equation*}
\hypertarget{p-498}{}%
Now we can integrate both sides to find \(G(x)\)! So there exists some \(x_{0}\) such that%
%
\begin{equation*}
G(x) = -\frac{1}{2c}\int_{x_{0}}^{x}g(s)\,ds.
\end{equation*}
\hypertarget{p-499}{}%
Therefore%
%
\begin{align*}
u(x,t) & = \frac{1}{2}[f^{*}(x-ct)+f^{*}(x+ct)] + G(x-ct) + H(x+ct) \\
& = \frac{1}{2}[f^{*}(x-ct)+f^{*}(x+ct)] + G(x-ct) - G(x+ct) \\
& = \frac{1}{2}[f^{*}(x-ct)+f^{*}(x+ct)] - \frac{1}{2c}\int_{x_{0}}^{x-ct}g(s)\,ds + \frac{1}{2c}\int_{x_{0}}^{x+ct}g(s)\,ds \\
& = \frac{1}{2}[f^{*}(x-ct)+f^{*}(x+ct)] + \frac{1}{2c}\int_{x-ct}^{x+ct}g(s)\,ds. 
\end{align*}
\hypertarget{p-500}{}%
This gives the following adjustment to d'Alembert's solution.%
\begin{theorem}{d'Alembert's Solution with Initial Velocity.}{}{theorem-d-alembert-s-solution-with-initial-velocity}%
\index{Wave equation!d'Alembert's solution!with initial velocity}\hypertarget{p-501}{}%
Let \(c\gt0\), and consider the boundary value problem%
%
\begin{align*}
u_{tt} & = c^{2}u_{xx} \\
u(0,t) & = 0 \\
u(L,t) & = 0 \\
u(x,0) & = f(x) \\
u_{t}(x,0) & = g(x). 
\end{align*}
\hypertarget{p-502}{}%
Assuming that \(f(x)\) is piecewise twice differentiable and that \(g(x)\) is piecewise continuous, then the solution of this boundary value problem is given by%
%
\begin{equation*}
u(x,t) = \frac{1}{2}[f^{*}(x-ct)+f^{*}(x+ct)] + \frac{1}{2c}\int_{x-ct}^{x+ct}g^{*}(s)\,ds.
\end{equation*}
\hypertarget{p-503}{}%
where \(f^{*}\) denotes the odd extension of \(f(x)\) and \(g^{*}\) the odd extension of \(g(x)\).%
\end{theorem}
\begin{example}{Boundary value problem with sinusoidal deflection and initial velocity.}{example-boundary-value-problem-with-sinusoidal-deflection-and-initial-velocity}%
\hypertarget{p-504}{}%
Consider a string of length \(L=1\), initial deflection \(f(x) = \sin\pi x\) and initial velocity \(\frac{1}{4}\sin2\pi x\). Assume that \(c = 2\). Then the vertical displacement \(u(x,t)\) of the string is given by%
%
\begin{align*}
u(x,t) & = \frac{1}{2}[f^{*}(x-ct)+f^{*}(x+ct)] + \frac{1}{2c}\int_{x-ct}^{x+ct}g(s)\,ds \\
& = \frac{1}{2}[\sin(\pi(x-2t))+\sin(\pi(x+2t))] + \frac{1}{4}\int_{x-2t}^{x+2t}\frac{1}{4}\sin2\pi s\,ds \\
& = \frac{1}{2}[\sin(\pi(x-2t))+\sin(\pi(x+2t))] - \frac{1}{32\pi}\cos2\pi s\Bigg]_{x-2t}^{x+2t} \\
& = \frac{1}{2}[\sin(\pi(x-2t))+\sin(\pi(x+2t))] - \frac{\cos(2\pi(x+2t)) - \cos(2\pi(x-2t))}{32\pi} 
\end{align*}
\end{example}
\end{sectionptx}
%
%
\typeout{************************************************}
\typeout{Section 6.4 The Heat Equation}
\typeout{************************************************}
%
\begin{sectionptx}{The Heat Equation}{}{The Heat Equation}{}{}\label{section-the-heat-equation}
\begin{introduction}{}%
\hypertarget{p-505}{}%
The last equation we will look at is the \terminology{heat equation}, which models the temperature distribution of a thin bar of uniform density and constant cross-section placed along the \(x\)-axis. We also assume that the bar is perfectly insulated on its surface, so that heat flows along the bar in the \(x\)-direction only. With these assumptions, the temperature \(u(x,t)\) of the bar at position \(x\) and time \(t\) satisfies the PDE%
%
\begin{align*}
\pdv{u}{t} & = c^{2}\pdv[2]{u}{x}. 
\end{align*}
\hypertarget{p-506}{}%
This is called the \terminology{one-dimensional heat equation}.%
\end{introduction}%
%
%
\typeout{************************************************}
\typeout{Subsection 6.4.1 Bar with ends fixed at \(0\)}
\typeout{************************************************}
%
\begin{subsectionptx}{Bar with ends fixed at \(0\)}{}{Bar with ends fixed at \(0\)}{}{}\label{subsection-bar-with-ends-fixed-at-}
\hypertarget{p-507}{}%
We will start by solving the heat equation for the case where the bar has ends which are fixed at temperature \(0\). If we're given an initial temperature distribution \(f(x)\), then \(u(x,t)\) is the solution of the boundary value problem%
%
\begin{align}
u_{t} & = c^{2}u_{xx} \label{equation-one-dimensional-heat-equation}\\
u(0,t) = u(L,t) & = 0 \label{heat-equation-boundary-conditions-fixed-temperature}\\
u(x,0) & = f(x) \label{heat-equation-initial-condition}
\end{align}
\hypertarget{p-508}{}%
We can solve this boundary value problem using separation of variables, much as we did in \hyperref[section-wave-equation-and-separation-of-variables]{Section~\ref{section-wave-equation-and-separation-of-variables}}. So to start, we assume that \(u(x,t) = X(x)T(t)\). If we plug this into the heat equation \hyperref[equation-one-dimensional-heat-equation]{(\ref{equation-one-dimensional-heat-equation})}, then we get%
%
\begin{equation}
\frac{T'}{c^{2}T} = \frac{X''}{X} = k.\label{equation-odes-from-heat-equation}
\end{equation}
\hypertarget{p-509}{}%
Now we have three separate cases to consider for \(k\): \(k\gt0, k=0\) or \(k\lt0\). Just as with the wave equation, the only case that doesn't lead to trivial solutions is \(k=-\mu^{2}\lt0\). In this case \hyperref[equation-odes-from-heat-equation]{(\ref{equation-odes-from-heat-equation})} leads to the two ODEs given by%
%
\begin{align*}
X''+\mu^{2}X & = 0 \\
T'+c^{2}\mu^{2}T & = 0. 
\end{align*}
\hypertarget{p-510}{}%
The boundary conditions in \hyperref[heat-equation-boundary-conditions-fixed-temperature]{(\ref{heat-equation-boundary-conditions-fixed-temperature})} force \(X(0) = X(L) = 0\), and the only nontrivial solutions of \(X''+\mu^{2}X = 0\) occur when \(\mu = \frac{n\pi}{L}\). So we get the solutions \(X = X_{n} = \sin\frac{n\pi}{L}x\), just as with the wave equation.%
\par
\hypertarget{p-511}{}%
For the second ODE, we readily solve it to obtain \(T = T_{n} = b_{n}e^{-\lambda_{n}^{2}t}\) where \(\lambda_{n} = c\frac{n\pi}{L}\) as before. So every function%
%
\begin{equation*}
u_{n}(x,t) = X_{n}T_{n} = b_{n}\sin\frac{n\pi}{L}xe^{-\lambda_{n}^{2}t}
\end{equation*}
\hypertarget{p-512}{}%
is a solution of \hyperref[equation-one-dimensional-heat-equation]{(\ref{equation-one-dimensional-heat-equation})} that satisfies the boundary equations \hyperref[heat-equation-boundary-conditions-fixed-temperature]{(\ref{heat-equation-boundary-conditions-fixed-temperature})}. In order to satisfy the arbitrary initial condition \(f(x)\), we take an infinite sum of the functions \(u_{n}(x,t)\) to get%
%
\begin{equation*}
u(x,t) = \sum_{n=1}^{\infty}b_{n}\sin\frac{n\pi}{L}x e^{-\lambda^{2}_{n}t}.
\end{equation*}
\hypertarget{p-513}{}%
Finally, if we plug in \(t=0\) and use the initial condition \(u(x,0) = f(x)\), we get \(f(x) = \sum_{n=1}^{\infty}b_{n}\sin\frac{n\pi}{L}x\). This is just the Fourier series of the odd extension of \(f(x)\), which lets us find \(b_{n}\). We summarize all of this in the following theorem.%
\begin{theorem}{Solution of the Heat Equation with Fixed Temperature.}{}{theorem-solution-of-the-heat-equation-with-fixed-temperature}%
\index{Heat equation!fixed ends}\hypertarget{p-514}{}%
The solution of the heat equation \hyperref[equation-one-dimensional-heat-equation]{(\ref{equation-one-dimensional-heat-equation})} satisfying the boundary conditions \hyperref[heat-equation-boundary-conditions-fixed-temperature]{(\ref{heat-equation-boundary-conditions-fixed-temperature})} and initial condition \hyperref[heat-equation-initial-condition]{(\ref{heat-equation-initial-condition})} is given by%
%
\begin{equation}
u(x,t) = \sum_{n=1}^{\infty}b_{n}\sin\frac{n\pi}{L}x e^{-\lambda^{2}_{n}t}\label{heat-equation-fixed-ends-solution}
\end{equation}
%
\begin{align}
b_{n} & = \frac{2}{L}\int_{0}^{L}f(x)\sin\frac{n\pi}{L}x\,dx \label{heat-equation-fixed-ends-solution-coeff}\\
\lambda_{n} & = c\frac{n\pi}{L}. \label{heat-equation-fixed-ends-solution-exponent}
\end{align}
\end{theorem}
\begin{example}{Sinusoidal initial temperature.}{example-sinusoidal-initial-temperature}%
\hypertarget{p-515}{}%
Consider a thin metal bar of length \(\pi\) placed on the \(x\)-axis, with one end at \(x=0\) and the other at \(x=\pi\). Assuming that \(c=1\) and that the initial temperature is \(f(x) = 30\sin x\) for \(0\leq x\leq\pi\), we can find the temperature distribution using \hyperref[theorem-solution-of-the-heat-equation-with-fixed-temperature]{Theorem~\ref{theorem-solution-of-the-heat-equation-with-fixed-temperature}}:%
%
\begin{equation*}
u(x,t) = \sum_{n=1}^{\infty}b_{n}\sin(n x)e^{-n^{2}t},
\end{equation*}
\hypertarget{p-516}{}%
where \(b_{n}\) is the \(n^{\th}\) coefficient of the Fourier series of the odd extension of \(f(x)\). The odd extension of \(f(x)\) is \(30\sin x\). Furthermore, the Fourier series of \(30\sin x\) is clearly just \(30\sin x\). So in other words,%
%
\begin{equation*}
b_{n} = \begin{cases} 30 \amp n=1 \\ 0 \amp otherwise.\end{cases}
\end{equation*}
\hypertarget{p-517}{}%
Hence%
%
\begin{equation*}
u(x,t) = 30e^{-t}\sin x.
\end{equation*}
\end{example}
\end{subsectionptx}
\end{sectionptx}
\end{chapterptx}
%
%% A lineskip in table of contents as transition to appendices, backmatter
\addtocontents{toc}{\vspace{\normalbaselineskip}}
%
%
%
\typeout{************************************************}
\typeout{Appendix A GNU Free Documentation License}
\typeout{************************************************}
%
%
\appendix
%
\begin{appendixptx}{GNU Free Documentation License}{}{GNU Free Documentation License}{}{}\label{appendix-gfdl}
\begin{paragraphs}{}{paragraphs-1}%
\hypertarget{p-518}{}%
Version 1.3, 3 November 2008%
\par
\hypertarget{p-519}{}%
Copyright \textcopyright{} 2000, 2001, 2002, 2007, 2008 Free Software Foundation, Inc. \textless{}\url{http://www.fsf.org/}\textgreater{}%
\par
\hypertarget{p-520}{}%
Everyone is permitted to copy and distribute verbatim copies of this license document, but changing it is not allowed.%
\end{paragraphs}%
\begin{paragraphs}{0. PREAMBLE.}{gfdl-section0}%
\hypertarget{p-521}{}%
The purpose of this License is to make a manual, textbook, or other functional and useful document ``free'' in the sense of freedom: to assure everyone the effective freedom to copy and redistribute it, with or without modifying it, either commercially or noncommercially. Secondarily, this License preserves for the author and publisher a way to get credit for their work, while not being considered responsible for modifications made by others.%
\par
\hypertarget{p-522}{}%
This License is a kind of ``copyleft'', which means that derivative works of the document must themselves be free in the same sense. It complements the GNU General Public License, which is a copyleft license designed for free software.%
\par
\hypertarget{p-523}{}%
We have designed this License in order to use it for manuals for free software, because free software needs free documentation: a free program should come with manuals providing the same freedoms that the software does. But this License is not limited to software manuals; it can be used for any textual work, regardless of subject matter or whether it is published as a printed book. We recommend this License principally for works whose purpose is instruction or reference.%
\end{paragraphs}%
\begin{paragraphs}{1. APPLICABILITY AND DEFINITIONS.}{gfdl-section1}%
\hypertarget{p-524}{}%
This License applies to any manual or other work, in any medium, that contains a notice placed by the copyright holder saying it can be distributed under the terms of this License. Such a notice grants a world-wide, royalty-free license, unlimited in duration, to use that work under the conditions stated herein. The ``Document'', below, refers to any such manual or work. Any member of the public is a licensee, and is addressed as ``you''. You accept the license if you copy, modify or distribute the work in a way requiring permission under copyright law.%
\par
\hypertarget{p-525}{}%
A ``Modified Version'' of the Document means any work containing the Document or a portion of it, either copied verbatim, or with modifications and/or translated into another language.%
\par
\hypertarget{p-526}{}%
A ``Secondary Section'' is a named appendix or a front-matter section of the Document that deals exclusively with the relationship of the publishers or authors of the Document to the Document's overall subject (or to related matters) and contains nothing that could fall directly within that overall subject. (Thus, if the Document is in part a textbook of mathematics, a Secondary Section may not explain any mathematics.) The relationship could be a matter of historical connection with the subject or with related matters, or of legal, commercial, philosophical, ethical or political position regarding them.%
\par
\hypertarget{p-527}{}%
The ``Invariant Sections'' are certain Secondary Sections whose titles are designated, as being those of Invariant Sections, in the notice that says that the Document is released under this License. If a section does not fit the above definition of Secondary then it is not allowed to be designated as Invariant. The Document may contain zero Invariant Sections. If the Document does not identify any Invariant Sections then there are none.%
\par
\hypertarget{p-528}{}%
The ``Cover Texts'' are certain short passages of text that are listed, as Front-Cover Texts or Back-Cover Texts, in the notice that says that the Document is released under this License. A Front-Cover Text may be at most 5 words, and a Back-Cover Text may be at most 25 words.%
\par
\hypertarget{p-529}{}%
A ``Transparent'' copy of the Document means a machine-readable copy, represented in a format whose specification is available to the general public, that is suitable for revising the document straightforwardly with generic text editors or (for images composed of pixels) generic paint programs or (for drawings) some widely available drawing editor, and that is suitable for input to text formatters or for automatic translation to a variety of formats suitable for input to text formatters. A copy made in an otherwise Transparent file format whose markup, or absence of markup, has been arranged to thwart or discourage subsequent modification by readers is not Transparent. An image format is not Transparent if used for any substantial amount of text. A copy that is not ``Transparent'' is called ``Opaque''.%
\par
\hypertarget{p-530}{}%
Examples of suitable formats for Transparent copies include plain ASCII without markup, Texinfo input format, LaTeX input format, SGML or XML using a publicly available DTD, and standard-conforming simple HTML, PostScript or PDF designed for human modification. Examples of transparent image formats include PNG, XCF and JPG. Opaque formats include proprietary formats that can be read and edited only by proprietary word processors, SGML or XML for which the DTD and/or processing tools are not generally available, and the machine-generated HTML, PostScript or PDF produced by some word processors for output purposes only.%
\par
\hypertarget{p-531}{}%
The ``Title Page'' means, for a printed book, the title page itself, plus such following pages as are needed to hold, legibly, the material this License requires to appear in the title page. For works in formats which do not have any title page as such, ``Title Page'' means the text near the most prominent appearance of the work's title, preceding the beginning of the body of the text.%
\par
\hypertarget{p-532}{}%
The ``publisher'' means any person or entity that distributes copies of the Document to the public.%
\par
\hypertarget{p-533}{}%
A section ``Entitled XYZ'' means a named subunit of the Document whose title either is precisely XYZ or contains XYZ in parentheses following text that translates XYZ in another language. (Here XYZ stands for a specific section name mentioned below, such as ``Acknowledgements'', ``Dedications'', ``Endorsements'', or ``History''.) To ``Preserve the Title'' of such a section when you modify the Document means that it remains a section ``Entitled XYZ'' according to this definition.%
\par
\hypertarget{p-534}{}%
The Document may include Warranty Disclaimers next to the notice which states that this License applies to the Document. These Warranty Disclaimers are considered to be included by reference in this License, but only as regards disclaiming warranties: any other implication that these Warranty Disclaimers may have is void and has no effect on the meaning of this License.%
\end{paragraphs}%
\begin{paragraphs}{2. VERBATIM COPYING.}{gfdl-section2}%
\hypertarget{p-535}{}%
You may copy and distribute the Document in any medium, either commercially or noncommercially, provided that this License, the copyright notices, and the license notice saying this License applies to the Document are reproduced in all copies, and that you add no other conditions whatsoever to those of this License. You may not use technical measures to obstruct or control the reading or further copying of the copies you make or distribute. However, you may accept compensation in exchange for copies. If you distribute a large enough number of copies you must also follow the conditions in section 3.%
\par
\hypertarget{p-536}{}%
You may also lend copies, under the same conditions stated above, and you may publicly display copies.%
\end{paragraphs}%
\begin{paragraphs}{3. COPYING IN QUANTITY.}{gfdl-section3}%
\hypertarget{p-537}{}%
If you publish printed copies (or copies in media that commonly have printed covers) of the Document, numbering more than 100, and the Document's license notice requires Cover Texts, you must enclose the copies in covers that carry, clearly and legibly, all these Cover Texts: Front-Cover Texts on the front cover, and Back-Cover Texts on the back cover. Both covers must also clearly and legibly identify you as the publisher of these copies. The front cover must present the full title with all words of the title equally prominent and visible. You may add other material on the covers in addition. Copying with changes limited to the covers, as long as they preserve the title of the Document and satisfy these conditions, can be treated as verbatim copying in other respects.%
\par
\hypertarget{p-538}{}%
If the required texts for either cover are too voluminous to fit legibly, you should put the first ones listed (as many as fit reasonably) on the actual cover, and continue the rest onto adjacent pages.%
\par
\hypertarget{p-539}{}%
If you publish or distribute Opaque copies of the Document numbering more than 100, you must either include a machine-readable Transparent copy along with each Opaque copy, or state in or with each Opaque copy a computer-network location from which the general network-using public has access to download using public-standard network protocols a complete Transparent copy of the Document, free of added material. If you use the latter option, you must take reasonably prudent steps, when you begin distribution of Opaque copies in quantity, to ensure that this Transparent copy will remain thus accessible at the stated location until at least one year after the last time you distribute an Opaque copy (directly or through your agents or retailers) of that edition to the public.%
\par
\hypertarget{p-540}{}%
It is requested, but not required, that you contact the authors of the Document well before redistributing any large number of copies, to give them a chance to provide you with an updated version of the Document.%
\end{paragraphs}%
\begin{paragraphs}{4. MODIFICATIONS.}{gfdl-section4}%
\hypertarget{p-541}{}%
You may copy and distribute a Modified Version of the Document under the conditions of sections 2 and 3 above, provided that you release the Modified Version under precisely this License, with the Modified Version filling the role of the Document, thus licensing distribution and modification of the Modified Version to whoever possesses a copy of it. In addition, you must do these things in the Modified Version:%
\leavevmode%
\begin{enumerate}[label=\Alph*.]
\item\hypertarget{li-25}{}\hypertarget{p-542}{}%
Use in the Title Page (and on the covers, if any) a title distinct from that of the Document, and from those of previous versions (which should, if there were any, be listed in the History section of the Document). You may use the same title as a previous version if the original publisher of that version gives permission.%
\item\hypertarget{li-26}{}\hypertarget{p-543}{}%
List on the Title Page, as authors, one or more persons or entities responsible for authorship of the modifications in the Modified Version, together with at least five of the principal authors of the Document (all of its principal authors, if it has fewer than five), unless they release you from this requirement.%
\item\hypertarget{li-27}{}\hypertarget{p-544}{}%
State on the Title page the name of the publisher of the Modified Version, as the publisher.%
\item\hypertarget{li-28}{}\hypertarget{p-545}{}%
Preserve all the copyright notices of the Document.%
\item\hypertarget{li-29}{}\hypertarget{p-546}{}%
Add an appropriate copyright notice for your modifications adjacent to the other copyright notices.%
\item\hypertarget{li-30}{}\hypertarget{p-547}{}%
Include, immediately after the copyright notices, a license notice giving the public permission to use the Modified Version under the terms of this License, in the form shown in the Addendum below.%
\item\hypertarget{li-31}{}\hypertarget{p-548}{}%
Preserve in that license notice the full lists of Invariant Sections and required Cover Texts given in the Document's license notice.%
\item\hypertarget{li-32}{}\hypertarget{p-549}{}%
Include an unaltered copy of this License.%
\item\hypertarget{li-33}{}\hypertarget{p-550}{}%
Preserve the section Entitled ``History'', Preserve its Title, and add to it an item stating at least the title, year, new authors, and publisher of the Modified Version as given on the Title Page. If there is no section Entitled ``History'' in the Document, create one stating the title, year, authors, and publisher of the Document as given on its Title Page, then add an item describing the Modified Version as stated in the previous sentence.%
\item\hypertarget{li-34}{}\hypertarget{p-551}{}%
Preserve the network location, if any, given in the Document for public access to a Transparent copy of the Document, and likewise the network locations given in the Document for previous versions it was based on.  These may be placed in the ``History'' section. You may omit a network location for a work that was published at least four years before the Document itself, or if the original publisher of the version it refers to gives permission.%
\item\hypertarget{li-35}{}\hypertarget{p-552}{}%
For any section Entitled ``Acknowledgements'' or ``Dedications'', Preserve the Title of the section, and preserve in the section all the substance and tone of each of the contributor acknowledgements and/or dedications given therein.%
\item\hypertarget{li-36}{}\hypertarget{p-553}{}%
Preserve all the Invariant Sections of the Document, unaltered in their text and in their titles. Section numbers or the equivalent are not considered part of the section titles.%
\item\hypertarget{li-37}{}\hypertarget{p-554}{}%
Delete any section Entitled ``Endorsements''. Such a section may not be included in the Modified Version.%
\item\hypertarget{li-38}{}\hypertarget{p-555}{}%
Do not retitle any existing section to be Entitled ``Endorsements'' or to conflict in title with any Invariant Section.%
\item\hypertarget{li-39}{}\hypertarget{p-556}{}%
Preserve any Warranty Disclaimers.%
\end{enumerate}
\hypertarget{p-557}{}%
If the Modified Version includes new front-matter sections or appendices that qualify as Secondary Sections and contain no material copied from the Document, you may at your option designate some or all of these sections as invariant. To do this, add their titles to the list of Invariant Sections in the Modified Version's license notice. These titles must be distinct from any other section titles.%
\par
\hypertarget{p-558}{}%
You may add a section Entitled ``Endorsements'', provided it contains nothing but endorsements of your Modified Version by various parties \textemdash{} for example, statements of peer review or that the text has been approved by an organization as the authoritative definition of a standard.%
\par
\hypertarget{p-559}{}%
You may add a passage of up to five words as a Front-Cover Text, and a passage of up to 25 words as a Back-Cover Text, to the end of the list of Cover Texts in the Modified Version. Only one passage of Front-Cover Text and one of Back-Cover Text may be added by (or through arrangements made by) any one entity. If the Document already includes a cover text for the same cover, previously added by you or by arrangement made by the same entity you are acting on behalf of, you may not add another; but you may replace the old one, on explicit permission from the previous publisher that added the old one.%
\par
\hypertarget{p-560}{}%
The author(s) and publisher(s) of the Document do not by this License give permission to use their names for publicity for or to assert or imply endorsement of any Modified Version.%
\end{paragraphs}%
\begin{paragraphs}{5. COMBINING DOCUMENTS.}{gfdl-section5}%
\hypertarget{p-561}{}%
You may combine the Document with other documents released under this License, under the terms defined in section 4 above for modified versions, provided that you include in the combination all of the Invariant Sections of all of the original documents, unmodified, and list them all as Invariant Sections of your combined work in its license notice, and that you preserve all their Warranty Disclaimers.%
\par
\hypertarget{p-562}{}%
The combined work need only contain one copy of this License, and multiple identical Invariant Sections may be replaced with a single copy. If there are multiple Invariant Sections with the same name but different contents, make the title of each such section unique by adding at the end of it, in parentheses, the name of the original author or publisher of that section if known, or else a unique number. Make the same adjustment to the section titles in the list of Invariant Sections in the license notice of the combined work.%
\par
\hypertarget{p-563}{}%
In the combination, you must combine any sections Entitled ``History'' in the various original documents, forming one section Entitled ``History''; likewise combine any sections Entitled ``Acknowledgements'', and any sections Entitled ``Dedications''. You must delete all sections Entitled ``Endorsements''.%
\end{paragraphs}%
\begin{paragraphs}{6. COLLECTIONS OF DOCUMENTS.}{gfdl-section6}%
\hypertarget{p-564}{}%
You may make a collection consisting of the Document and other documents released under this License, and replace the individual copies of this License in the various documents with a single copy that is included in the collection, provided that you follow the rules of this License for verbatim copying of each of the documents in all other respects.%
\par
\hypertarget{p-565}{}%
You may extract a single document from such a collection, and distribute it individually under this License, provided you insert a copy of this License into the extracted document, and follow this License in all other respects regarding verbatim copying of that document.%
\end{paragraphs}%
\begin{paragraphs}{7. AGGREGATION WITH INDEPENDENT WORKS.}{gfdl-section7}%
\hypertarget{p-566}{}%
A compilation of the Document or its derivatives with other separate and independent documents or works, in or on a volume of a storage or distribution medium, is called an ``aggregate'' if the copyright resulting from the compilation is not used to limit the legal rights of the compilation's users beyond what the individual works permit. When the Document is included in an aggregate, this License does not apply to the other works in the aggregate which are not themselves derivative works of the Document.%
\par
\hypertarget{p-567}{}%
If the Cover Text requirement of section 3 is applicable to these copies of the Document, then if the Document is less than one half of the entire aggregate, the Document's Cover Texts may be placed on covers that bracket the Document within the aggregate, or the electronic equivalent of covers if the Document is in electronic form. Otherwise they must appear on printed covers that bracket the whole aggregate.%
\end{paragraphs}%
\begin{paragraphs}{8. TRANSLATION.}{gfdl-section8}%
\hypertarget{p-568}{}%
Translation is considered a kind of modification, so you may distribute translations of the Document under the terms of section 4. Replacing Invariant Sections with translations requires special permission from their copyright holders, but you may include translations of some or all Invariant Sections in addition to the original versions of these Invariant Sections. You may include a translation of this License, and all the license notices in the Document, and any Warranty Disclaimers, provided that you also include the original English version of this License and the original versions of those notices and disclaimers. In case of a disagreement between the translation and the original version of this License or a notice or disclaimer, the original version will prevail.%
\par
\hypertarget{p-569}{}%
If a section in the Document is Entitled ``Acknowledgements'', ``Dedications'', or ``History'', the requirement (section 4) to Preserve its Title (section 1) will typically require changing the actual title.%
\end{paragraphs}%
\begin{paragraphs}{9. TERMINATION.}{gfdl-section9}%
\hypertarget{p-570}{}%
You may not copy, modify, sublicense, or distribute the Document except as expressly provided under this License. Any attempt otherwise to copy, modify, sublicense, or distribute it is void, and will automatically terminate your rights under this License.%
\par
\hypertarget{p-571}{}%
However, if you cease all violation of this License, then your license from a particular copyright holder is reinstated (a) provisionally, unless and until the copyright holder explicitly and finally terminates your license, and (b) permanently, if the copyright holder fails to notify you of the violation by some reasonable means prior to 60 days after the cessation.%
\par
\hypertarget{p-572}{}%
Moreover, your license from a particular copyright holder is reinstated permanently if the copyright holder notifies you of the violation by some reasonable means, this is the first time you have received notice of violation of this License (for any work) from that copyright holder, and you cure the violation prior to 30 days after your receipt of the notice.%
\par
\hypertarget{p-573}{}%
Termination of your rights under this section does not terminate the licenses of parties who have received copies or rights from you under this License. If your rights have been terminated and not permanently reinstated, receipt of a copy of some or all of the same material does not give you any rights to use it.%
\end{paragraphs}%
\begin{paragraphs}{10. FUTURE REVISIONS OF THIS LICENSE.}{gfdl-section10}%
\hypertarget{p-574}{}%
The Free Software Foundation may publish new, revised versions of the GNU Free Documentation License from time to time. Such new versions will be similar in spirit to the present version, but may differ in detail to address new problems or concerns. See \url{http://www.gnu.org/copyleft/}.%
\par
\hypertarget{p-575}{}%
Each version of the License is given a distinguishing version number. If the Document specifies that a particular numbered version of this License ``or any later version'' applies to it, you have the option of following the terms and conditions either of that specified version or of any later version that has been published (not as a draft) by the Free Software Foundation. If the Document does not specify a version number of this License, you may choose any version ever published (not as a draft) by the Free Software Foundation. If the Document specifies that a proxy can decide which future versions of this License can be used, that proxy's public statement of acceptance of a version permanently authorizes you to choose that version for the Document.%
\end{paragraphs}%
\begin{paragraphs}{11. RELICENSING.}{gfdl-section11}%
\hypertarget{p-576}{}%
``Massive Multiauthor Collaboration Site'' (or ``MMC Site'') means any World Wide Web server that publishes copyrightable works and also provides prominent facilities for anybody to edit those works. A public wiki that anybody can edit is an example of such a server. A ``Massive Multiauthor Collaboration'' (or ``MMC'') contained in the site means any set of copyrightable works thus published on the MMC site.%
\par
\hypertarget{p-577}{}%
``CC-BY-SA'' means the Creative Commons Attribution-Share Alike 3.0 license published by Creative Commons Corporation, a not-for-profit corporation with a principal place of business in San Francisco, California, as well as future copyleft versions of that license published by that same organization.%
\par
\hypertarget{p-578}{}%
``Incorporate'' means to publish or republish a Document, in whole or in part, as part of another Document.%
\par
\hypertarget{p-579}{}%
An MMC is ``eligible for relicensing'' if it is licensed under this License, and if all works that were first published under this License somewhere other than this MMC, and subsequently incorporated in whole or in part into the MMC, (1) had no cover texts or invariant sections, and (2) were thus incorporated prior to November 1, 2008.%
\par
\hypertarget{p-580}{}%
The operator of an MMC Site may republish an MMC contained in the site under CC-BY-SA on the same site at any time before August 1, 2009, provided the MMC is eligible for relicensing.%
\end{paragraphs}%
\begin{paragraphs}{ADDENDUM: How to use this License for your documents.}{gfdl-addendum}%
\hypertarget{p-581}{}%
To use this License in a document you have written, include a copy of the License in the document and put the following copyright and license notices just after the title page:%
\begin{preformatted}
Copyright (C)  YEAR  YOUR NAME.
Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3
or any later version published by the Free Software Foundation;
with no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.
A copy of the license is included in the section entitled "GNU
Free Documentation License".
\end{preformatted}
\hypertarget{p-582}{}%
If you have Invariant Sections, Front-Cover Texts and Back-Cover Texts, replace the ``with\textellipsis{} Texts.'' line with this:%
\begin{preformatted}
with the Invariant Sections being LIST THEIR TITLES, with the
Front-Cover Texts being LIST, and with the Back-Cover Texts being LIST.
\end{preformatted}
\hypertarget{p-583}{}%
If you have Invariant Sections without Cover Texts, or some other combination of the three, merge those two alternatives to suit the situation.%
\par
\hypertarget{p-584}{}%
If your document contains nontrivial examples of program code, we recommend releasing these examples in parallel under your choice of free software license, such as the GNU General Public License, to permit their use in free software.%
\end{paragraphs}%
\end{appendixptx}
%
\backmatter
%
%
%% The index is here, setup is all in preamble
\printindex
%
\cleardoublepage
\pagestyle{empty}
\vspace*{\stretch{1}}
\begin{backcolophon}{colophon-1}%
\hypertarget{p-585}{}%
This book was authored in MathBook XML.%
\end{backcolophon}%
\vspace*{\stretch{2}}
\end{document}